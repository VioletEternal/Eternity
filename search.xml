<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>《那年夏天……》——致那无法触及的</title>
      <link href="/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E7%B3%BB%E7%BC%92%E4%B8%89%E6%97%A5%E7%9A%84%E7%A7%8B%E5%A4%A9/mermaid-princess/"/>
      <url>/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E7%B3%BB%E7%BC%92%E4%B8%89%E6%97%A5%E7%9A%84%E7%A7%8B%E5%A4%A9/mermaid-princess/</url>
      
        <content type="html"><![CDATA[<p>转自：知乎</p><span id="more"></span><h2 id="人鱼公主的愿望"><a href="#人鱼公主的愿望" class="headerlink" title="人鱼公主的愿望"></a>人鱼公主的愿望</h2><p>如果说，汉斯·克里斯汀·安徒生所写的人鱼公主里的公主愿望是与人类王子相爱走完一生，那我的愿望与她是相同的，但我就像是人鱼公主里的公主一样，在付出时间与努力之后什么也没有得到。</p><p>如果说，人能活到八十岁。那么在意识成形后，它大概还能享受几十年的夏天。我将我所度过的夏天排放在桌子上，全部放平后就能发现有两个夏天很特别，一个非常的明亮，一个非常的暗淡，接下来，我会将明亮的这个夏天尽可能的详细说给你听。</p><p>那是发生在一九九几年的夏天，我与他相遇了。</p><p>我与深町阳介开始当朋友是在国小的时候,不，说是朋友或许不对，因为我并没有与他确认明确的朋友关系，我只是将他单方面当做我的朋友。</p><p>记得那是在我入院几个月后发生的事。有一天，他转入了我在的病房，他睡在我正前方的病床上，他是一个看起来不好搭话，而且面相有些凶恶的男生。其实正前方的病床住进了什么人与我没有关系，但我就是会注意这个男生，这并不是因为他的面相凶恶又或者对人恶言相向才让我注意他，说起我会注意他的原因？也只是很无趣的小事，但对当时的我来说，这一定是一件大事吧。我想，我是在嫉妒他，是一种毫不掩饰，很明显的嫉妒。</p><p>他的母亲基本每天都会来看他，不论是春夏秋冬，又或者阴晴雨雪，他的母亲都会来医院看他。对于他母亲的行动我很是无法理解，因为就我的家庭而言，我的母亲是那种就算来到医院看我也是一副「我也不是喜欢来才这里」表情的人，但当时因为我年纪小，我以为是母亲因为太过劳累的关系才会这样，所以在母亲来到病房时我总是装出一副「没关系」的态度，在母亲待在病房里时我总是跟他谈一些没营养的话题，比方说什么医生的态度和善或者星期几的饭菜好吃等等，尽管我努力将事情说的有趣，但我的母亲只是一脸僵硬地用很简短的话回答我。随着年龄增长，我也逐渐意识到那是一种「认为人很麻烦的态度」，或许你会想说我有被害妄想症，但如果你看过我母亲的那种态度，我想你也一定会明白我再说什么。</p><p>每当他的母亲来到病房时，我总是拉起床边的防护帘，挡住眼前过于幸福的光景。虽然我的想法上明白看了也只会徒增悲伤，但我就是忍不住去看，心想着如果现在被照顾的不是他，而是我那该有多好。每当我的这个想法产生的瞬间，就被我马上打消，就连我自己都对自己的不干脆感到厌恶，明明只要果断接受现状就好了，但我怎么样就是无法放弃「只要我继续等下去，说不定哪一天我的母亲就会像他的母亲一样对待我。」但从结果上看，我的等待并没有用，只要我的脚一天不好，我所遇见的状况就不会有任何的好转，明白这点是在几个月后的那一天。</p><p>我与他的关系自那一阵子后有变的缓和一点。记得那是在美渚汀一年一度的烟火大会的夜晚。那一天，窗外的声响异常的大，在这个一到夜晚就只听得见蝉鸣声的美渚汀来说是很难得的夜晚。我降低身体的感觉，提高耳朵的灵敏度。窗外除了人潮的声音还有一声声巨大的声响。当我意识到这是烟火声时，我已经听不到烟火声了。我放空脑袋躺在床上闭上眼睛，尝试想像烟火是个什么样子，但仔细检索记忆后我才意识到我根本就没亲眼看过烟火这种东西，对烟火的记忆也只停留在五颜六色，飞到空中没过多久就会消失这种概念上的东西。因为平常在美渚汀里很少能看见或听见烟火的声音，再加上这半年多来的住院，已经让我彻底忘记了烟火这种东西到底是个什么样子，不，说不定连忘记烟火这件事本身我都已经忘记了也说不定。</p><p>　　想到这里，我的心中充满了不安，有一种像被墨汁般漆黑的海水给覆盖住的感觉，让我一时之间喘不过气来。让我从这份不安里脱身的契机正是因为他，因为母亲而被我单方面讨厌的他，不，说不定他也很讨厌我，只是我没发现而已。</p><p>当我回过神来，似乎已经过了十几分钟，我起身朝他的病床看去，病床上空无一人，我环视整间病房后才发现他正站在窗边看着外面的烟花。</p><p>我坐在病床上看着他。他有胎记的半边脸被一次次升起的烟花所照亮。在烟花升起的瞬间他似乎说了些什么，但因为烟花跟窗外的人潮声太大，让我听不清他说了什么。</p><p>大概过了有几分钟吧，我意识到我的眼角有着液体状的东西流下。我想，那一定是因为屋顶漏水滴到我脸上导致的。不然，我根本没有理由哭的不是吗？就在我这么想时，我的心中出现了一个不属于我的声音，它对我说道：「你是真的认为是屋顶漏水的吗？你难道不是对窗户边那个可以站着的男人产生嫉妒以及在自己无法站立的事实前产生绝望所流下的眼泪吗？」</p><p>也许正如你所说的吧，我对心中出现的那个声音附和到，但它完全不理会我，好像一开始就不存在一样地消失了。</p><p>我再度躺到床上，看向天花板。也许正如刚刚那个人所说，我的确是对自己无法再次站立这件事产生绝望并且嫉妒着能正常行走的他吧。只是，一旦开始思考起这种不合常理的事，就感觉全世界处处是不合理的地方，虽然我的想法上非常明白，但我就是忍不住想对什么人发脾气，但我发现没有什么人比起我自己更合适对自己发脾气了。</p><p>机会难得，我想尝试看看久违的哭一次。我也不管周围的人是如何想的，我将头埋进枕头里开始哭，眼泪化成一滴滴水滴在枕头上，我就像是要将几年间积累的眼泪全部哭干一样不断地哭。</p><p>我感觉到我的肩膀被人拍了一记，但因为在这个病房里我没有任何熟人所以让我感到惊讶。「不管对方是谁，我都不想正面被人看到我的这副模样」我简单擦拭了脸上的眼泪，看向后方。</p><p>最先印入眼帘的是他脸上大到有小半张脸的胎记。「为什么是他？他来我这里想干什么？难道是因为我的哭声太大影响到他而过来教训我的吗？」一旦开始思考他人的想法，各式各样的猜测都从心底里不断涌现，让我无心思考别的，注意力只专注在「他为什么要来到我的病床前。」</p><p>「我的疑问直到最后都没有得到他的解答。我想，那时的我之所以没有向他询问他为什么要来到我的病床前的答案是因为我还认为『反正我们的时间还很足够。』如果当时的我明白我们之间已经没有剩下多少时间的话，我一定会向他询问他当时为什么会来到我的病床前。</p><p>他坐到我病床旁的凳子上。他似乎是为了让我确定他手上什么也没有一般将两只手摊开放到我的眼前，在我确定后他手上没有任何东西后，他将手掌合起摩擦了两下手掌后，停下动作不动，正当我以为他发生什么情况而靠近查看时，随着一声轻微的声响后，他的手掌出现了一朵白色的花朵，那是一朵不管怎么看都跟真花这个定义无法搭边的人造花。但在他的手上，这朵花显得格外美丽，我想，眼前的这朵花它一定是我从过去到现在所见过花中最美的一朵，因为这朵花它不是为了别人，而是为了我而绽放的。</p><p>　　看完他的表演，过了一会，他似乎感觉自己将事情搞砸了一般低下头，看到他的这副样子我发出了笑声，他似乎对我的反应感到惊奇，用一副傻眼的表情看着我。</p><p>我不回应他，只是静静看着他手上的那朵纯白色的人造花。他看到我没回答，也很礼貌的不追问我，耐心的等待我的回答。我们之间大概经历了几分钟的沉默吧。</p><p>回过神来，我先对他表达了一声感谢。「谢谢。」我对旁边的他说道。</p><p>「不客气。刚刚你为什么要哭呢？」</p><p>「不知道。我知道我这么说你可能不太相信，但我哭的理由连我自己也不是非常清楚。我只是久违的想哭哭看，但没想到一哭起来就一发不可收拾了。」</p><p>「原来如此。你哭的理由我也不是不能理解。」</p><p>我想，就是在这个时候吧。让我首次对什么人产生了好感，不，那个时候这份感情也许还不能称为好感吧，可能更像是一种「眼前的这个人说不定会理解我的」这种心情吧。</p><p>自那天之后，我跟他的关系越来越好。他每天都会将他学习的魔术变给我看，尽管他的技巧不是多么高超，偶尔还会犯些小错误，但这些都没有关系。他的表演，是当时的我每天唯一期待的事情。</p><p>那时的我，由衷的期待这样的日子能更长一些，但我想老天爷就是那种不会聆听人愿望的存在。越是期待的事情越不可能实现，越是期待长久的事情就会越快结束，但要说这种话也得老天爷真的存在才可以，也许这时的我只是想借着老天爷表达些什么也说不定吧。</p><p>这一天，他也像平常一样来到我的病床旁将白天练习好的魔术变给我看。在他表演完后，我也像往常一样鼓掌。这时的我，还不知道他接下来即将要告诉我足以改变我往后人生的一句话。</p><p>如果故事在这里结束就好了，我曾无数次的如此期待，但我就是像是被冲上岸的人鱼一样无力，只有接受的这项选择。</p><p>「我准备离开了。」他很平静地对我说道。</p><p>因为事出突然，让我的反应一下慢了几秒。「准备离开？」我像是为了确定我没听错他说的话般将话重复了一遍。</p><p>「是的，医生前些日子来通知我可以离开的事情了。」</p><p>「……是这样啊，那恭喜你出院。」</p><p>「谢谢。」</p><p>「以后，我会跟你联系的，可以请你将你的联系地址给我吗？」</p><p>「可以，你等一下。」</p><p>他走到一旁的桌子上开始写东西。过了一会，他将写有他联系地址的纸条交给我。</p><p>我跟他的对话到此为止，跟他的关系也到此为止，已一段关系的结尾来说，说好听点也不能说是太好。</p><p>几天后，他的母亲就来到医院将他接走。离开时，他来到我的病床旁对我说了些什么，但当时的我根本没有将他的话听进耳朵只是尽可能的敷衍他赶紧离开。</p><p>我想，那时的我虽然想法上明白他的离开是迟早的事，但就是无法很好的感知他已经离开的这件事，在他离开后的那段日子里，我每天都期待着他能回到这间病房，再次来到我的病床旁将他练习好的魔术表演给我看，但在他离开快一个月后我也终于不得不接受他已经不会在回到这里来的这件事。</p><p>在他离开后的几个月后，我接到了医生的通知，说我可以暂时出院回家休养一段时间。在接到医生的出院通知时，说真的，我并没有感到多高兴，我只是满心想着「啊啊，终于可以离开这里了。」</p><p>隔天，我的母亲就来到病房接我。她走到我的病床旁对我说：「千草，准备一下。我们要走了。」</p><p>母亲的态度非常的冷淡。说真的，如果不是因为我跟母亲长的实在太过相像说我们是母女应该都没有人会相信。想必在母亲眼里，我一定是个令她感到厌烦的存在吧。</p><p>我不回应母亲，自顾自的穿上衣服等待母亲说离开。</p><p>「千草，我们走吧。」</p><p>拿上行李，我跟着母亲走出病房。走出这间曾经拥有着我跟他回忆的房间，这时的我，没有对即将失去这个回忆的场所表现出半点伤心的情感，我想那时的我还深深怀有着「没过多久我大概就要再次回到这里来的想法吧。」</p><p>然而我没有得到这个机会。就是在这天晚上，我第一次遇见了人鱼，不，应该说是自称人鱼的女巫吧。</p><h2 id="夏日的奇迹"><a href="#夏日的奇迹" class="headerlink" title="夏日的奇迹"></a>夏日的奇迹</h2><p>出了医院大门就看到父亲停好车子等在那边，自我开始住院起，我就基本没有见到过父亲，在我的印象里父亲是一个非常和蔼可亲的人，但现在我眼前的这个男人虽然面容与过去相比多了一种岁月的痕迹，但现在的他看起来跟过去那个和蔼可亲的父亲有了明显的不一样。</p><p>他看到我与母亲后叫我们上车坐好。我与母亲坐在父亲的车子后座。在开车回到家的路程中，母亲她们一句话也不说，只是静静地看着窗户外的景色。我原以为只要我的病情有所好转，母亲她们就会变回原本的样子，但事到如今，我才真的明白，只要病这种东西不从根本上解决掉，我所面临的问题就不会有任何的好转。</p><p>回到家中的我，坐上母亲准备好的轮椅，母亲站在我的身后，推着轮椅前进，让我回到自己的房间。</p><p>将我送到房间后，母亲对我说：「你先好好休息，等等吃饭了我会上来叫你。」</p><p>我正准备转头过去示意母亲我知道了，但转头过去她人已经不在那里。</p><p>我推动轮椅到书桌前。书桌上还放着我曾经看到一半的书与摆放着我还能站立时跟母亲她们一起在海边游玩的照片的相框，我拿起相框尝试看清母亲她们的笑容，但它与桌面上的书都积了一小层的灰，使我看不清照片原来的模样。对现在的我来说，母亲她们的笑容根本无法想像，我只能从曾经存在她们笑容中的物品中摄取一点「曾经母亲对我也是很温柔」的美好回忆。就在我如此回忆时，我心里曾经出现的那个声音再次对我说道：「事到如今，你才发现到这种行为只是自己单方面的自舔伤口吗？显然不是。你不是早已对这种状况心知肚明了吗？」</p><p>「你这是什么意思？」我对它询问到。</p><p>「你不懂我的意思吗？」它说道。</p><p>「那我转换一个说法来说好了，你真的是因为看不到她们的笑容才感到悲伤的吗？」</p><p>「……」</p><p>说完这句话，它就消失了。不论我如何在心中呼喊它，它都没有再对我做出回应。</p><p>我放下相框，坐在轮椅上静静思考它说的话，但不论我如何检视自己的脑袋都得不出合适的回答。</p><p>过了十几分钟，母亲上来叫我吃饭。</p><p>到了客厅，父亲正坐在椅子上看电视。母亲为我装好饭后，我们坐在客厅吃饭。吃饭过程中，父亲与母亲话也不说一句，只是各吃着自己的饭，在客厅里不断传来的只有从电视里发出的凄凉笑声。吃完饭后，我跟母亲说我想尽快回到房间休息，让她送我回房间。</p><p>回到房间后，我下了轮椅躺到床铺上，我没有任何想做的事情，躺到床铺上后我只是静静地看着天花板，也不知道是在什么时候，我就这么睡着了。</p><p>再次醒来，已经是深夜两点多。我坐上轮椅下到客厅寻找水喝，在喝了一点水后，我打开玄关的大门决定外出散散心。</p><p>这天深夜，我捏着轮椅轮子独自走在空无一人的街道上。 夏日夜晚吹来的凉风，有些格外的冷。但我不以为然，依然独自走着。 走了大约十分钟后，我来到了一处可以看到大海的沙滩。但走近一看，我才发现这片沙滩已经结束了它做为一片沙滩的使命。随处叠放的破旧电视、已经完全变了样的木制书架、屏幕裂开的电脑显示器，看到这幅景象不知怎么的我感到一种久违的安心感，仔细思考这份安心感之后我得出「大概是这里的环境不会在变的更差所以让我得到一种安心的感觉。」</p><p>随着海面吹来的凉风，让我的身体微微一震，为了避免感冒，我准备离开海滩回到家中。就是在这时，从不远处传来了那个声音，那个在现在这个时代已经基本听不到的那个声音。我朝着声音的方向看去，在那里的是一个与这个堆满破旧物品场所显得格格不入的鲜红色电话亭。我就像是被电话铃声吸引的傀儡一样，等我回过神来，我已经站在电话亭的旁边。在只有轻微海浪声的的海边，电话亭的电话铃声显得异常大声，正当我犹豫要不要走进电话亭接起这通「可能是打给固定某个人」的电话时，电话铃声中断了。听不见电话铃声后我不由自主的松了一口气，看来我比自己想像中更重视这通电话。但没过多久，电话铃声再次响起，它就像是知道我在电话旁边一样，电话的铃声不断的回响在夜晚的海边。我用力拉开电话亭的门，力气大到令我产生一种说不定会将整个门都扯下来的错觉。进入电话亭后，我还是犹豫着要不要接起这通可能是打给每天固定在这个时间会来到这里的某个人的电话又或者是无聊随便找了一个电话打，可能性这种东西一旦开始思考就会无止境的开始想像，但我的这个疑问，在接起电话后的几分钟就得到了电话那头的那个人的解答。就在我思考其他可能性时，电话也在一旁响个不停，仿佛是催促我赶紧接起电话。</p><p>「在做好被电话另外一头的人说一顿的准备后我接起了电话。」但之后的发展，完全超乎我的预估。</p><p>「你曾有一段放不下的过往对吗？荻上千草小姐。」</p><p>听筒那方说话的是一个女人，先不论她说的是什么，她确实准确无误的说出了我的名字，但她根本不给我多于的思考时间，只是自顾自的继续说着。我停止一切多余的想法，将注意力全部放在她接下来说的话。</p><p>「在不久前，你曾对深町阳介这个人产生了好感，但他突然地离开令你对他产生了一点不好的情感，同时你的心里也产生了一种如果不是我的腿脚不方便的话，我也许也能追上他的想法。」</p><p>那么，现在我来让你脚恢复成没有损伤前的状态，但与此同时，你也必须答应我一个条件。</p><p>听完她的发言，我花了大约近一分钟的时间才全部理清。理清思绪后我对她说道：「假设你说的是真的好了，但你知道你现在说的东西有多么疯狂吗？」</p><p>「我知道。但对现在的你来说这是一场不坏的交易吧？」</p><p>「你说的条件是指什么？」我问道。</p><p>「如果你不答应我玩这一场游戏，那么你知道这件事也没有什么用。」</p><p>我将听筒从嘴边拿开，陷入短暂的沉思。「正如电话那头的女人说所，如果先不看条件是什么，这对我来说的确是一场不坏的交易。」但这种说治就能治好的事情怎么可能存在，电话那头正在说话的女人一定是疯了。我准备就这样将电话挂断，但当我想这么做时，我的想法中出现了一种恶魔般的期待，「也许那个女人真的是拥有什么我无法想象的本事，确实能治疗好我的腿脚也说不定。」没过多久，我的脑袋就被「可能与不可能」这两种想法装满，根本无心想那个女人所说的条件到底是什么。</p><p>最后，我果然还是输给了自己的期待，我决定答应那个女人的游戏。但话说回来，我并不是真的打算相信那个女人所说的一切，我所采取的方法是「先答应她的游戏，看情况在决定日后的走向，毕竟这种说给你治好就能治好的人根本不可能存在。」</p><p>不论对方是想耍我还是别的什么，我都决定先答应她的游戏。</p><p>我拿起听筒对她说：「我决定参加你说的游戏，现在，可以请你告诉我条件是什么了吧？」</p><p>「可以。因为你已经接受了我的游戏。我的条件就是『你往后的人生中有一段时间是由我来掌握的，时间的长断也由我来决定。』」</p><p>「时间的长断也由你来决定？那你不就相当于把我的人生变成你的了吗？」</p><p>「话是如此。但你的人生值不值得我将它变成我的东西呢？」</p><p>这个女人的问题提的非常讽刺。她应该是故意这么说的，因为她毫无保留的用我能听懂的话说出我最讨厌的话。</p><p>我不回答她的问题。问她：「你什么时候能治好我的腿脚？」</p><p>「嘟嘟嘟嘟……」</p><p>那个女人将电话挂断。留下我一个人独自待在原地。伴随着电话挂断声，我的心情渐渐恢复平静。</p><p>离开电话亭，我坐在轮椅上思考那个女人到底是怎么知道我会在今天晚上外出。如果说我曾经会深夜外出那可能是我身边的某个人为了耍我而做的恶作剧，但今天我会出来纯属是巧合，就连我自己都无法预测到，当然如果说那个女人只是刚好撞上这个巧合打电话给我那只能说是巧合撞上巧合，但她准确的喊出了我的名字，如果事已至此在说这是巧合，就有点自欺欺人的感觉。我放松身体，靠在椅背上。不论我怎么思考，我都无法想出那个女人是如何做到的。</p><p>「不是有一个假说可以证明吗？」我的心中传来那个声音。</p><p>「你说的假说是什么？」</p><p>「你自己不是应该最清楚吗？其实你有解释这一切的答案，只是你自己不愿意接受那个答案罢了。」</p><p>不要说了。我没有完全相信那个女人说的一切，就算到了现在我的理性也由为清楚的告诉我「刚刚发生的一切其实是一场整人节目。」因为如果不是这样，那个女人所说的一切只能证明她疯了，事实上也可能确实是这样。</p><p>「如果说那个女人说的一切都是虚假的，那么曾一度尝试相信她发言的你岂不是更疯狂吗？」</p><p>我不回应它，任由它口沫横飞的说，也不知道是什么时候，它就不在说话就这么消失了。</p><p>在海滩上待了一段时间后，我准备起身回家，我捏着轮椅的轮子向着家的方向出发。海风像是要护送我回家一般，在我转身准备离开时吹起一阵清爽的凉风。我转身看向远方，浅黑色的天空正逐渐泛白。为了避免被父母发现我偷跑出来的事情，我加快速度回家。</p><p>到达家门前后，我避免发出声音小心翼翼的打开家门。家里跟我离开前没有什么变化，看起来，母亲她们应该还没有醒来。松了一口气后，我尽量避免发出声音回到自己的房间。</p><p>回到房间后，我躺到床上开始思考起今天晚上那个女人说的话。「那个女人所说的东西，虽然荒唐令人无法相信，但她确实说出了我的期待。如果说，她说的一切是真的，那对我来说说不定会是一件好事吧。」在思考这件事的过程中，我不知不觉间睡着了。</p><p>当然，隔天起床后我的期待没有实现，想来也是理所当然的，说治就能治好这件事怎么可能存在。虽然我自认自己没有在期待这件事的发生，但从结果上看，我比起自己认为的还要在意这件事。</p><p>我起身坐到床边看向窗外。窗外的天空像被石灰涂抹过一般灰蒙蒙的，使人无法看清天空原有的颜色。每到夏天，美渚汀都会异常的炎热，所以能在夏天里看到这样天气的日子实在是非常稀少。</p><p>明明是白天，但周围却安静的出奇，俨然就像是身处在一座空无一人的城市，但我并不讨厌这种感觉。</p><p>就在这时，从楼下传来一阵像是铃铛的声响，我不去搭理这个声音，但它就像是催促我赶紧过来一般不断的发出声响。我回到床上，将被子盖过头底决定不去理会就这么等它自己消失。过了一会，发出这个声响的人似乎是累了停止发出那一阵阵的声响，就在我以为不会发出声响准备在睡一觉时，门口传来敲门声。</p><p>我提高警觉，将注意力都放在门口上。这时，门外传来母亲的声音。</p><p>「千草，你睡醒了吗？」</p><p>在听到母亲的声音后，我的心情稍微得到了放松。我不回应她，等她自己离开。</p><p>但母亲像是看出我不想理她一般自顾自的说道：「千草，刚刚有送货员给你送来了东西，你有时间了出来拿一下。」</p><p>我不顾母亲说的东西，只是独自待在房间里看着一片洁白的天花板，家里洁白的天花板与我在医院里看到的非常相似，记得那时是我刚住进医院没多久的一天。</p><p>那天在接到医生的报告后我躺在病床上想医生先前说过的话。但话说回来，我不记得医生说了些什么，我的意识从医生说出「以后你再也无法行走」这句话后就中断了，我想医生在那之后说的话我都无法准确的体会吧。</p><p>「尽管到了现在，我也无法准确相信自己已经无法走路，但我就像是路边的小石子一样，既便被人踢动也无法做出任何反抗。」</p><p>这时，我想起母亲对我说起过的放在门口的东西。</p><p>我打开房门，一个纸箱正放在那里。在确定了收件人荻上千草后我才将纸箱拿进房间。</p><p>我拆开纸箱，里面放着用看起来很高级的牛皮纸封起来的信封，信封的上面写着我的名字。拆开信件，里面放着一张来自参叶国中的录取通知书，除了通知书以外还有一套一起寄来的水手服，看来这套衣服就是参叶国中的校服。</p><p>如果说，这封录取通知书能在早一点寄来我应该会发自心底里的高兴吧，但现在的我即便收到这封录取通知书也丝毫想笑的感觉都没有，我只是满心想着「啊啊，原来还有这件事啊。」不过，现在才寄到也没有什么用了吧？以我现在这副样子，是绝对无法正常上下学的。</p><p>我坐在轮椅上不动，「为什么这种事情偏偏要发生在我的身上？」我对着空无一人的房间问道。当然，我并没有得到回答，我只是独自思考着这件事。越想只觉得这个世界上的一切是那么的不合理想尽情破坏。</p><p>我搜索周围有没有即便破坏了也没有关系的东西，最后，我的视线放到了跟随录取通知书一起寄过来的水手服。「反正我也没办法去上学了这衣服就算怎么样了也没有关系吧？」我在桌子上找能破坏衣服的工具，这时，我看到了沾了一点灰尘的笔筒里插着用来剪纸的小剪刀，到了这时我才发现，这个剪刀原来除了剪纸还能用来剪破衣服。</p><p>我将衣服拿起放在眼前，将拿着的剪刀对准衣服靠近，准备就这么剪下去。</p><p>「咚咚咚……」门外突如其来的一阵声音使我的脑袋一下冷静了下来，我停下手中的动作任由剪刀与校服从我手中滑落。缓过神来时门外的那个声音已经停止了。</p><p>我将校服与滑落的剪刀捡起收拾好放在桌面上后躺到床上。</p><p>我将毛毯盖过头顶什么也不想只是这么躲到漆黑一片的世界里，因为我觉得如果不这么做，我一定又会做出什么比刚刚更出格的事情，也不知道过了多久，我就这么睡着了。</p><p>我独自一人坐在轮椅上看着大海，海水随着一阵阵波浪拍打着岸边溅起形状不一的浪花，眼前的景色很美，我发自心底里的这么认为。正当我准备继续享受这段安静的时间时，我的意识中断了。</p><p>在眼睛只能睁开到一部分的状态下我最先看到的是类似我房间的天花板图像，我努力让眼睛对焦将眼前的图像合成一幅清晰的画面，但意识的不清晰使我没能成功。刚从睡梦中清醒的身体本能的向我的脑袋发出需求水的要求，喉咙就像是被火烤一般传来一种异常难受的感觉，我下了床铺走到桌前拿起水杯里的水喝，但杯子里只有不到一点的水根本不够喝。</p><p>我打开房门准备走下楼梯，意识还不清晰的我为了避免踩空扶着楼梯间的栏杆一步步慢慢走向厨房。到到厨房后我就像是饥饿到了极点的野狼一样冲到冰箱前从里面取出清水喝下，缓解了口渴后我打开厨房的后门走到外面。</p><p>夏天是非常炎热的一个季节，我想这应该很多人知道，但是晚上的夏天却非常凉爽，我想这应该很少人知道，至少在这美渚汀里夏天的夜晚基本不会有人在外面。</p><p>迎面吹来的凉风非常的清爽，这阵风中既有炎热夏天的味道也有夜晚的夏天的感觉。「夏天真的是一个很不可思议的季节呢」我如此想道。</p><p>在吹了一会凉风后，模糊的意识也逐渐清晰，我关上后门准备就这么回到房里继续睡觉。</p><p>走出厨房的几秒钟我突然意识到一件事，一件在很久以前我还会天天做的事，但那件事由于几个月前发生的事故而剥夺走了我做这件事的权力。这辈子恐怕在也无法走路了，医院里的医生对我如此说道。几经尝试没有用后我也终于决定接受自己无法在走路这个无力改变的状况时，几天前的那个深夜，那个女人所说的东西却颠覆了我原本的认为。当时的我以为这只是一场无聊的整人节目，但现在眼前发生的状况却告诉我那个女人所说的一切都是真的。</p><p>「我的大腿正比直的站立着……」</p><p>因为事情发生的太过突然，我甚至怀疑自己是不是根本没有睡醒还在梦境中又或者是天天想着大腿能复原而最终想疯了导致脑袋出现问题认为自己的大腿终于好了。</p><p>但事实上我的脑袋非常清楚，因为脑袋有问题的人是不可能觉察到自己的脑袋有问题的。</p><p>正当我为眼前的状况找不着头绪时，那个声音再次在黑暗的空间里响起了，那个可能可以解决我一切问题的声音。</p><p>走廊的另外一头，座机正发出一声声声响。我就像是害怕失去刚刚得到零用钱的小孩子一样跑到座机前接起电话。</p><p>我原以为我会对着电话那头提出一大堆问题，但事实上我却什么也说不出只是静静等待着电话那一边的人说话。</p><p>「晚上好，荻上小姐。」</p><p>「……」我不回应她，等待她继续向下说。 也许你现在正在想为什么我会知道你家里的电话，为什么会知道你现在会站在座机的旁边又或者为什么我会选择现在打电话给你吧？</p><p>「……你，你到底是什么人？」</p><p>电话那头的女人用很得意的声音回答我道：「我是人鱼王国的人鱼。」</p><p>「人鱼王国的人鱼？」我就像是为了避免听错一样，而重复了一遍她刚刚说的话。</p><p>「是的。」</p><p>如果说，将这个女人现在所说的话放在曾经我一定不会去给予理睬，但现在我却开始相信这个女人说的东西是真的，我想我根本就是疯了。</p><p>你打电话来做什么？</p><p>「来做什么？做为治疗好你大腿的条件你忘记了吗？」</p><p>当她说到条件时我才想起这件已经被我忘到脑袋角落的重要事情。</p><p>「所以说，你现在是来履行你的条件的吗？」</p><p>「不是。我今天打电话来是为了恭喜你的。」</p><p>「那还真是谢谢你。」</p><p>「嘟嘟嘟嘟……」</p><p>那个女人不等我说完就将电话挂断，她就像是夜晚里的星星一样在白天即将来临时什么痕迹也不留的就这么消失了。</p><p>这天夜里，我基本没有睡着，只是静静地看着天花板与大腿度过夜晚漫长的时间。我想我应该是在害怕吧，害怕一旦闭上眼睛，大腿就会恢复成无法行走的模样，害怕一旦睡着再次醒来时就会发现大腿复原只是我做的一个美梦。</p><p>但隔天醒来后，我周围发生的情况都在告诉我「这不是在做一场美梦，我的大腿确实复原了。」</p><p>我能准确体会到我的大腿已经复原这件事全靠母亲与父亲脸上惊讶的表情。简单来说，当他们看见我的大腿可以笔直站立时，他们的嘴巴张大到了可以当做下巴的位置，他们甚至以为两个人产生了相同的幻觉看见了一个跟自己女儿长的非常像的人而不停的询问有关过去的事情来确认我是他们的女儿「荻上千草」这个人。不过，他们反应也是很正常的，毕竟在几个月前自己的女儿已经被医生打上了「这一辈子都不可能在行走的标签」会感觉到惊讶也是理所当然的吧。</p><p>父亲与母亲他们将我的大腿复原归究于奇迹这类的说法，虽然他们嘴上对我这么说，但我很清楚他们根本没有了解事情经过的打算，他们只是将眼前看得见却无法理解的东西给归为奇迹这类的说法罢了。</p><p>自那一天起，我的生活有了很大的改变，父亲与母亲对我的态度越来越和善，来到新学校后同学们对我非常好，我的朋友也逐渐多了起来，在这之后，我的父亲因为工作上的成功顺利买下了一套比我们之前住的要好的多的房子。自那一天起，我身边所有的事情都变的越来越好，我就像是要将先前不幸时期没有使用过的运气放到现在全部使用完一样不断过着幸福的生活。如果一定要形容这段生活的话，就像是一种周围一切都变的太合理的这种感觉。我就像是《灰姑娘》故事中的灰姑娘一样，在得到了女巫的帮助后就此过上与之前截然不同的幸福人生，但自从那一天起这个自称人鱼的女人就像是《灰姑娘》故事中的女巫一样在帮助了我之后就这么消失没在我的身边出现过。</p><p>她消失的这段时间里已经让我将她曾经说的约定忘到了记忆的深处。</p><p>「这时的我因为过于注重眼前的幸福，而忽视了今后的日子。但是我想不只是我，这个世界上应该也有人拥有着这种『只要现在好，以后的事情以后再说吧』的处事论吧。」</p><p>在大腿复原后的那段日子里每当父母对我露出他们那种久违的笑容时我都深刻感觉到「如果我的大腿不复原那一切应该就不会是这样了吧」的想法，其实会有这段想法也不是什么奇怪的事情，如果你也曾经看过我住院时期母亲他们对我露出的态度就会完全理解我说的东西了。</p><p>「也许任何人在拥有成功一面的背后也都潜藏着一败涂地的可能性，只可惜到了如今依然有很多人不顾眼前难以翻身的局面只是相信着所谓的曾经或者以后可能会变好的以后。如果说，人所面临的问题不能得到根本的解决，周围的情况是很难拥有好的转变的，我再次深刻感受到这点。也许人生就是这种只要出现蝴蝶振翅般的变化就会走上与曾经截然不同的路。」</p><p>今日，我向往常一样外出上完学回到家中在自己的房间里看书。看书这个习惯是从我小时候就拥有的习惯，除了住院那段时间停止后我对看书这件事依然保持着很高的热情，如果说我的房间里有什么跟我这个年纪很不相配的东西那就是我的房间里摆放着一个放满书的大型书架。母亲看到我天天在家中看书也难免担心我会不会因为看书这件事而变得无法跟周围的人正常沟通只是天天看书，她也曾耐心劝导我要出去跟朋友玩，但被我以「我想将我住院时期没看完的书看完」为由给拒绝了。不过话说回来，这些书不论我看书怎么慢也完全可以在一年内看完，到了我升上国中三年级马上就要毕业升上高中的现在，母亲也没有再来劝导我出去想必是因为她已经发现了，她的女儿我不想出去这件事吧。</p><p>说起我国中度过的日子，虽然可以说是有趣但绝对谈不上是会让我印象深刻的校园生活。尽管我上的是美渚汀里最好的国中，尽管我在学校里有很多的朋友，尽管我在里面有很多快乐的回忆但我就是会记不住这些，比起这三年来的快乐记忆我在国小时期的悲惨生活还让我更印象深刻一点，但如果要说在这三年里有什么事情是让能我印象深刻的话，确实是有一件事。</p><p>记得那是在刚上国中的第一天，在临近上课前的几分钟我坐到座位上拿出教科书预习等等课上要教的内容，但在隔了三个位置的右手边有一个位置上发出异常吵杂的声音，那声音并不是由一个人发出，而是至少有四，五个人在说话，它们说出的话杂乱在一起使人根本无法听清它们到底说了些什么。起先我以为那些人正在霸凌什么人，但从他们的装束上看去并不像是那种小混混的打扮。在他们中的一个人离开后我看见了那个女孩子，在看见那个女孩子后我也终于理解为什么那群人会挤在那个位置的附近，因为那个位置上坐着初鹿野 唯。</p><p>其实什么位置坐上了什么人对我来说都没有太大的影响，但是这个女孩子与我不同，她却有着坐上了什么位置都能带来影响的魅力。</p><p>自那之后我总是不自主的去注意这个女孩子，一旦开始注意她后，我就很明显的发现这个班上的大部分人也都基本将注意力放在初鹿野 唯这个女生身上，不过想来也是很正常的，如果说我是个男孩子我也一定会对她产生好感，她就是有这样的魅力。</p><p>从她的表现上来看，她很清楚自己的魅力但从来不过度使用，她与任何人都保持着一定的距离，既不会让人感觉到遥不可及也不会让人感到太好亲近但她对周围人群的笑容让我感到一种痛心疾首，她的笑容有种勉强的感觉在其中，如果不是我也曾经经历过这种笑容想必是不可能发现的吧。但当时的我根本无心探究她为什么会这么笑，如果说初鹿野 唯这个女孩子除去这点真的可以说是完美，她的魅力不只是从她的样貌中散发出来的，她的举手投足或者行动方面都做的非常出色，那时的我对她的表现感到一种发自心底里的佩服。</p><p>初鹿野 唯这个女孩子的笑容给我一种勉强自己的想法这种感觉也只到国中二年级时。还记得那是正值夏日的某一天，初鹿野 唯也像往常一样来上学。最早注意到初鹿野身上异常的是经常会跑到她身边找她聊天的一个名叫「美纪」的女孩子。她看着初鹿野的脸说道：「唯，你的脸上那个黑点是怎么回事？」听到她这么说，周围的人马上跑到了初鹿野的身旁开始问她脸上的黑点是怎么回事？但初鹿野并没有回答她们，只是摸着脸上的黑点像是在抚摸什么来之不易的宝物一样。原本大家都以为那是年纪到了会自然长在脸上的东西所以没有在提起这个黑点的事情。</p><p>但自从那天过后的半个月，初鹿野脸上的黑点越来越大，现在已经长到有小半块脸的程度。对于这个类似污秽的痕迹，同学们之间存在着很多的说法，有的人说初鹿野是活该，有的人同情初鹿野的遭遇，有的人说初鹿野可怜，有的人对于初鹿野的遭遇感到开心，真的可谓是五花八门。但初鹿野本人似乎根本不在意这些，反倒因为脸上长了这个污秽的痕迹而感到开心，周围同情初鹿野遭遇的同学们也积极鼓励她不要自我放弃，她也像是将这份鼓励深深记在心里一样积极回应周围鼓励她的同学们。那个时期的初鹿野如果要说与曾经有什么明显的不一样的话我想就是出现在她脸上的污秽与她笑容中出现的改变。她的笑容与过去有着明显的不同。如果说她曾经的笑容给我的感觉是一种「什么美好东西被破坏殆尽所剩下的残骸」的话，那么她现在的笑容给我的感觉「就像是得到了什么无可替代的美好东西一样。」但对于我来说，她的改变不只是这些。</p><p>初鹿野脸上的那个痕迹跟我曾经看过的他脸上的痕迹很像，跟那个曾经被我单方面讨厌又被我单方面当做朋友的他。</p><p>「这时我还没能理解到，初鹿野脸上的那个痕迹会对我们三个人的人生产生多大的改变。我只是静静地享受着当下的幸福人生，如果说我能早些觉察到初鹿野脸上的痕迹是怎么回事，也许一切就会不同了，但我值到最后也没能得到这个机会，也许这就是对我的报应吧，对一心耽溺于幸福人生的我的报应。」</p><p>曾经身为初鹿野同班同学的我们一直都无法理解一件事，那件事是发生在升上国中三年级的时候。某一天初鹿野没有来上学，在这天之后的明天，后天，大后天她也都没有来上课。虽然老师说是初鹿野同学家中发生了一些事情，但看老师回应的态度她也应该不是很清楚发生了什么事。就这样，她一个星期都没有来上学，再次看见初鹿野时，我想谁都无法相信眼前这位态度冰冷的少女会是曾经那个积极回应大家鼓励的少女。虽然同学们都有问她发生了什么事，但初鹿野本人一点都不愿意谈，即便是导师问她她也只是以「没什么」应付她。</p><p>自那时起，初鹿野就很少来到学校，就算偶尔来到学校里也只是什么都不说一个人坐在座位上，久而久之曾经跟初鹿野熟识的人也开始觉得初鹿野不想跟她们做朋友了而逐渐蔬远她。虽然同学们私底下会讨论初鹿野的身上发生了什么，但却不在她的面前问这件事了，不在她面前讨论这件事，在不知不觉间同学们形成了这种默契。</p><p>距离上一次见到她，已经是三个星期以前的事情。这时同学们都忙着学习或者开始考虑上什么高中而烦恼着，而我则已经通过自考进入了「美渚第一高中」就在前几天我的录取通知书也已经收到了，虽然母亲跟我说不去学校上学也没有什么关系了，但我还是坚持想将国中时期的日子全部过完。我想对我来说这段国中生的日子算是代表了我幸福的一段日子。</p><p>「然而幸福这种东西，一旦到了某个瞬间就会完全抛弃你。」明白这件事是在国中毕业典礼的当天。</p><p>这天，我起晚了，一睡醒换上校服就赶到学校参加毕业典礼。到达学校时，校门口已经被数不清的父母们围住，我花了不少气力才成功进入学校。到达校内后我赶到班上，同学们正兴趣高涨的讨论着今后的去向以及放假了要去哪里游玩等等，我则坐在座位上等候老师过来通知毕业典礼的开始时间。大约过了二十分钟，老师来到班上通知我们下去集合开毕业典礼，到达体育馆后老师开始点名，在点到初鹿野名字时班上没有人应答也没有任何人说出她去了哪里，老师也不管她如何只是持续着点名，在确定了只有初鹿野一个人没来后老师告诉我们不要吵闹便离开了座位。</p><p>过了几分钟，校长走到了讲台上开始致毕业典礼词。讲了大约二十来分钟后，校长以「在这里，祝各位同学顺利毕业」为最后一句话结束了这场毕业典礼。毕业典礼结束后，老师走到我们的面前通知我们拿上放在班级里的东西就可以回家了。</p><p>回到班上，同学们先是各自道别在来就是决定放假后组织一起去哪里玩。当然，我没能参加去哪里游玩的讨论，这样说可能有点问题，准确来说是我自己不想去参加那边的讨论。我跟几个关系要好的同学们道别后就离开了教室踏上了回家的路。</p><p>这时，如果我已经知道我没有多少时间的话我想我至少应该跟她们每个人认真道别一下才对，但我没有得到这个机会。</p><p>进入家中后，我被家中突然响起的一阵声音给吓了一跳。我朝声音的来源靠近发现是家中的座机正在响，我想也没多想就接起了电话。</p><p>「首先，恭喜你国中毕业。荻上千草小姐。」</p><p>电话那头传来我熟悉的声音。</p><p>「……你打电话过来不可能是单纯为了恭喜我的吧？」</p><p>「是的。我这一次打电话过来还有一件事但恭喜你国中毕业也是真的。」</p><p>「那还真是谢谢你。那么，你说的另外一件事是什么？」</p><p>「你果然忘记我们的约定了啊。」</p><p>当她说出约定后，我开始回溯记忆中的约定，到了这时我才明白她这次打电话来是为了什么。</p><p>「你现在是来实现跟我的约定的是吧？」</p><p>「看起来，你想起来是什么事情了。是的，这次我打电话过来就是为了实现这个约定的。」</p><p>「……如果我违约的话，你会怎么样？」</p><p>「违约吗？我想你自己应该非常清楚违约的话会有怎么样的后果吧。」</p><p>「……」</p><p>「在你拿走这个身体前，我有一件事想问你。」</p><p>「荻上千草小姐，我想你现在没有理由可以问我什么事吧？」</p><p>「话虽如此，但你会选择在这个时间段拿走我的身体一定有你的理由吧？」</p><p>「我想就凭这点，我有理由可以问你事情。」</p><p>那个女人发出一声类似嘲笑般的笑声后对我说：「虽然我没有义务回答你的问题，但做为你最后的一个问题我就回答你好了。」</p><p>「请说吧。荻上千草小姐。」</p><p>「深町阳介现在过的好吗？」</p><p>「……没想到。」</p><p>「我原以为你会问我一些你什么时候将身体还给我或者我可以活多久这类的问题，没想到你竟然会问我关于别人的事情。」</p><p>我不说话，等待她解答我的疑问。</p><p>「他过的不算好。」</p><p>「不算好是怎么回事？」我反问她。</p><p>你的一个问题我已经回答完了，荻上千草小姐。</p><p>「对你来说，他的事情你只要了解到这里就好了。」</p><p>「了解到这里是怎么回事？他现在到底过……的」我的意识到这里中断了。</p><p>再次恢复意识醒来时，我正躺在医院的病床上。意识恢复大半后，我坐起身来，在我起身后一个蓝白相间的记事本滑落到病床的边缘线附近，我拿起记事本翻开。上面写着的是距今一年前值到前几天发生的事，但我回溯记忆我根本没有写过这种东西，而且记事本上面写着的事情我根本都没有印象。这时，我想到了那个女人，那个自称是人鱼的女人，如果说这个记事本上面写的一切都是真的话，那么写这个记事本的人一定就是她。</p><p>我不懂她这么做的用意，但她放在这里一定是希望让我看，虽然我没有肯定的根据，但我就是这么认为的。</p><p>我坐在床上将记事本翻到第一页开始看起，那是从我失去意识后的隔天开始的故事，那是发生在一九九几年的夏天里的故事。</p>]]></content>
      
      
      <categories>
          
          <category> 短篇小说 </category>
          
          <category> 系缒三日的秋天 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 轻小说 </tag>
            
            <tag> 三秋缒 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《重启人生》 ——致，我一落千丈的人生</title>
      <link href="/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E7%B3%BB%E7%BC%92%E4%B8%89%E6%97%A5%E7%9A%84%E7%A7%8B%E5%A4%A9/starting-over-again/"/>
      <url>/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E7%B3%BB%E7%BC%92%E4%B8%89%E6%97%A5%E7%9A%84%E7%A7%8B%E5%A4%A9/starting-over-again/</url>
      
        <content type="html"><![CDATA[<p>转自：知乎</p><span id="more"></span><p>我接下来要说的故事跟你曾经听过的故事可能有所不同。</p><p>如果说人生可以重新开始，很多的人应该都会利用第一人生中的后悔与反省来期待更加美好的第二人生。</p><p>每个人应该多少都有那么些后悔。有的人后悔没有在年轻时代好好爱过一个人，有的人后悔在年轻时代谈了恋爱，有的人后悔没有好好跟父母说过一次话，有的人后悔告诉父母什么事，有的人后悔跟什么人扯上关系，有的人后悔没跟什么人早点变熟。嗯，总之我想表达的就是「人生就是伴随着后悔」关于这点，你也应该大致会认同。</p><p>但是，说起我做的事，几乎跟上述完全相反呢。不，其实我也曾做过蠢事哦。</p><p>当我得知我的人生倒转了十年我是这么想的。「为什么要对我做这么多于的事情？」</p><p>成为一个对自己人生毫无后悔的人应该非常稀有吧，什么重新开始人生的机会应该要给那些天天祈祷人生能够重新来过的人吧？但是呢，机会这种东西往往是给那些不祈求机会的人，从这点来看老天爷还真是爱唱反调呢，当然，要说这种话也得老天爷真的存在才行呢。我应该是想通过老天爷来表达些什么吧。</p><p>说起曾经我是如何忍受那么悲惨的高中生活？说起来也是非常无聊的理由。</p><p>在教室里面有一个男生，那个看起来与我一样被人孤立起来的人。他跟我一样没有朋友可以聊天，至少在我可以看见的时间里我从来看见他与什么人交谈过。眼睛里总是表露出一种「我根本不属于这里的眼神」，他就是这样的一个男生。</p><p>真要说的话，他的个子还算高，长着清秀的五官。他的视线总是朝下，偶尔必须与人四目相对时就像是在瞪别人一样，就算与人沟通也从来都是一副高高在上，完全不在意别人的态度。虽然他的态度如此，但从旁看来他完全不具备拥有这种态度的资格就是了。</p><p>他与我念的是同一所国中，我们在国中时代绝不是找不到任何朋友，只要我们愿意主动开口搭话，分散在教室角落的那些人自然会将我们当做朋友。但很糟糕的是，当时的我心中还怀有着很强的坚持，打个比方来说就是「我认为我还是曾经那个人人称赞的女生。」我从以前就认为朋友这种东西就是应该由其他人来主动靠近我的。当然，就算我在怎么迟钝，也不可能对不主动就交不到朋友这点没有任何的察觉，准确来说是我察觉了却完全没有想行动的想法。</p><p>我曾以为，时间过去我所面临的问题就会有所好转，但实际情况却不是如此，我所面临的问题的确没有变的更坏，但也没有任何好转的现象。谁也不能保证等了就会有好的结果，就像是雨等了也不一定会变小，离开的人等了也不一定就会回来，我的等待只是再一次的重现了过去无数人所证明的不可能。</p><p>不知不觉就说到了朋友这个方面上，我本来是要说怎么度过这段悲惨生活的吧？</p><p>那是升上国中三年级的时候，比起先前，我在班上受到孤立时的自卑感变的异常大。每当到了这种时候我总是看向那个男生，看向那个与我一样没有任何朋友的男生。说起来，我的做法真的是很不要脸「也就是说我将那个男生的悲惨经历当做一种理所应当的镇静剂，虽然我很清楚这种做法有多么不要脸，但当时的我如果没有这么做，就一定无法保持正常的理性。」话说回来，我感觉他也是将我的处境当做一种镇静剂来保持他的理智。你可能会想说我有被害妄想症，但如果你看过一次他的眼神你就会完全理解我在说什么了，那是一种彻底地瞧不起人的眼神，也就是说我们两个人虽然想的不同，但骨子里却是同一类人吧。</p><p>说起被孤立时的状态？真的是糟糕透了，但当时的我因为有他的存在而感到庆幸，光是看着他不幸的模样就让我深深的感到救赎哦。我曾不只一次凭借着「我虽然被女生们孤立，但跟他比起来我还是有一些方面比他强来看不起他。而他则是凭着我虽然被男生们孤立，但比起男生被孤立还是女生被孤立比较可怜吧来看不起我。」嗯，当时的我们就是借着这种想法来伤害彼此与互相安慰的。</p><p>一年级的时候，我还不太习惯这种孤单一人的生活，而跑去图书馆看书打发时间。而他也是这样，所以我们经常在图书馆碰到。虽然我们认识彼此，但却不会出口打招呼，只是就这么擦肩而过，不打扰对方。</p><p>在每个月都会来访的意志消沉期，我总是选择去医务室来躲避这段时间。然而每三次就会有一次跟他碰到，看来他跟我想逃的课都是一样的啊。</p><p>虽然这种做法不是很好，但是效果却很显著。如今回忆起来，如果不是有他的存在，我或许早就离开了那间学校，一个人躲在房间里很闷酒也说不定，但正他的出现，我才没有变成这样，我由衷的感谢他出现的这件事。</p><p>在那之后，我与他的关系变的更亲密了，明明我们两个人根本不像是那种可以与人变的亲密的样子，但也许正是因为当时的我们怀着这种相同的想法才导致我们多多少少变亲密了一点吧。</p><p>还记得那是因为班导多于的想法，让我们可以自由选择座位，但自由选择座位的人不能选择最后一排，由此一来坐最后一排的人就成了完全不介意座位的人。当时的我每五次换座位就会有一次跟他坐一起，自此之后大家好像也都将我跟他坐一起视为一种合情合理。每当大家投来那种好像我们是一对的眼神时，我总是在想「有没有搞错，为什么会把我跟这种人想成一对？我的男朋友可比他优秀太多了，把我跟他想成一对我也很困扰的好不好？」每到了这种需要忍受同学眼神时我总是看向他以求得心灵上的慰藉。</p><p>我跟他不仅是孤立的原因相同，就连孤立的本质也很相同。我们都有着一副「我们根本不属于这种地方」的眼神。其实就我而言我非常清楚第二人生的自己有多么不像样，根本就没有任何资格去小看他人，但是每当我想起第一人生的种种时我总是想着「你们这些人跟我第一人生所交的朋友根本就是两个极端，看不起你们也是理所应当的吧」。当然，在她们看来我可能是比他们更不怎么样的人就是了。</p><p>我总是因为想着第一人生的幸福，才导致迟迟无法接受第二人生的现状。就算到了现在，我也不断的在想「为什么我的第二人生会变成这样？我明明是按照第一人生一样的选择来做的，为什么会出现如此大的偏差？也许正是因为经历了完美幸福的第一人生，才导致了我无法接受现在的第二人生也说不定。」</p><p>这天，离开学校回到家的我，将书包扔在地上后就躺到床上。我闭上眼睛，回忆起第一人生的幸福与常叶在一起的日子。回忆第一人生的幸福，这是来到第二人生的我每天必做的事情，无论春夏秋冬，阴晴雨雪我都不曾中断这件事。每当回忆起第一人生的幸福，我就越感第二人生的糟糕，真的是糟糕的人生呢。我想这就是对我的报复吧，不是对任何人，而是对我的报复，对天天耽溺于幸福的我的报复。话说回来，我也曾想过会不会就是因为老是想着第一人生的幸福，才导致第二人生的我迟迟无法融入这个环境。</p><p>我祈祷着一觉醒来，第三人生能重新开始，我怀抱着这份期待睡着了。</p><p>醒来之后，映入眼帘的是房间的天花板。意识清醒后，我朝自己的手看去，并没有变小。我的祈祷失败，第三人生变没有开始，我还是待在第二人生里，也许是我睡糊涂了「认为只要我希望，第三人生就会重新开始，实际上发生在我身上的事情本来就是『不可能发生的事情』」，而这种现象只能称它为奇迹了，而我却想有意识的去引发奇迹，看来我真的是睡糊涂了。我曾在一本医学书上看到，身患绝症的人有可能在自己不知道的情况下痊愈，而这种现象只能说是奇迹，但这种奇迹不可能连续两次降临在同一个人身上。现在，我对这点已经很明确地体会到了。</p><p>我自以为自己没有期待第三人生，但醒来之后发现人生没有改变的我比我自己原本想的还要失落，看来我远比我自己想的还要更期待第三人生。</p><p>我本以为我的这种愚蠢会因为时间而渐渐被消磨殆尽，但经过了这样的一段时间后我才明白真正被消磨殆尽的并不是这份愚蠢，而是我自身。</p><p>就在日复一日的这种状态中，我迎来了高中的毕业典礼，紧接着是原本应该让我感到开心的大学生活。</p><p>原本看起来美丽的一切，现在看起来是那么的刺眼让我打从心底里感到厌恶。</p><p>「今天，就放弃去学校好了。」决定好后，我打电话给班导已身体不舒服为由请假。</p><p>请好假后，我回到床铺里面继续补觉，自从来到第二人生后，我的睡眠时间就比第一人生增加了几倍，曾经我认为睡觉是人生的浪费，但现在我觉得睡觉才是人生的一件大事。要我来说，之所以会认为睡觉是人生的浪费那是因为活着的人有太多要做的事与幸福所以才会认为睡觉这种要花费几个小时的事情是一种浪费，这句话既然是由曾经过的非常幸福的我来说就一定没错。假设一个人活着不会发生任何好事那对这个人来说它还会继续醒着延长这份痛苦吗，我想不会，所以睡觉这种可以减少几个小时痛苦的事就成了对我们这种人的恩惠。醒来之后，我独自一人躲在公寓里面喝闷酒，我原本以为酒这种东西跟我这种人是最没有缘分，但从结果来看，我错了，酒跟我们这种人的契合度是最高的。</p><p>不过这件事只有当人生过的不幸之后才能理解实在是太讽刺了。</p><p>说到底，只是我将一切想的都的太简单了。</p><p>我以为只要一切按照过去的模样重新下棋，我的人生就能变成我期待的模样，可单我下完后，坐在我对面的命运却一步步将我推落地狱的深渊。</p><p>如果说，我早一点觉察到这不对劲。</p><p>如果说，我早一点明白选择的相同，不代表带来的结果也是相同这件事的话，我想一切也许就不会是现在这样了。</p><p>可一旦究其根源，都是因为我与其他人做了不一样的选择。</p><p>可这又有什么错，比起那些贪婪的人企图改变悲惨人生的人，我只是遵守了规则，选择了重现我原本的人生，我只是按照了原本的历史，应该没有任何的问题才对啊。</p><p>但到了现在回过来想截至目前的一切，我也才明白，我不打算改变人生这点就是我最大的错误。</p><p>因为我做了与其它人截然不同的选择。</p><p>因为我选择了不改变人生，与其它人不同，我知道未来的一切，因为我的选择让原本不可定的未来变成了确定，我为了自己的幸福而忽视了原本未来可能改变的一切。</p><p>手上的啤酒罐发出刺耳的声音。</p><p>我将已经变了形的啤酒罐用力甩在地上。</p><p>「可是这一切跟我有什么关系啊。」</p><p>「我只是遵从了原本的人生，没有为此做过任何错误的事，我只是期待一切能像原来一样啊。」</p><p>那是原本就属于我的人生、我的过去、我的未来、我的现在，我的一切，这原本都该是属于我的东西却都因为那个「分身」而一切都变了样。</p><p>我无时不无刻都希望那个「分身」赶快消失。</p><p>只要一旦她消失了，常叶一定就会看向除了她以外最符合第一人生女友的我了。</p><p>可是根本没有任何确切的根据指明「分身」消失后一定是这样，在与原本人生的对照下，我根本就无法再肯定的说出一定会是这样这种话了。</p><p>虽然心里很明白这件事，可我只能无力的选择相信，不然我想我一定会受不了接连而至的现实。</p><p>为了平复自己的内心，在这之后我采取了连我自己都难以想象的做法。</p><p>当我回过神来时，我已经成了新闻上很经常听到的跟踪犯。</p><p>至于我为什么会采取这样的行动在这之后我也无法说出个大概。</p><p>如果一定要给这个行动找个理由那我认为最符合的说法就是「慰藉。」</p><p>可我很清楚，这根本就不可能从根本上解救我，相反会让我心中的裂缝更加的增大。</p><p>我只能从跟踪常叶与第一人生中的回忆中摄取幸福的养分，但越是这样只能越发的感到空虚。</p><p>但我很清楚，这根本不是长久的。</p><p>总有一天，我会将幸福的花蜜吸食殆尽从而导致花朵的枯萎。</p><p>旧的回忆总会被新的记忆取代，而能根本解决这个问题的方法其实在一开始离我很近，只是因为我表现的太有把握了，所以一切才变的不断超出我的预计。</p><p>如果在那一刻，我能不那么有把握而是遵从第一人生中的不安与担心或许结果就会导向与第一人生完全相同的结果。</p><p>现在就算想起来那时的记忆，也尽是让人感到不快。</p><p>那是在国中三年级与第一人生中相同的樱花盛开的季节中的某一天傍晚。</p><p>与第一人生相同，当无关紧要的人都离开后教室后只剩下常叶与我独自留在教室中。</p><p>「与第一人生中完全相同。」我在心中想到。</p><p>在符合的时间点出现了该出现的人。</p><p>「只要完成这最后一步，这样至少算是完成了一个阶段。」</p><p>可是常叶却自始至终不对我开口，好像只是在单方面的享受着两个人独处一室却互不发言的这种氛围。</p><p>就在我想着该如何让常叶开口时，常叶他却先开口了。</p><p>「柊同学，这样会不会很尴尬？」</p><p>「终于来了，想好该怎么跟我告白了吗？」</p><p>当然，我只是将这想法埋藏在心里并没有说出来，我表现的不以为然的回答道。</p><p>「不会，倒是常叶同学你不回去吗？」</p><p>「对不起，让你感觉困扰了吗？」</p><p>「我不是这个意思，只是好奇这个放学时间为什么你还不准备回去。」</p><p>「我也不太明白，总感觉有什么事情还没做所以还不能走。」</p><p>「是这样啊。」</p><p>「你还没向我告白呢，我已经做好了答应的准备，你可以来告白了。」</p><p>「……那个，柊同学。」</p><p>「来了，终于要来了。」</p><p>「叮叮叮叮叮叮……」</p><p>伴随着刺耳的清校铃声，完全的掩盖了常叶的声音。</p><p>「对不起，常叶同学你刚刚说什么？我没听清楚。」</p><p>「也没什么特别的，只是到了清校时间，女孩子一个人回家也不安全吧，想问一下你要跟我一起走吗？」</p><p>「说的也是，那就麻烦你了。」</p><p>「真是倒霉，偏偏在这个时候响起铃声。」</p><p>我在心里埋怨了一句。</p><p>如果不是因为这个铃声，常叶应该就会顺势对我表白了。</p><p>但是现在换到公园去，我想结果也是一样的就没有多在意。</p><p>但我这时根本就忘记了，我从这一刻开始就已经偏离了第一人生。</p><p>这个细微的改动带动了接下来的一切连锁反应。</p><p>被夕阳染红的街道我与常叶的身影融入其中。</p><p>被夕阳照耀着常叶的侧脸看起来有点不同于同龄人的成熟。</p><p>「会这样也是理所应当的。」</p><p>毕竟他可是我第一人生中的男朋友。</p><p>就算是到了第二人生有这么优秀也是理所应当的吧。</p><p>沉默在我们之间弥漫开来。</p><p>时间仿佛定格在了一刻间，常叶不在说一句话，我们只是抱持着适当的距离肩并肩走着。</p><p>「不好意思，让你感觉尴尬了吧。柊同学。」</p><p>常叶开口打破了我们之间的沉默。</p><p>「不会，我想你一定是在想什么事情吧。」</p><p>「很明显吗？」</p><p>「嗯，很明显，就像是已经写在脸上等待别人来说一样。」</p><p>常叶干笑了几声回答我。</p><p>「不好意思，影响你心情了吧。」</p><p>「不会，看你这个样子一定是什么很重要的事情吧。」</p><p>「嗯，是对我来说很重要的一件事。」</p><p>「关于以后升学的事吗？」</p><p>「……不是。」</p><p>不知道是不是因为夕阳照射的角度不同了，常叶的脸看起来有些许微红。</p><p>「……老实说，我也不知道该怎么说这种事情。」</p><p>看这个模样「一定是指对我告白这件事了。」我在心里想到。</p><p>「如果你不介意，可以跟我说说。」</p><p>「这不太合适吧。」常叶想了一会说道。</p><p>「……」</p><p>「这有什么不好意思的，我明明都已经给你一个绝好的告白机会了。」</p><p>当然我并没有将这句话说出口。</p><p>就在我刚刚短暂的犹豫之中，我想起第一人生中他对我告白时的场景，他紧张的神情、颤抖的声音，我想常叶现在所体会的应该就是第一人生中他的那种苦恼。第一人生中的他在鼓起勇气向我告白前也一定是在这样的犹豫后才做了决定。</p><p>或许真的是我太着急了，我其实根本没有必要去刻意制作方便常叶来告白的场景，当他想好一切自然就会遵守第一人生中的一切来找我告白，我只需要适当的引导常叶做这个选择就好了。</p><p>「既然你都这么说了，那我就不问了。但是我觉得你既然有想做的事情那就去做吧。」</p><p>「不管结果是怎么样，至少不要让自己留下遗憾。」</p><p>「说的也是，谢谢你。柊同学。」</p><p>这样就好了。我只需要进行引导接下来只要等待常叶的告白就可以了。</p><p>「不客气，以后如果有什么问题也可以跟我说。」</p><p>然后我们就这样你一句我一句不断的闲聊着。</p><p>这之后我与常叶的关系一天比一天亲密但自始至终常叶都不来向我告白。</p><p>虽然从那天后我知道等待是一个磨人的过程，我也明白我不能着急为了最好的还原历史，我所能做的就是等待。</p><p>但耐心伴随着一天、两天、一个星期、两个星期、甚至快过了一个月我都还没有得到常叶的告白，就在我终于快忍耐不住时常叶终于来找我了他说有件事想告诉我。</p><p>「等待终于得到了回报。」</p><p>还好我一直等待，接下来一切就会按照原本的历史进行下去。</p><p>我是这么想的。</p><p>「我准备向喜欢的女孩子告白了。」</p><p>「终于来了。」</p><p>「说起来常叶你还记得我们第一次一起回家时也跟我说过有在烦恼的事情吧。」</p><p>「难道就是这件事吗？」</p><p>其实这个问题根本毫无意义，经历过第一人生的我很清楚这个问题的答案，只是在即将迎面而来的幸福前不经意的想去抓弄一下。</p><p>「嗯，因为那时我还没有决定，因为对方是个很好的人我觉得自己配不上她所以不敢尝试告白。」</p><p>「常叶的这番话让我不禁想起第一人生中他跟我告白时的模样，原来他当时表现的那种紧张是因为担心这个。」</p><p>「不过，我想你应该不用担心，只要将你真实的心情传达给对方，我想对方一定会感觉到。」</p><p>「那你准备好告白了吗？常叶。」</p><p>「嗯，我想明天就告白。」</p><p>「……或许，现在也可以哦。」</p><p>「谢谢你，但是我还是打算按照自己本来想的那样去告白。」</p><p>「是这样啊。」</p><p>「他们果然就像是游戏中出现的固定角色一样，只会遵照原本的计划来不会根据眼前的情况做出改变。」</p><p>我在心里叹了一口气。</p><p>不过仔细想想他们也只是遵守原本人生，对我来说也节省了我去刻意引导人生走向同样结果的辛苦。</p><p>与常叶道别回到自己家后，我倒在床铺上想着常叶明天会怎么跟我告白。</p><p>会是跟第一人生一样的告白吗？还是说有一点不同呢。</p><p>应该是会有一点不一样吧，毕竟常叶给我与第一人生中的他，该怎么说？感觉还是有一点不同，不过我想这也是正常的吧。就像是电脑主机关闭重新启动的过程中会额外生成一些其它东西，常叶恐怕也只是经历了相同的过程。</p><p>这天晚上我倒在床铺上翻来覆去也睡不着，一心只想着即将迎面而来的幸福。根本无心思考其它的事情。</p><p>一个晚上转眼即逝，我打开房间的窗户，窗户外的天空染上了一层乌云。</p><p>说起来，昨天的天气预报中好像是有提到今天可能会下雨。</p><p>「老天爷也真是不做美。」我在心里想到。</p><p>坐在教室里的时候我等待着时间尽快度过。</p><p>终于等到放学时间，班级上的人一个个离开教室只剩下我跟常叶后我想终于可以跟第一人生一样了。</p><p>可是常叶却始终不朝我走来。</p><p>就在我奇怪是怎么回事时，教室的门被拉开。</p><p>是一个女孩子。</p><p>她看了一眼坐在教室中的我跟常叶。</p><p>「不好意思，我进错教室了。」说完她将教室的门再度拉上。</p><p>可是就算门关上后常叶也是一言不发的坐在那边。</p><p>我们就这么坐着事情不会有一点前进。</p><p>我站起身拿起书包朝教室外走去。</p><p>这样一来常叶不会还是什么动作都没有吧。</p><p>可当我用眼角的余光扫到常叶他还是仍然坐在那边。</p><p>「喂，你在做什么？常叶。你的告白对象的我可是要离开了你怎么还在那边不动？」</p><p>「你到底在做什么啊。」</p><p>「就算是在紧张看到我这样了你都还是没有任何举动吗？」</p><p>「我就不相信我真的离开了你还能这样坐在那里。」</p><p>我走出教室将门拉上。</p><p>在没有人的走廊一步又一步踩到地板上的声音显异常大声。</p><p>一步、两步、十几步，走到走廊尽头下楼的楼梯就在那，我回头看向教室的位置，常叶仍然没有走出来。</p><p>我走下楼，每到一层就停下来等一会常叶追上来。</p><p>慢慢的我已经走到第一层常叶却还是没有追上来。</p><p>我就这样独自一人站在教学楼的门口等待常叶出来。</p><p>可不管我等了多久常叶就是没有出来。</p><p>「就算是紧张我也不至于到这种程度吧。」</p><p>觉得事情有点不对劲的我走上楼到我们的教室。</p><p>快到教室门口时我听到了常叶的声音。</p><p>「我喜欢你，请你跟我交往吧。」</p><p>常叶说完后没有任何回应。</p><p>「原来是这样，常叶是在做对我告白的预演。」</p><p>「如果这个时候看到我来，他一定会很惊讶吧，预演被要告白的对象听到，不知道他的脸会红到什么样。」</p><p>正当我走到教室外一点准备拉开教室门时，教室门的玻璃上透出的景象却与我想的完全不是一个模样。</p><p>常叶的面前站着一个女孩子。</p><p>是刚刚打开门进来教室的女孩子。</p><p>她刚刚不是已经走了吗？为什么会在这里？常叶为什么要对她告白？</p><p>这些问题一下冲上脑袋，一时之间我根本来不及处理这么多问题，而在下一秒。</p><p>从教室中传出了女孩子的声音。</p><p>「……好的。」</p><p>我没有多想马上逃离了现场，我也不知道是怎么回事，心里只想着尽快离开这里，不管是哪里都好，只要尽快离开这里。</p><p>这天的隔天我直接以身体不适为理由请假在家。</p><p>在隔天被父母以「现在是升学的重要时期不要浪费时间」而被催促去学校。</p><p>可是到了学校我也根本无心去学习，我的心自始至终都停留在常叶对那个女孩子告白的那一刻。</p><p>在我恍惚中已经到了放学时间。</p><p>将我拉回现实的是常叶。</p><p>「柊同学，你没事吧。」</p><p>意识从恍惚中清醒。</p><p>「啊，我没事。」</p><p>「我看你今天脸色不太正常，而且昨天也请假，你病还没好吗？要不要去保健室请老师看看。」</p><p>「不用了，我们走吧。」</p><p>回家路上，常叶的脸上毫不掩饰开心。</p><p>「谢谢你，柊同学。」</p><p>「欸？为什么要向我道谢？」</p><p>「因为你的鼓励我已经向喜欢的女孩子告白成功了，她已经答应做我的女朋友了。」</p><p>其实我本来昨天就想告诉你这件事并跟你道谢的，结果你没有来但是今天说也不晚吧。</p><p>「真的非常谢谢你，柊同学。」</p><p>常叶的眼中没有一丝虚假，他是真的感谢我。</p><p>「……不……不要，拜托你不要用这种眼神看我。」</p><p>我推了一下常叶从他身边跑开，我想在常叶的眼中我的眼神一定像是看到了什么可怕的东西。</p><p>这天之后我总是刻意的回避着常叶，在上课时我也根本没有了任何的心思，当然在这样的状态持续了一段时间后，毫无疑问我的成绩自然避免不了逐渐变坏的局面。</p><p>最后在面临升学考试时我的成绩与第一人生时相比更是一落千丈。</p><p>在这之后我进了一所比第一人生差的多的高中。</p><p>入学后的分班，虽然周围看起来都是一群笨蛋但是到了这种学校的我毫无疑问也已经成为它们的其中一员。不过至少在这里我不用担心会遇见常叶。</p><p>至少在这这个学校里我可以享受之前我没能享受的心灵上的安静。</p><p>不管怎么回忆都尽是让人不快的记忆。</p><p>我停止回忆从回忆中抽身，我想我明天还是会像今天一样吧。</p><p>成为一个跟踪狂，借此给予自己心灵上的慰藉。</p><p>我讨厌这样的自己。</p>]]></content>
      
      
      <categories>
          
          <category> 短篇小说 </category>
          
          <category> 系缒三日的秋天 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 轻小说 </tag>
            
            <tag> 三秋缒 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>温乙己</title>
      <link href="/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E6%97%AD%E6%97%A5%E4%B8%9C%E5%8D%87%E7%9A%84%E4%BC%A0%E8%AF%B4/i-may-ak-ipho/"/>
      <url>/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E6%97%AD%E6%97%A5%E4%B8%9C%E5%8D%87%E7%9A%84%E4%BC%A0%E8%AF%B4/i-may-ak-ipho/</url>
      
        <content type="html"><![CDATA[<p>东辰高中竞赛教室的格局，是和别处不同的。</p><span id="more"></span><p>东辰高中竞赛教室的格局，是和别处不同的：都是前面一个长方形的大展台，台上预备着答题卡，可以随时考试。停课搞竞赛的人，早上七点四十，每每散步到教室去，吃魏主任买的包子，——这是退役前的事，现在六点二十起床，——几个人分一袋，热热的吃了刷题；倘肯多花七块，便可以买一瓶<a href="https://www.zhihu.com/search?q=雀巢咖啡&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={:,:1540871187}">雀巢咖啡</a>，做饮料了。食堂是有早饭的，但这些搞竞赛的，多是懒狗，大抵起不了那么早。只有学常规的，才踱进学校食堂里，要大红枣汁酸奶，慢慢地坐喝。</p><p>我从高一起，便在东辰高中学物竞，教练说，样子太傻，怕进不了省队，就混个省一罢。外面的竞赛主任，虽然容易说话，但唠唠叨叨缠夹不清的时候也很不少。他往往要亲眼看着试卷被发下来，看过有没有人考试时睡觉，又亲看试卷被收上去，然后放心：在这严重监督下，划水也很为难。所以过了几天，教练又说我得不了省一靠前。幸亏我的脸皮厚，劝退不得，便改为专混省一垫底的一种无聊职务了。</p><p>我从此便整天的坐在座位上里，专刷我的<a href="https://www.zhihu.com/search?q=程书&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={:,:1540871187}">程书</a>。虽然没有什么失职，但总觉得有些单调，有些无聊。教练是一副凶脸孔，班主任也没有好声气，教人活泼不得；只有<a href="https://www.zhihu.com/search?q=温志强&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={:,:1540871187}">温志强</a>上课，才可以笑几声，所以至今还记得。</p><p>温志强是没读过什么正经大学而教竞赛的唯一的人。他身材很高大；青白脸色，言语间时常夹些他妈的；一部乱蓬蓬的头发。穿的虽然是耐克，可是又脏又破，似乎十多年没有补，也没有洗。他对人说话，总是满口<a href="https://www.zhihu.com/search?q=四大力学&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={:,:1540871187}">四大力学</a>，叫人半懂不懂的。因为他姓温，别人便从描红纸上的“国际金牌教练温志强”这半懂不懂的话里，替他取下一个绰号，叫作温大神。温志强一到班，所有刷题或者划水的人便都看着他笑，有的叫道，“温老师，你出的题又在其他机构出现了！”他不回答，对学生说，“那几道题做完了没有”便排出九页答案。他们又故意的高声嚷道，“你一定又抄了国际竞赛题了！”温志强睁大眼睛说，“你怎么这样凭空污人清白……”“什么清白？我前天亲眼见你偷了那道黑洞的题，吊着打。”温志强便涨红了脸，额上的青筋条条绽出，争辩道，“借鉴不能算偷……借鉴！……金牌竞赛教练的事，能算偷么？”接连便是难懂的话，什么“场论弦论”，什么“格林互易定理”之类，引得众人都哄笑起来：教室内外充满了快活的空气。</p><p>听人家背地里谈论，温志强原来也去嘉祥应聘过，但终于没有应聘上，又不会教常规，于是愈过愈穷，弄到将要到东辰来教书了。幸而装的一手好逼，便骗骗校领导，有了百万年薪。可惜他又有一样坏脾气，便是好耍懒做。教不到几十分钟，便连人和手机游戏，一齐失踪。如是几次，觉得他很吊的人也不多了。温志强没有法，便免不了经常做些装逼的事。但他在我们学校里，品行却比别人都好，就是从不拖堂；虽然间或没有题目的答案，暂时记在笔记本上，但到了一月的第 $32$ 天，定然给学生答案，从笔记本上拭去了温志强的名字。</p><p>温志强上了十分钟课，涨红的脸色渐渐复了原，旁人便又问道，“温老师，你当真教过国际金牌么？”温志强看着问他的人，显出不屑置辩的神气。他们便接着说道，“你怎的在网上半个名字都搜索不到呢？”温志强立刻显出颓唐不安模样，脸上笼上了一层灰色，嘴里说些话；这回可全是<a href="https://www.zhihu.com/search?q=杨天华&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={:,:1540871187}">杨天华</a>，熊召西，以前深圳中学的校长看他不爽，不准他宣传之类，一些不懂了。在这时候，众人也都哄笑起来：教室内外充满了快活的空气。</p><p>有几回，他批改的题有问题，同学们围住了温志强。他便给他们解释。同学们听了解释，仍然不服，眼睛都望着iPad。温志强着了慌，伸开五指将iPad罩住，弯腰下去说道，“不多了，我会的题已经不多了。”直起身又看一看解析，自己摇头说，“不多不多！多乎哉？不多也。”于是这一群学生都在笑声里回座位了。</p><p>温志强是这样的使人快活，可是没有他，别人也便这么过。</p><p>有一天，大约是复赛前的两三天，某物竞的一方通行正在慢慢的刷模拟卷，取下课堂用本，忽然说，“温志强长久没有来了。还欠十九个答案解析呢！”我才也觉得他的确长久没有来了。一个刷试题选的人说道，“他怎么会来？……他会出的题出完了。”某物竞的一方通行说，“哦！”“他总仍旧是装逼。这一回，是自己发昏，竟装到祝大爷家里去了。他面前，装得的吗？”“后来怎么样？”“怎么样？先说他给东辰要教出几个国际金牌，后来是集训队，装了大半夜，再说这一届可以出几个省队。”“后来呢？”“后来请他去绵阳最贵的餐厅吃饭了。”“吃了饭怎样呢？”“怎样？……谁晓得？许是去小学部从小培养竞赛了。”一方通行也不再问，仍然慢慢的刷他的卷子。</p><p>竞赛出名单过后，秋风是一天凉比一天，看看将近一诊；我整天的补常规，也须穿上校服外套了。一天的下半天，竞赛教室没有一个人，我正合了眼坐着。忽然间听得一个声音，“我烟呢。”这声音虽然极低，却很耳熟。看时又全没有人。站起来向外一望，那温志强便在花坛下对了台阶坐着。他脸上黑而且瘦，已经不成样子；穿一件破卫衣，盘着两腿，下面垫一个挎包，用草绳在肩上挂住；见了我，又说道，“这么简单的题，考得太烂了。”某咸鱼也伸出头去，一面说，“温志强么？你还考前还压了三十个题呢！”温志强很颓唐的仰面答道，“这……这回没中罢。这一回是卢竟，把我的题用来湖南内部考试了。”我仍然同平常一样，笑着对他说，“温志强，你又装了逼了！”但他这回却不十分分辩，单说了一句“不要取笑！”“取笑？要是不装逼，怎么会考前骗我们？”温志强低声说道，“决赛题我经常压中，还有金秋营……”他的眼色，很像恳求我，不要再提。此时已经聚集了几个学弟，便和他们都笑了。我把他说价值数十万的几十套卷子，端出去，放在垃圾桶里。他告诉我他的题是多么多么好，一定不能泄露，见他满手是泥，原来他便用这手打篮球的。不一会，他打完他的部落冲突，便又在旁人的说笑声中，慢慢走去了。</p><p>自此以后，又长久没有看见温志强。到了年关，我取下课堂用本说，“温志强还欠十九个解析呢！”到第二年的二诊，又说“温志强还欠十九个解析呢！”到三诊可是没有说，再到高考也没有看见他。</p><p>我到现在终于没有见——大约温志强的确只懂怎么教物理竞赛国际金牌。</p>]]></content>
      
      
      <categories>
          
          <category> 短篇小说 </category>
          
          <category> 旭日东升的传说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 东辰 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《那年夏天……》——经过彻底思量后犯下的错误，仍有着媲美正确答案的价值</title>
      <link href="/Eternity/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/summer-complex/"/>
      <url>/Eternity/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/summer-complex/</url>
      
        <content type="html"><![CDATA[<p>作者：（日本）三秋缒</p><p>作品名：《那年夏天，你打来的电话》《那年夏天，我拨去的电话》</p><span id="more"></span><p>如果说《重启人生》给了我感同身受的失败感，则《那年夏天……》给了我非同凡响的治愈。</p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>分为上下册的较长小说，也能算是一部佳作了。（光是唯的封面已经把我的 $xp$戳爆了）</p><h3 id="那年夏天，你打来的电话"><a href="#那年夏天，你打来的电话" class="headerlink" title="那年夏天，你打来的电话"></a>那年夏天，你打来的电话</h3><blockquote><p>拿起听筒的那个瞬间，不可思议的夏天就此拉开序幕。</p><p>“要不要来打个赌？”</p><p>电话那边传来了一个女声，“十岁那年的夏天，你对初鹿野同学心生好感。但对当时的你而言，初鹿野同学实在太遥远。你心想‘我没有资格喜欢她’，用这种想法压抑自己对她的感情。同时你却有另一种想法——‘要不是这个胎记，也许我们的关系会不太一样’。那么，就让我去掉你的胎记看看吧。如果你能因此得到初鹿野同学的心，这场赌局就算你赢。”</p></blockquote><h3 id="那年夏天，我拨去的电话"><a href="#那年夏天，我拨去的电话" class="headerlink" title="那年夏天，我拨去的电话"></a>那年夏天，我拨去的电话</h3><blockquote><p>我一直认为，只要没有这块丑陋的胎记，就能赢得初鹿野的心。于是我答应了神秘女子的赌局，获得了理想的容貌。但讽刺的是，当我和初鹿野重逢时，却在她的脸上看到了似曾相识的丑陋胎记。面对性格大变的初鹿野，我束手无策。同时还被告知，如果不能在规定时间内获得初鹿野的心，等待我的是和童话《人鱼公主》相同的结局。</p><p>夏日的末尾，这场拼尽一切的豪赌即将迎来结果的揭晓。</p></blockquote><h2 id="一些感想"><a href="#一些感想" class="headerlink" title="一些感想"></a>一些感想</h2><p>在托管的晚上 $11:00$ 结束了两本书的阅读。说句实话，对于我这种读书不带脑子的人， $90\%$ 的结局都猜不到，所以才会觉得所有我读过的书的结局都很新颖吧。这，算幸运还是不幸呢。</p><hr><p><strong>警告，以下内容涉嫌剧透，如果没有读过原著，请酌情阅读！！！</strong></p><hr><h3 id="对书中人物的看法"><a href="#对书中人物的看法" class="headerlink" title="对书中人物的看法"></a>对书中人物的看法</h3><h4 id="深町阳介"><a href="#深町阳介" class="headerlink" title="深町阳介"></a>深町阳介</h4><p>作为“我”，已经做到了。这就是为什么三秋缒能写出如此完美的第一人称式小说，就只有他，能够讲述这个夏天的故事。无论从语文角度而讲的人物描写，还是单从轻小说角度而言的一切。这一个人物的塑造都是完美的。</p><h4 id="荻上千草"><a href="#荻上千草" class="headerlink" title="荻上千草"></a>荻上千草</h4><p>无论是人类，亦或是人鱼，两者其实都是一样的，作为一个 $16$ 岁的高中生，洋溢了青春，对健康有所展望，在“我”犯下错误之后去提醒和帮助，并非无情，但也将赌者之心展现的淋漓尽致。这便是小说中悬念能够打动我的原因。也许有人猜到了结局，很可惜，我没有。我上文也说过，即使是这样，我也是满足的，这样才会有惊喜与惊吓。就如同……<font style="color:white">如果人生一样都望到头了，哪还有什么意义可言呢。</font></p><h4 id="初鹿野唯"><a href="#初鹿野唯" class="headerlink" title="初鹿野唯"></a>初鹿野唯</h4><p>太戳xp了，无论是失忆前或者失忆后，无论有胎记还是没有胎记。我挺喜欢这类女生的，不因高高捧起而自高自大，发自内心的善良能够改变他人，也不因挫败而垂头丧气，在忘掉一切之后坦然接受，保持一颗开朗的心去面对生活，也许以前我遇见过一个，可惜，可惜已经没有可惜了吧。</p><p>阿姜告诉我，他不太喜欢唯的原因是因为胎记，但在我看来，即使有胎记，我也是喜欢的。就像做过的英语阅读一样，不因外貌而取人，不因富贵而取人，如果真心喜欢一个人，便不需要理由。</p><h2 id="摘抄"><a href="#摘抄" class="headerlink" title="摘抄"></a>摘抄</h2><blockquote><p>真要说起来，人多多少少都是一边忘记一些事情一边活下去。真的什么都记得住的人，只有那么一小撮而已。可是，谁也不会抱怨这一点。你知道为什么吗？我想这是因为，大家都知道，到头来所谓的回忆只不过就像奖杯或纪念品，当下这一瞬间才是最重要的。</p><p>你听我说。你也许不知道，但我很喜欢跟你说话。喜欢单方面听你说话、喜欢单方面说话给你听，也喜欢跟你什么都不说，就只是待在一起。要是你不在了，我会非常寂寞。所以，请你不要擅自消失……我可是很担心的喔。</p><p>中岛敦说过，要是什么都不做，人生未免太长；但真要做什么，却又未免太短。八十次夏天，对于无法享受夏天的人来说太多，对于能够享受的人则太少。相信就是这么回事。</p><p>当然说到底，“喜欢”的理由全都是事后安上去的。喜欢星星的人生下来就是会喜欢上星星，就这么简单。</p><p>小时候每个人都是公主、每个人都是王子，做梦也不会想到自己竟然不是灰姑娘，而是她的姊姊。但随着年纪增长，会渐渐感觉到自我认知与他人评价之间有着落差，让人们不得不慢慢修正认知中的自己：我不是公主，我不是王子。</p><p>「那么，我换个问法吧，你希望幽灵是什么样的东西？」<br>她喝了一口饮料，抬头看着天空。湿润的嘴唇被阳光照得发出闪闪白光。 「我想想……以我来说，我希望幽灵是种受了很多苦，怨恨活人、为自己的际遇悲叹的东西。」<br>「为什么？」<br>「如果是这样，不就会觉得活着还稍微好上那么一点吗？」她说话时仍然仰望着天空。「如果幽灵全都是露出一脸安详的表情照看着活人，我应该会很羡慕他们，而想加入他们吧。」</p><p>看在旁人眼里，可能会觉得我只是个被困在孩缇时代记忆当中的傻瓜。但是不管别人怎么说我都不在乎。我想到我死为止，都会是这段记忆的幸福奴隶。</p><p>是夏天的尾声会先到，还是我会先死去？如果可以，我希望我能在夏天结束之前离开这个世界。在积雨云消失之前，在蝉全部消失之前，在向日葵枯萎之前。因为不管什么时候，最寂寞的都是最后一个离开的人。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 阅读笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 轻小说 </tag>
            
            <tag> 三秋缒 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>斜率优化dp/凸包优化dp</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-convex-hull-optimization/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-convex-hull-optimization/</url>
      
        <content type="html"><![CDATA[<p>“不可名状”</p><span id="more"></span><p>对于一个转移方程，能够表示为：</p><p>$f[i]=Kc[i]+B$ </p><p>的一次函数形式，它则可以使用斜率优化，用于解决单调队列解决不了的问题。</p><p>单调队列可以解决形如 $f[i]=f[j]+x[i]$ 形式的问题，</p><p>而斜率优化用于解决形如 $f[i]=f[j]+x[i]\times x[j]$ 之类拥有 $x[i]\times x[j]$ 形式的转移方程。</p><p>这种题可以使用：</p><ol><li>决策单调性优化dp</li><li>斜率优化dp</li><li>高级数据结构优化dp（如李超线段树）</li></ol><p>来解决。</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="P2365-任务安排"><a href="#P2365-任务安排" class="headerlink" title="P2365 任务安排"></a><a href="https://www.luogu.com.cn/problem/P2365">P2365 任务安排</a></h3><h4 id="朴素思想"><a href="#朴素思想" class="headerlink" title="朴素思想"></a>朴素思想</h4><p>首先应该知道，不分批并不一定是最优的，因为<strong>每个任务的完成时间规定为其所在批次的最后一个任务的完成时间</strong>。</p><p>用 $dp[i][j]$ 来表示当前第 $i$ 个工程，已经分了 $j$ 组的最小代价，用 $pret[]$ 和 $prec[]$ 数组表示两个代价的前缀和。</p><p>则有：</p><p>$dp[i,j]=\min\limits_{0\leq k&lt;i}\{dp[k,j-1]+(s\times j+pret[i])\times (prec[i]-prec[k])\}$</p><p>时间复杂度 $O(n^3)$ ，空间复杂度 $O(n^2)$ ，不够</p><h4 id="费用提前计算优化"><a href="#费用提前计算优化" class="headerlink" title="费用提前计算优化"></a>费用提前计算优化</h4><p>根据以往的做题经验，我们尝试把二维化成一维，即让 $dp[i]$表示前 $i$ 个任务分批执行的最小费用。</p><p>但是这样我们就不知道机器启动过几次了！</p><p>别慌，冷静分析一下你会发现，如果我们要从 $dp[j]$ 转移到 $dp[i]$ 的话，由于第 $j+1\sim i$ 都是在同一批内完成的，我们只需要把 $s$ 对 $j+1$ 后的影响补充到费用中就可以了！</p><p>$dp[i]=\min\limits_{0\leq k&lt;i}\{dp[j]+pret[i]\times(prec[i]-prec[j])+s\times (prec[n]-prec[j])\}$</p><p>时间复杂度 $\mathcal O(n^2)$ ，这就是<strong>费用提前计算</strong>的思想。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">5e3</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,S;</span><br><span class="line">ll dp[MAXN],Tme[MAXN],Cst[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-slopeopt.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-slopeopt.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">read</span>(Tme[i],Cst[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=N;++i) Tme[i]+=Tme[i<span class="number">-1</span>],Cst[i]+=Cst[i<span class="number">-1</span>];</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;i;++j)</span><br><span class="line">            dp[i]=<span class="built_in">min</span>(dp[i],dp[j]+Tme[i]*(Cst[i]-Cst[j])+S*(Cst[N]-Cst[j]));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,dp[N]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h4 id="斜率优化"><a href="#斜率优化" class="headerlink" title="斜率优化"></a>斜率优化</h4><p>对于上述的转移方程而言，一共有三个会影响答案的变量：</p><p>$j,dp[j],dp[i]$</p><p>把最小值去掉，然后化简：</p><p>$dp[j]=(s+pret[i])\times prec[j]+dp[i]-pret[i]\times prec[i]-s\times prec[n]$</p><p>那么，这是一个 $dp[j]$ 关于 $prec[j]$ 的一次函数。</p><p>斜率为 $s+pret[i]$ ，截距为 $dp[i]-pret[i]\times prec[i]-s\times prec[n]$</p><p>目标是 $dp[i]$ 最小，即<strong>截距</strong>最小。</p><hr><p>接下来，我会以我所理解的斜率优化阐述，可能不对，慎重阅读！！！</p><hr><p>首先，做出 $x=prec[j],y=dp[j]$ 的图像。并做出相应的散点 $(prec[j],dp[j])$ 。（我们这里首先只说横坐标单调递增的情况）</p><p>对于每一次计算 $i$ 时，我们将一条斜率为 $s+pret[i]$ 的直线从 $-\inf$ 开始向上移动，对于第一个碰到的点，该点对应的截距就是 $\min\{dp[i]\}$ 。</p><p>而对于用 $\mathcal{O}(1)$ 的时间找出最小的点，我们用类似于单调队列优化里的思想维护散点组成的凸包的下凸边即可。</p><p>对于一个点是否在凸包上，满足：</p><ul><li>该点与上一个凸包点组成直线的斜率小于当前斜率；</li><li>该点与下一个凸包点组成直线的斜率大于当前斜率。</li></ul><p>即对于 $j_1&lt;j_2&lt;j_3$ ，使 $j_2$ 成为凸包点的条件：</p><ul><li>如果上凸，则 $j_2$ 不可能为最优。</li><li>如果下凸，且 $\frac{dp[j_2]-dp[j_1]}{prec[j_2]-prec[j_1]}&lt;\frac{dp[j_3]-dp[j_2]}{prec[j_3]-prec[j_2]}$ 。</li></ul><p>简单来说，对于这三个点，只要 $l_{j_1-j_2}$ 的斜率小于 $l_{j_2-j_3}$ 的斜率即可。</p><p>然后就是类似于单调队列的维护了：</p><ul><li>检查队头元素 $q[l]$ 和 $q[l+1]$ 所构成的直线斜率是否满足：$\frac{dp[q[l+1]]-dp[q[l]]}{prec[q[l+1]]-prec[q[l]]}\leq s+pret[i]$ ，如果满足，则执行 <code>++head</code> ，重复该步骤。</li><li>取出当前队头，更新答案。</li><li>检查队尾元素 $j_1=q[r-1]$ 和 $j_2=q[r]$ ，和当前点 $j_{3}=i$ ，是否满足斜率单调递增，如果不是，则执行 <code>--tail</code> ，重复该步骤。</li><li><code>q[++tail]=i</code></li></ul><p>完成。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">3e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,S;</span><br><span class="line">ll dp[MAXN],Tme[MAXN],Cst[MAXN];</span><br><span class="line"><span class="type">int</span> Q[MAXN],head,tail;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-slopeopt.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-slopeopt.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">read</span>(Tme[i],Cst[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=N;++i) Tme[i]+=Tme[i<span class="number">-1</span>],Cst[i]+=Cst[i<span class="number">-1</span>];</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">/*for(int i=1;i&lt;=N;++i)</span></span><br><span class="line"><span class="comment">        for(int j=0;j&lt;i;++j)</span></span><br><span class="line"><span class="comment">            dp[i]=min(dp[i],dp[j]+Tme[i]*(Cst[i]-Cst[j])+S*(Cst[N]-Cst[j]));*/</span></span><br><span class="line">    <span class="comment">//O(n^2)</span></span><br><span class="line">    Q[<span class="number">1</span>]=<span class="number">0</span>,head=tail=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;(dp[Q[head+<span class="number">1</span>]]-dp[Q[head]])&lt;=(Tme[i]+S)*(Cst[Q[head+<span class="number">1</span>]]-Cst[Q[head]])) ++head;</span><br><span class="line">        <span class="type">int</span> j=Q[head];</span><br><span class="line">        dp[i]=dp[j]-(Tme[i]+S)*(Cst[j])+Tme[i]*Cst[i]+S*Cst[N];</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;(dp[Q[tail]]-dp[Q[tail<span class="number">-1</span>]])*(Cst[i]-Cst[Q[tail]])&gt;=(dp[i]-dp[Q[tail]])*(Cst[Q[tail]]-Cst[Q[tail<span class="number">-1</span>]])) --tail;</span><br><span class="line">        Q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,dp[N]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">4 3</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="P3195-HNOI2008-玩具装箱"><a href="#P3195-HNOI2008-玩具装箱" class="headerlink" title="P3195 [HNOI2008]玩具装箱"></a><a href="https://www.luogu.com.cn/problem/P3195">P3195 [HNOI2008]玩具装箱</a></h3><h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><p>这道题看似是紫题，其实也是一道斜率优化的模板题。</p><p>令 $a[i]=sum[i]+i,b[i]=a[i]+L+1$ ，方便表示 </p><p>推出转移方程为：</p><p>$dp[i]=dp[j]+(a[i]-b[j])^2$</p><p>然后变成点斜式：</p><p>$dp[i]-a[i]^2=2a[i]\times b[j]+dp[j]+b[j]^2$</p><p>用一次函数的方式表示：</p><p>$x=b[j]$</p><p>$y=dp[j]+b[j]^2$</p><p>$k=2a[i]$</p><p>$b=dp[i]-a[i]^2$</p><p>完成。</p><p>然后用经典的斜率优化单调推进解出即可。</p><p><strong>注：在斜率优化里，一般为了避免除法导致的运行时错误，所以将除法提出变成乘法，但在这一次里，我还是写的除法，算是斜率优化的另一种写法。</strong></p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">5e4</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,head=<span class="number">1</span>,tail=<span class="number">1</span>,q[MAXN];</span><br><span class="line">ll L;</span><br><span class="line">db len[MAXN],dp[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">calcA</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> len[x]+x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">calcB</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">calcA</span>(x)+L+<span class="number">1</span>;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">calcX</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">calcB</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">calcY</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dp[x]+<span class="built_in">calcB</span>(x)*<span class="built_in">calcB</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">slope</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">calcY</span>(a)-<span class="built_in">calcY</span>(b))/(<span class="built_in">calcX</span>(a)-<span class="built_in">calcX</span>(b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-convex-hull-opt.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-convex-hull-opt.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,L);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;len[i]),len[i]+=len[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;<span class="built_in">slope</span>(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*<span class="built_in">calcA</span>(i)) ++head;</span><br><span class="line">        <span class="type">int</span> j=q[head];</span><br><span class="line">        dp[i]=dp[j]+(<span class="built_in">calcA</span>(i)-<span class="built_in">calcB</span>(j))*(<span class="built_in">calcA</span>(i)-<span class="built_in">calcB</span>(j));</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;<span class="built_in">slope</span>(i,q[tail<span class="number">-1</span>])&lt;<span class="built_in">slope</span>(q[tail<span class="number">-1</span>],q[tail])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,(ll)dp[N]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">xj=lenj+j</span></span><br><span class="line"><span class="comment">yj=dpj+(lenj+j)^2</span></span><br><span class="line"><span class="comment">ki=-2(L+1-(lenj+j))</span></span><br><span class="line"><span class="comment">bi=dpi-(leni+i-(L+1))^2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>依我看来，斜率优化算是 $\mathcal{dp}$ 一栏里最难的部分了。省选+会涉及，所以根据 <code>wanhui</code> 给我定的目标，我还是不得不学。</p><font style="color:white">说实话，依我而看，我的实力远远不够，后路很长，如果一起前进最后的结果终究是四分五裂。所以，也许，是时候，做出取舍。但即使如此，我也必须努力才行啊。</font><p>$\mathcal{finished\ at\ 2022.5.14}$</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 优化 </tag>
            
            <tag> 数论 </tag>
            
            <tag> 几何 </tag>
            
            <tag> 斜率优化 </tag>
            
            <tag> 凸包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>恒永末世，决铭永生，终末之诗</title>
      <link href="/Eternity/%E5%9B%9E%E5%93%8D%E5%9C%B0%E5%9F%9F%E7%9A%84%E8%B5%9E%E7%BE%8E%E8%AF%97/%E5%A4%9A%E5%85%83%E5%AE%87%E5%AE%99%E7%9A%84%E4%BA%A4%E7%BB%87%E4%B8%8E%E7%A2%B0%E6%92%9E/Eternaltale/"/>
      <url>/Eternity/%E5%9B%9E%E5%93%8D%E5%9C%B0%E5%9F%9F%E7%9A%84%E8%B5%9E%E7%BE%8E%E8%AF%97/%E5%A4%9A%E5%85%83%E5%AE%87%E5%AE%99%E7%9A%84%E4%BA%A4%E7%BB%87%E4%B8%8E%E7%A2%B0%E6%92%9E/Eternaltale/</url>
      
        <content type="html"><![CDATA[<p>“Nothing is <font style="color:darkviolet">Eternal</font> but <font style="color:red">love</font>“</p><span id="more"></span><hr><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>现阶段作者：我，即落幕の残影</p><p>现阶段更新平台：Bilibili，网易云音乐。</p><p>现阶段更新方式：OST，小说。</p><p>整个AU共分为五个阶段：</p><blockquote><p>Eternalverse 终末之诗 亘古篇之一</p><p>Eternaltale: Soul Save 恒永末世：魂萦之赎 亘古篇之二</p><p>Eternaltale: Void Origin 恒永末世：源启虚空 过去篇</p><p>Eternaltale: Ashes Finale 恒永末世：烬灭终焉 现在篇</p><p>Eternalrune 决铭永生 未来篇</p></blockquote><h2 id="背景故事"><a href="#背景故事" class="headerlink" title="背景故事"></a>背景故事</h2><h3 id="亘古篇-Before-End"><a href="#亘古篇-Before-End" class="headerlink" title="亘古篇(Before End)"></a>亘古篇(Before End)</h3><p>如果说，一条时间线的崩坏，就如蝴蝶扑翅一般，卷起了另一个世界的万丈波澜。就像是宇宙大爆炸之后的另一次爆炸，会将整个世界<strong>重置</strong>。</p><p>然后……</p><p>$\color{yellow}{\mathfrak{RESET}}$</p><p>然后……</p><p>$\color{darkviolet}{\mathfrak{OVERWRITE}}$</p><p>然后……</p><hr><p>这是发生在X-tale和Underverse之前的故事。</p><p>涂鸦球领域的某一个角落，某一条名为Dusttale的时间线的分支。这是一个不受控制的世界。屠杀与屠杀，不知已经经过了多少次。而这条时间线的Chara早已无所不能。</p><h3 id="过去与未来-Under-Choice"><a href="#过去与未来-Under-Choice" class="headerlink" title="过去与未来(Under Choice)"></a>过去与未来(Under Choice)</h3><h3 id="之后的传说-After-Tale"><a href="#之后的传说-After-Tale" class="headerlink" title="之后的传说(After Tale)"></a>之后的传说(After Tale)</h3>]]></content>
      
      
      <categories>
          
          <category> 回响地域的赞美诗 </category>
          
          <category> 多元宇宙的交织与碰撞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UndertaleAU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《重启人生》——无法被修正的过去，和我们再一次的未来</title>
      <link href="/Eternity/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/starting-over/"/>
      <url>/Eternity/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/starting-over/</url>
      
        <content type="html"><![CDATA[<p>作者：（日本）三秋缒</p><p>作品名：《重启人生Starting Over》</p><span id="more"></span><p>在中考之前读完了这本书，似乎不是一个正确的时间，但总而言之，得到了心灵的洗礼。</p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>《重启人生》是作家三秋缒的处女作，但他已经非常尽力的在完善这本书了。</p><blockquote><p>这是，<br>迎接二十岁生日的我，<br>重新回到十岁，<br>又再次走向二十岁的故事。</p></blockquote><p>如果有机会去重新做一件自己认为是成功了的事，我想，凭借着记忆，不会把其做得更好，反而会导致意想不到的结果吧。毕竟，运气和时运都存在在那里。老天爷是不会眷顾同一个人两次的，如果老天爷真的存在。</p><hr><p><strong>警告，以下内容涉嫌剧透，如果没有读过原著，请酌情阅读！！！</strong></p><hr><p>这本书确实注重第一观感，就和Undertale一样。</p><h2 id="一些感悟"><a href="#一些感悟" class="headerlink" title="一些感悟"></a>一些感悟</h2><p>人会改变，也能改变，必须改变。幸福，不是按照程序等来的，而是要自己去发现，去寻找，去努力。</p><p>这可能就是“我”在第二人生失败的原因吧。我一直坚信，仅仅去靠经验之谈生活，这个人是不可能存在好结果的。经验这种东西，并不是指引你走向未来，而是教会你如何使用过去。</p><p>说实话，这本轻小说的结局我是没有猜到的，能说是Happy Ending吗？或许是，又或许不能算是，两个支离破碎的人在末日尽头拥抱了对方，以寻求片刻的完整，对于失望与绝望而言，这也许也能使一个较好的结果吧。</p><p>我不太喜欢第一人称的小说，因为其巨大的代入感，最终又会在我看完整本书的时候让我产生巨大的落差感。<strong>因为，我与“我”之间存在了太大的差异了。</strong>而《重启人生》，这种失败的感觉我倒是深有体会吧。<strong>作为一个没有第一人生的第二人生的我，真的是太有体会了。</strong>在生活一步一步的逼迫之下，选择成为了圣诞节的坏大人。<font style="color:white">也许就是我的宿命，以梦想为借口，逃避生活。</font></p><p>说句实话，对于我个人而言，我认为我能算是半个完美的人。即使不是成绩最好，即使依然有人讨厌，即使家里存在纠葛，即使……但如果不对生活进行抱怨的话，我想，即使是流浪的人也会感到幸福，就像文中的臼水一般，唯一放在心上的，便是今天的天气。</p><p>可能很多人在最后会觉得这本书有些悲观。是真的，但对于我而言刚好合适，我是一个在内心消极与黑暗中挣扎的人，也正因如此，我才会喜欢这本书。</p><p>很多时候我们不懂得去珍惜身边的人和事，直到自己失去了的时候才去后悔。活着有时候要长远计划也要享受当下。而不能一味地去羡慕别人。我们又何尝不是，找着虚假的理由欺骗自己，我只想对自己说要面对现实，没有人愿意看着这么废物的自己，那就去改变而不是去逃避。<font style="color:white">虽然，有些时候，逃避是最好的选择，麻痹自己，也是一种生存的手段。将生活的苟且看作是诗和远方，或许自责也会少几分吧。</font></p><p>又或许，如果我能够有这所谓的第二人生，也许我会想着去改变什么。因为现在想起来，也许以前的很多年都是在徘徊中前进的。我的生活或许是完美的，但我并不是完美的。如果能给我再一次机会，也许我能够对她道歉，也许我能和他道别，也许……</p><blockquote><p>这个世界上没有如果。</p></blockquote><p>这便是答案。</p><p>或许，正因为有遗憾存在，才有去追寻未来的理由吧。</p><h2 id="名句"><a href="#名句" class="headerlink" title="名句"></a>名句</h2><blockquote><p>所谓的人生啊，哪怕只是出现蝴蝶扑翅般微小的差异，也会发生极大的变化。</p><p>正确的答案不一定是真实的答案。就算是一场误会，只要持续十年，对本人来说，那就已经是不想修正的现实了。</p><p>我讨厌看到现在进行时的幸福，却喜欢品尝幸福的余韵，那种味道淡淡的，让人觉得或许这里曾有过幸福。</p><p>至少比起想象未来如何活着，考虑死亡的事要顺利得多。</p><p>可那个人应该也是以第一名为目标，最后才能跑出第三名的成绩。假设他从一开始就以第三名为目标，最后一定是拿到第七名或第九名吧。</p><p>若是过着五十分的生活，人就会连小事都放在心上，希望生活变成五十一分；若是过着负五十分的生活，再怎么努力变成负四十九分也没有意义。</p><p>成为一个对自己人生丝毫没有后悔的人。这样的人大概非常幸福吧？要不然，就是一个超级大笨蛋；不是过着没有任何地方需要反省的完美人生，就是连反省自己人生的脑袋都没有。</p><p>因为微小的差异，人会改变，也能改变。</p><p>只要丢掉“因为一直以来都是这样，以后也会一样的吧”这样的想法就好。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 阅读笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 轻小说 </tag>
            
            <tag> 三秋缒 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>凛冬将至</title>
      <link href="/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E5%9B%9B%E5%AD%A3%E4%B9%8B%E6%AD%8C/2022-winter/"/>
      <url>/Eternity/%E7%9F%AD%E7%AF%87%E5%B0%8F%E8%AF%B4/%E5%9B%9B%E5%AD%A3%E4%B9%8B%E6%AD%8C/2022-winter/</url>
      
        <content type="html"><![CDATA[<p>四季之歌 其四 冬之篇</p><p>萦绕着北极光的极寒雪山，是否又是旅途的终点？</p><span id="more"></span>]]></content>
      
      
      <categories>
          
          <category> 短篇小说 </category>
          
          <category> 四季之歌 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>D.C</title>
      <link href="/Eternity/Until-The-End/my-primary-school-from-4-to-6/"/>
      <url>/Eternity/Until-The-End/my-primary-school-from-4-to-6/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="fc3f31f9801f98c62d6a5fc06b627205f0bfd65cb8130eaec82127d401dd22f5">956fa686beba65e04596fd799f3775e672369116bcd6125d89206d7efafc653e3e61174e1404890bd808bd01608a024aa35abd9f52aba4bc4e267524d1019a8f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">密码：我的小学班主任名字小写缩写</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/Eternity/lib/hbe.js"></script><link href="/Eternity/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Until The End </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>随机100题(17/100)</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/100-text/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/100-text/</url>
      
        <content type="html"><![CDATA[<p>“作为这一年的奋斗目标，难度：提高左右”</p><span id="more"></span><h3 id="1-P4170-CQOI2007-涂色"><a href="#1-P4170-CQOI2007-涂色" class="headerlink" title="1.P4170 [CQOI2007]涂色"></a>1.<a href="https://www.luogu.com.cn/problem/P4170">P4170 [CQOI2007]涂色</a></h3><p>$date: 2022.4.10$</p><p>区间 $dp$ 模板题，转移方程有三种：</p><ol><li>$dp_{l,r}=1,l=r$</li><li>$dp_{l,r}=\min\{dp_{l+1,r},dp_{l,r-1}\},op_l=op_r$</li><li>$dp_{l,r}=\min\{dp_{l,r},dp_{l,k}+dp_{k+1,r}\},op_l \neq op_r,k \in [l,r]$</li></ol><p>第一种，涂一块只需要一次即可；</p><p>而对于第二种，我们在涂的时候只需要再其子区间的时候多涂一块，不需要再涂一次，所以不用统计答案；</p><p>第三种，经典断点即可。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">51</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dp[MAXN][MAXN],n,op[MAXN];</span><br><span class="line"><span class="type">char</span> str[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">change</span><span class="params">(<span class="type">char</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s-<span class="string">&#x27;A&#x27;</span>+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-section.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-section.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str+<span class="number">1</span>);</span><br><span class="line">    n=<span class="built_in">strlen</span>(str+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) op[i]=<span class="built_in">change</span>(str[i]);</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> len=<span class="number">1</span>;len&lt;=n;++len)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>;l&lt;=n-len+<span class="number">1</span>;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> r=l+len<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span>(l==r) dp[l][r]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(op[l]==op[r])</span><br><span class="line">                dp[l][r]=<span class="built_in">min</span>(dp[l+<span class="number">1</span>][r],dp[l][r<span class="number">-1</span>]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;r;++k)</span><br><span class="line">                    dp[l][r]=<span class="built_in">min</span>(dp[l][r],dp[l][k]+dp[k+<span class="number">1</span>][r]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,dp[<span class="number">1</span>][n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">AAAAA</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="2-CF1109A-Sasha-and-a-Bit-of-Relax"><a href="#2-CF1109A-Sasha-and-a-Bit-of-Relax" class="headerlink" title="2.CF1109A Sasha and a Bit of Relax"></a>2.<a href="https://www.luogu.com.cn/problem/CF1109A">CF1109A Sasha and a Bit of Relax</a></h3><p>$date:2022.4.10$</p><p>区间数学题，详见<a href="https://www.luogu.com.cn/blog/FallenShadow/solution-cf1109a">题解</a></p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ls p&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rs ls|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">3e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll n,val,sum[MAXN];</span><br><span class="line">ll res;</span><br><span class="line">map&lt;pair&lt;ll,ll&gt;,ll&gt;M;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;segment.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;segment.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    ++M[<span class="built_in">make_pair</span>(<span class="number">0</span>,<span class="number">1</span>)];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(val);</span><br><span class="line">        sum[i]=sum[i<span class="number">-1</span>]^val;</span><br><span class="line">        ll x=!(i&amp;<span class="number">1</span>);</span><br><span class="line">        res+=M[<span class="built_in">make_pair</span>(sum[i],x)];</span><br><span class="line">        ++M[<span class="built_in">make_pair</span>(sum[i],x)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1 2 3 4 5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">3 2 2 3 7 6</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">x^x=0</span></span><br><span class="line"><span class="comment">x^0=x</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="3-P8179-「EZEC-11」Tyres"><a href="#3-P8179-「EZEC-11」Tyres" class="headerlink" title="3.P8179 「EZEC-11」Tyres"></a><a href="https://www.luogu.com.cn/problem/P8179">3.P8179 「EZEC-11」Tyres</a></h3><p>$date:2022.04.16$</p><p>虽然不是随机跳的，但是还是记上吧。调了大半天的。最后发现 $INF$ 开小了。题解的话看出题人就可以了，这里不多说。（<del>主要是讲不明白</del>）。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">2e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> ll MAXB=<span class="number">25</span>;</span><br><span class="line"><span class="type">const</span> ll INF=<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll n,m;</span><br><span class="line">ll t,dp[MAXN][MAXB+<span class="number">8</span>],g[MAXM],hgt[MAXM];</span><br><span class="line">ll a[MAXN],b[MAXN],c[MAXN],s;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Compare</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> ll&amp;x,<span class="type">const</span> ll&amp;y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (a[x]+b[x]*c[x]*c[x]&gt;a[y]+b[y]*c[y]*c[y])||</span><br><span class="line">            (a[x]+b[x]*c[x]*c[x]==a[y]+b[y]*c[y]*c[y]&amp;&amp;x&gt;y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;ll,vector&lt;ll&gt;,Compare&gt;Q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;t3.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;t3.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m),<span class="built_in">read</span>(t),s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(a[i]),<span class="built_in">read</span>(b[i]),c[i]=MAXB,Q.<span class="built_in">push</span>(i);</span><br><span class="line">        dp[i][<span class="number">1</span>]=a[i]+t;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">2</span>;j&lt;=MAXB;++j)</span><br><span class="line">            dp[i][j]=dp[i][j<span class="number">-1</span>]+a[i]+b[i]*(j<span class="number">-1</span>)*(j<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(g,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(g)),g[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        s=<span class="built_in">min</span>(m,s+MAXB);</span><br><span class="line">        <span class="keyword">for</span>(ll j=s;j&gt;=<span class="number">0</span>;--j)</span><br><span class="line">            <span class="keyword">for</span>(ll k=<span class="number">0</span>;k&lt;=MAXB&amp;&amp;k&lt;=j;++k)</span><br><span class="line">                g[j]=<span class="built_in">min</span>(g[j],g[j-k]+dp[i][k]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ll x=Q.<span class="built_in">top</span>();</span><br><span class="line">        Q.<span class="built_in">pop</span>();</span><br><span class="line">        hgt[i]=hgt[i<span class="number">-1</span>]+a[x]+b[x]*c[x]*c[x];</span><br><span class="line">        ++c[x],Q.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans=INF;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">0</span>;i&lt;=s&amp;&amp;i&lt;=m;++i) ans=<span class="built_in">min</span>(ans,g[i]+hgt[m-i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,ans-t);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 4 50</span></span><br><span class="line"><span class="comment">10 100</span></span><br><span class="line"><span class="comment">100 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="4-CF986A-Fair"><a href="#4-CF986A-Fair" class="headerlink" title="4.CF986A Fair"></a><a href="https://www.luogu.com.cn/problem/CF986A">4.CF986A Fair</a></h3><p>$date:2022.04.16$</p><p><del>看到最短路，我啪的一下就点进来了</del>。这道题类似于全源最短路，但是其点数和边数过大，所以考虑按颜色分配。用 $Dist[c][v]$ 表示到 $c$ 节点涂上 $v$ 颜色的最小代价，然后用 $O(n)$ 的 $bfs$ 跑即可，然后将所有颜色排序，在每个节点处取前 $s$ 个 $Dist_{c,v}$ 即可。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK=<span class="number">101</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m,k,s,cnt[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">&#125;Edge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN],Total,Dist[MAXN][MAXK];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[v],u&#125;;Head[v]=Total;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;Col[MAXK];</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;Q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;mininum-road.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;mininum-road.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m),<span class="built_in">read</span>(k),<span class="built_in">read</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">read</span>(cnt[i]),Col[cnt[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,u,v;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(u),<span class="built_in">read</span>(v);</span><br><span class="line">        <span class="built_in">addEdge</span>(u,v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(Dist,<span class="number">-1</span>,<span class="built_in">sizeof</span>(Dist));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> c=<span class="number">1</span>;c&lt;=k;++c)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:Col[c])</span><br><span class="line">        &#123;</span><br><span class="line">            Q.<span class="built_in">push</span>(i);</span><br><span class="line">            Dist[i][c]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> u=Q.<span class="built_in">front</span>();Q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> e=Head[u],v;e;e=Edge[e].next)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(Dist[(v=Edge[e].to)][c]==<span class="number">-1</span>)</span><br><span class="line">                    Dist[v][c]=Dist[u][c]+<span class="number">1</span>,Q.<span class="built_in">push</span>(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(Dist[i]+<span class="number">1</span>,Dist[i]+<span class="number">1</span>+k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=s;++j) ans+=Dist[i][j];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5 4 3</span></span><br><span class="line"><span class="comment">1 2 4 3 2</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">4 1</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="5-P5810-SCOI2004-文本的输入"><a href="#5-P5810-SCOI2004-文本的输入" class="headerlink" title="5.P5810 [SCOI2004]文本的输入"></a>5.<a href="https://www.luogu.com.cn/problem/P5810">P5810 [SCOI2004]文本的输入</a></h3><p>$date:2022.4.19$</p><p>并不是随机跳的，无意中刷了一道四川省选题。</p><p>一道数学类型的 $dp$ 题。定义 <code>dp[i]</code> 为代价为 $i$ 时的最大字符数，对于添加字符，则 <code>dp[i]=dp[i-1]+1</code> 。而对于复制则遍历 $i-k,k=2j+5,j \in \mathbb{N^*}$ ，然后转移 $dp_i=\max^{k=2j+5 \leq i}_{u=1}(u+1)dp_{i-k}$ 即可。可以证明 <code>dp[i]</code> 单调。二分查找即可。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">4e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">ll T,dp[MAXN],ans;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;o(1).in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;o(1).out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(ans=<span class="number">1</span>;dp[ans<span class="number">-1</span>]&lt;T;++ans)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[ans]=dp[ans<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll i=ans<span class="number">-7</span>,j=<span class="number">2</span>;i&gt;=<span class="number">1</span>;i-=<span class="number">2</span>,++j)</span><br><span class="line">            dp[ans]=<span class="built_in">max</span>(dp[ans],dp[i]*j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,ans<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">20</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="6-P1934-封印"><a href="#6-P1934-封印" class="headerlink" title="6.P1934 封印"></a>6.<a href="https://www.luogu.com.cn/problem/P1934">P1934 封印</a></h3><p>$date:2022.4.20$</p><p>较水的 $dp$ 题，转移方程：$dp_{i}=\min\{dp_{j}+(v_i+v_j)(\sum\limits^{i}_{k=j}v_k)\},v_i+v_j \leq t,j&lt;i$ 初始化 $dp_{i}=dp_{i-1}+n^2v_i$ ，注意开 <code>long long</code> ，要爆。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1001</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">ll val[MAXN],sum[MAXN],dp[MAXN],t;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(t);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">read</span>(val[i]),sum[i]=sum[i<span class="number">-1</span>]+val[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[i]=dp[i<span class="number">-1</span>]+n*n*val[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">-1</span>;j&gt;=<span class="number">1</span>;--j)</span><br><span class="line">            <span class="keyword">if</span>(val[i]+val[j]&lt;=t)</span><br><span class="line">                dp[i]=<span class="built_in">min</span>(dp[i],dp[j<span class="number">-1</span>]+(val[i]+val[j])*(sum[i]-sum[j<span class="number">-1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,dp[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6 10</span></span><br><span class="line"><span class="comment">8 5 7 9 3 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="7-P7224-RC-04-子集积"><a href="#7-P7224-RC-04-子集积" class="headerlink" title="7.P7224 [RC-04] 子集积"></a><a href="https://www.luogu.com.cn/problem/P7224">7.P7224 [RC-04] 子集积</a></h3><p>$date:2022.4.20$</p><p>好吧，刚开始我以为这是一道普普通通的背包，结果是我想错了。<del>果然还是太菜了</del>，看了题解之后才有了点思路，但是还是失败了。就算贺过去了。这里给出题解的思路。</p><p>一共有 $2^n$ 个子集，暴力加入每一个物品，然后算就完事了。但是这样的时间复杂度是 $O(nm)$ ，不太保险。所以将 $a_i$ 相同的统一处理。即转换为完全背包。令 $a_i=j(j&gt;1)$ 的 $i$ 有 $k$ 个，则对于 $j,j^2,j^3…j^k$ 的转移系数为 $(^k_q)$ 。如果 $a_i=1$ 则将答案乘以 $2^k$ 而不作转移，最后统一处理。</p><p>时间复杂度 $O(\sum\limits^{m}_{i=2}\sum\limits^{cnt_i}_{j=1}\lfloor\frac{m}{i^j}\rfloor)$ ，一个很离谱的式子。近似于 $O(m \ln m)$ 。</p><p>预处理阶乘以及逆元以及阶乘的逆元用来求组合数。然后就背包了。</p><p>尝试了一下封装写法。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> Mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a=a+b-(a+b&gt;=Mod?Mod:<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a=a-b+(a-b&lt;<span class="number">0</span>?Mod:<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pro</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1ll</span>*a*b%Mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> fac[MAXN],inv[MAXN],inv_fac[MAXN],n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>]=inv_fac[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    fac[<span class="number">1</span>]=inv[<span class="number">1</span>]=inv_fac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        fac[i]=Calc::<span class="built_in">pro</span>(fac[i<span class="number">-1</span>],i);</span><br><span class="line">        inv[i]=Calc::<span class="built_in">pro</span>(Mod-Mod/i,inv[Mod%i]);</span><br><span class="line">        inv_fac[i]=Calc::<span class="built_in">pro</span>(inv_fac[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;<span class="number">0</span>||m&lt;<span class="number">0</span>||n&lt;m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> Calc::<span class="built_in">pro</span>(fac[n],Calc::<span class="built_in">pro</span>(inv_fac[m],inv_fac[n-m]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m,val[MAXN],dp[MAXN],cnt[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-bag.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-bag.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">read</span>(val[i]),++cnt[val[i]];</span><br><span class="line">    <span class="type">int</span> Max=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;MAXN;++i) <span class="built_in">checkMax</span>(Max,cnt[i]);</span><br><span class="line">    <span class="built_in">init</span>(Max);</span><br><span class="line">    dp[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;MAXN;++i)</span><br><span class="line">        <span class="keyword">if</span>(cnt[i])</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=m/i;k&gt;=<span class="number">1</span>;--k)</span><br><span class="line">                <span class="keyword">if</span>(dp[k])</span><br><span class="line">                &#123;</span><br><span class="line">                    ll v=i;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt[i]&amp;&amp;v*k&lt;=m;++j,v*=i)</span><br><span class="line">                        Calc::<span class="built_in">add</span>(dp[v*k],Calc::<span class="built_in">pro</span>(<span class="built_in">C</span>(cnt[i],j),dp[k]));</span><br><span class="line">                &#125;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n-cnt[<span class="number">1</span>];++i) Calc::<span class="built_in">add</span>(ans,ans);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) Calc::<span class="built_in">sub</span>(ans,dp[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">1</span>];++i) Calc::<span class="built_in">add</span>(ans,ans);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,ans); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">20 123456</span></span><br><span class="line"><span class="comment">1 5 12 24 189893 233333 2 22 134 3284 28456 261 50 10 1 2 2 2 2 22</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="8-P7228-COCI2015-2016-3-MOLEKULE"><a href="#8-P7228-COCI2015-2016-3-MOLEKULE" class="headerlink" title="8.P7228 [COCI2015-2016#3] MOLEKULE"></a><a href="https://www.luogu.com.cn/problem/P7228">8.P7228 [COCI2015-2016#3] MOLEKULE</a></h3><p>$date:2022.4.20$</p><p>跑一遍 $dfs$ ，然后使其入度和出度相交为 $0$ 即可。毕竟这道题不需要让你输出价值。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Graph</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> Head[MAXN],Total,To[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="type">bool</span> f,vis[MAXN];</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> next,to;</span><br><span class="line">    &#125;Edge[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Edge[++Total]=(edge)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">        Edge[Total+MAXN]=(edge)&#123;Head[v],u&#125;;Head[v]=Total+MAXN;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(vis[u]) <span class="keyword">return</span> ;</span><br><span class="line">        vis[u]=<span class="number">1</span>,f^=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> e=Head[u],v;e;e=Edge[e].next)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(vis[(v=Edge[e].to)]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(e&gt;MAXN) To[e-MAXN]=f^<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> To[e]=f;</span><br><span class="line">            <span class="built_in">dfs</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">        f^=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">outPrint</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,To[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dfs.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dfs.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,u,v;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(u),<span class="built_in">read</span>(v);</span><br><span class="line">        Graph::<span class="built_in">addEdge</span>(u,v);</span><br><span class="line">    &#125;</span><br><span class="line">    Graph::<span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    Graph::<span class="built_in">outPrint</span>(N);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="9-P4763-CERC2014-Bricks"><a href="#9-P4763-CERC2014-Bricks" class="headerlink" title="9.P4763 [CERC2014]Bricks"></a>9.<a href="https://www.luogu.com.cn/problem/P4763">P4763 [CERC2014]Bricks</a></h3><p>$date:2022.4.20$</p><p>看到同机房巨佬 $Live$ 在切，然后想起以前在学校的 $OI$ 上做过，然后就过来 $experience^2$ 了。一道比较难思考的贪心题。思路也忘了，估计现在也不会打了。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,ans,T;</span><br><span class="line"><span class="type">int</span> val[MAXN],cnt[MAXN],t[MAXN];</span><br><span class="line"><span class="type">char</span> op[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">change</span><span class="params">(<span class="type">char</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (s==<span class="string">&#x27;B&#x27;</span>?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(N),ans=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(op,<span class="string">&#x27;\0&#x27;</span>,<span class="built_in">sizeof</span>(op));</span><br><span class="line">    <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    <span class="built_in">memset</span>(t,<span class="number">0</span>,<span class="built_in">sizeof</span>(t));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(val[i]);</span><br><span class="line">        cin&gt;&gt;op[i];</span><br><span class="line">        cnt[<span class="built_in">change</span>(op[i])]+=val[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;brick.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;brick.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">if</span>(!cnt[<span class="number">0</span>]||!cnt[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,cnt[<span class="number">0</span>]+cnt[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x=<span class="built_in">change</span>(op[i]),y=<span class="built_in">change</span>(op[i])^<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="number">1ll</span>*cnt[x]*t[y]%cnt[y]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> res=<span class="number">1ll</span>*cnt[x]*t[y]/cnt[y]-t[x];</span><br><span class="line">                <span class="keyword">if</span>(res&gt;=<span class="number">1</span>&amp;&amp;res&lt;=val[i]) ++ans;</span><br><span class="line">            &#125;</span><br><span class="line">            t[x]+=val[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 B</span></span><br><span class="line"><span class="comment">3 W</span></span><br><span class="line"><span class="comment">2 B</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">3 W</span></span><br><span class="line"><span class="comment">3 B</span></span><br><span class="line"><span class="comment">9 W</span></span><br><span class="line"><span class="comment">1 B</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">2 W</span></span><br><span class="line"><span class="comment">3 W</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="10-CF1562C-Rings"><a href="#10-CF1562C-Rings" class="headerlink" title="10.CF1562C Rings"></a>10.<a href="https://www.luogu.com.cn/problem/CF1562C">CF1562C Rings</a></h3><p>$date:2022.04.22$</p><p>暴力 $O(n^2)$ 查找，但显然是过不了的。所以我们来找数学规律。</p><p>由于 $0$ 是任何非 $0$ 整数的倍数，一个数本身也是自己的倍数，所以：</p><ul><li>如果该字符串中有大于等于 $\lfloor \frac{n}{2} \rfloor$ 的连续子串全为 $0$ ，那么另找一个长度大于 $\lfloor \frac{n}{2} \rfloor$ 的连续子串即可。</li><li>如果该字符串中有两个长度大于等于 $\lfloor \frac{n}{2} \rfloor$ 的连续子串，或者是有一个长度大于等于 $\frac{n}{2}$ 的连续子串且该字串前面一位或数位为 $0$，那么也是一组解。</li><li>如果一个字符串有一个长度大于等于 $\lfloor \frac{n}{2} \rfloor$ 的连续子串，它的后面一位或数位为 $0$，说明包括后面的 $0$ 的子串一定是该子串的 $2$ 倍，是一组解。</li><li>否则说明该字符串全为 $1$，符合上面的第二种情况。事实上，上面第一种情况也可以归到第二、三两种情况里。</li></ul><p>所以，无论什么情况，该题都是有解的，用 $O(n)$ 扫一遍即可。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T,n;</span><br><span class="line"><span class="type">char</span> str[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;rings.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;rings.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(n);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str+<span class="number">1</span>);</span><br><span class="line">        <span class="type">bool</span> flag=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;<span class="built_in">i</span>&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i]==<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                flag=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(i&gt;(n&gt;&gt;<span class="number">1</span>)) <span class="built_in">printf</span>(<span class="string">&quot;1 %d 1 %d\n&quot;</span>,i,i<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d %d\n&quot;</span>,i,n,i+<span class="number">1</span>,n);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!flag) <span class="built_in">printf</span>(<span class="string">&quot;1 %d 2 %d\n&quot;</span>,n<span class="number">-1</span>,n);</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">101111</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">111000111</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">10000000</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">11011</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">001111</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">101</span></span><br><span class="line"><span class="comment">30</span></span><br><span class="line"><span class="comment">100000000000000100000000000000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="11-P2620-虫洞"><a href="#11-P2620-虫洞" class="headerlink" title="11.P2620 虫洞"></a>11.<a href="https://www.luogu.com.cn/problem/P2620">P2620 虫洞</a></h3><p>$date:2022.4.22-2022.4.23$</p><p>一道说难不难，说简单不简单的题。</p><p>考点：离散化+建图+最短路</p><p>对于这个数轴而言，能够改变答案贡献的只有虫洞，而虫洞的范围 $P \leq 40$ ，所以考虑建图。首先离散化，对于虫洞的起点与终点，有一条单向边 $E(u,v)=0$ ，并构建一个起点 $0$ 和一个终点 $W$ ，一共 $2P+2$ 个节点，对于非 $E(u,v)=0$ 的边，我们用递归处理其边权。因为不能踩到虫洞起点，所以我们需要将起点存储（推荐 <code>set</code> 和 <code>map</code> ），然后避开即可。</p><p>然后跑最短路就可以了。用 $Floyd$ 还是 $SPFA$ 或是 $Dijkstra$ 都是可以的，常数极小。</p><p>挖坑：一开始使用 <code>vector</code> 来离散，然后就爆了很久，后来换成数组就好了。所以 $Stl$ 能不用尽量不用。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXP=<span class="number">41</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x3fffffff</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> W,S,P,lenP;</span><br><span class="line"><span class="type">int</span> sat[MAXP],fnl[MAXP];</span><br><span class="line"><span class="type">bool</span> path[MAXP][MAXP];</span><br><span class="line"><span class="type">int</span> Dir[MAXP&lt;&lt;<span class="number">4</span>];</span><br><span class="line">std::set&lt;<span class="type">int</span>&gt;St;</span><br><span class="line"><span class="keyword">namespace</span> Floyd</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> Dist[MAXP&lt;&lt;<span class="number">2</span>][MAXP&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">initForEveryTest</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(Dist,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(Dist));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calcEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(u==v) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(St.<span class="built_in">count</span>(u)) <span class="keyword">return</span> INF;</span><br><span class="line">        <span class="type">int</span> k=v;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=P;++i)</span><br><span class="line">            <span class="keyword">if</span>(u&lt;sat[i]&amp;&amp;sat[i]&lt;k&amp;&amp;(sat[i]-u)%S==<span class="number">0</span>) k=sat[i];</span><br><span class="line">        <span class="keyword">while</span>(k!=v&amp;&amp;St.<span class="built_in">count</span>(k)) --k;</span><br><span class="line">        <span class="keyword">if</span>(k==u) <span class="keyword">return</span> INF;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">calcEdge</span>(k,v)+(k-u+S<span class="number">-1</span>)/S;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;lenP;++i)</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> j=i+<span class="number">1</span>;j&lt;=lenP;++j)</span><br><span class="line">                Dist[i][j]=<span class="built_in">min</span>(Dist[i][j],<span class="built_in">calcEdge</span>(Dir[i],Dir[j]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">calc</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> k=<span class="number">1</span>;k&lt;=lenP;++k)</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=lenP;++i)</span><br><span class="line">                <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=lenP;++j)</span><br><span class="line">                    Dist[i][j]=<span class="built_in">min</span>(Dist[i][j],Dist[i][k]+Dist[k][j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">outPut</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Dist[<span class="number">1</span>][lenP]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Dist[u][v]=w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Floyd;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-graph.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-graph.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(W);</span><br><span class="line">    <span class="keyword">while</span>(W)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(S,P);</span><br><span class="line">        St.<span class="built_in">clear</span>(),lenP=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(Dir,<span class="number">0</span>,<span class="built_in">sizeof</span>(Dir));</span><br><span class="line">        Floyd::<span class="built_in">initForEveryTest</span>();</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=P;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(sat[i],fnl[i]);</span><br><span class="line">            Dir[++lenP]=sat[i],Dir[++lenP]=fnl[i];</span><br><span class="line">            St.<span class="built_in">insert</span>(sat[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        Dir[++lenP]=<span class="number">0</span>,Dir[++lenP]=W;</span><br><span class="line">        <span class="built_in">sort</span>(Dir+<span class="number">1</span>,Dir+<span class="number">1</span>+lenP);</span><br><span class="line">        lenP=<span class="built_in">unique</span>(Dir+<span class="number">1</span>,Dir+<span class="number">1</span>+lenP)-Dir<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=P;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> d1=<span class="built_in">lower_bound</span>(Dir+<span class="number">1</span>,Dir+<span class="number">1</span>+lenP,sat[i])-Dir;</span><br><span class="line">            <span class="type">int</span> d2=<span class="built_in">lower_bound</span>(Dir+<span class="number">1</span>,Dir+<span class="number">1</span>+lenP,fnl[i])-Dir;</span><br><span class="line">            Floyd::<span class="built_in">addEdge</span>(d1,d2,<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Floyd::<span class="built_in">init</span>();</span><br><span class="line">        Floyd::<span class="built_in">calc</span>();</span><br><span class="line">        Floyd::<span class="built_in">outPut</span>();</span><br><span class="line">        <span class="built_in">read</span>(W);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">28 3 5</span></span><br><span class="line"><span class="comment">2 18</span></span><br><span class="line"><span class="comment">5 13</span></span><br><span class="line"><span class="comment">12 6</span></span><br><span class="line"><span class="comment">17 25</span></span><br><span class="line"><span class="comment">20 15</span></span><br><span class="line"><span class="comment">50 6 1</span></span><br><span class="line"><span class="comment">9 45</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="12-P1879-USACO06NOV-Corn-Fields-G"><a href="#12-P1879-USACO06NOV-Corn-Fields-G" class="headerlink" title="12.P1879 [USACO06NOV]Corn Fields G"></a>12.<a href="https://www.luogu.com.cn/problem/P1879">P1879 [USACO06NOV]Corn Fields G</a></h3><p>$date:2022.04.24$</p><p>经典状压模板题，没啥好讲的。只是因为括号打错位调了很久。<del>太菜了</del>。</p><p>今天省选名单出了，在线膜拜省队爷wfy。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">13</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">13</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXP=<span class="number">1</span>&lt;&lt;<span class="number">14</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> Mod=<span class="number">1e8</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M;</span><br><span class="line"><span class="type">int</span> Map[MAXN][MAXM],state[MAXP];</span><br><span class="line"><span class="type">int</span> dp[MAXN][MAXP],ok[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-compression.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-compression.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j)</span><br><span class="line">            <span class="built_in">read</span>(Map[i][j]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j)</span><br><span class="line">            ok[i]=(ok[i]&lt;&lt;<span class="number">1</span>)+Map[i][j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>;s&lt;(<span class="number">1</span>&lt;&lt;M);++s)</span><br><span class="line">        state[s]=((s&amp;(s&gt;&gt;<span class="number">1</span>))==<span class="number">0</span>)&amp;&amp;((s&amp;(s&lt;&lt;<span class="number">1</span>))==<span class="number">0</span>);</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>;s&lt;(<span class="number">1</span>&lt;&lt;M);++s)</span><br><span class="line">            <span class="keyword">if</span>(state[s]&amp;&amp;((s&amp;ok[i])==s))</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> sl=<span class="number">0</span>;sl&lt;(<span class="number">1</span>&lt;&lt;M);++sl)</span><br><span class="line">                    <span class="keyword">if</span>((s&amp;sl)==<span class="number">0</span>)</span><br><span class="line">                        dp[i][s]=(dp[i][s]+dp[i<span class="number">-1</span>][sl])%Mod;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>;s&lt;(<span class="number">1</span>&lt;&lt;M);++s)</span><br><span class="line">        res=(res+dp[N][s])%Mod;</span><br><span class="line">    <span class="comment">/*for(int i=1;i&lt;=N;++i)&#123;</span></span><br><span class="line"><span class="comment">        for(int s=0;s&lt;(1&lt;&lt;M);++s)</span></span><br><span class="line"><span class="comment">            printf(&quot;%d &quot;,dp[i][s]);</span></span><br><span class="line"><span class="comment">        printf(&quot;%d &quot;,ok[i]);</span></span><br><span class="line"><span class="comment">        puts(&quot;&quot;);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    for(int s=0;s&lt;(1&lt;&lt;M);++s) printf(&quot;%d &quot;,state[s]);</span></span><br><span class="line"><span class="comment">    puts(&quot;&quot;);*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">0 1 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="13-CF803D-Magazine-Ad"><a href="#13-CF803D-Magazine-Ad" class="headerlink" title="13.CF803D Magazine Ad"></a>13.<a href="https://www.luogu.com.cn/problem/CF803D">CF803D Magazine Ad</a></h3><p>$date:2022.4.27$</p><p>较 $H_2O$ 的二分题，注意字符串的读入。详见<a href="https://www.luogu.com.cn/blog/FallenShadow/solution-cf803d">题解</a></p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> k,len,p;</span><br><span class="line"><span class="type">char</span> str[MAXS];</span><br><span class="line"><span class="type">int</span> val[MAXS],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>,cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(val[i]&gt;x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(res+val[i]&lt;=x) res+=val[i];</span><br><span class="line">        <span class="keyword">else</span> ++cnt,res=val[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// printf(&quot;%d %d\n&quot;,x,cnt);</span></span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">while</span>((str[++len]=<span class="built_in">gh</span>())!=<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    p=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=len;++i)</span><br><span class="line">        <span class="keyword">if</span>(str[i]==<span class="string">&#x27;-&#x27;</span>||str[i]==<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            val[++tot]=i-p+<span class="number">1</span>,p=i+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p!=len+<span class="number">1</span>) val[++tot]=len-p;</span><br><span class="line">    <span class="type">int</span> l=<span class="number">0</span>,r=len;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(mid)) r=mid;</span><br><span class="line">        <span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,l);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">garage for sa-le</span></span><br><span class="line"><span class="comment">7 4 3 2</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">Edu-ca-tion-al Ro-unds are so fun</span></span><br><span class="line"><span class="comment">4 3 5 3 3 5 4 3 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="14-P1471-方差"><a href="#14-P1471-方差" class="headerlink" title="14.P1471 方差"></a>14.<a href="https://www.luogu.com.cn/problem/P1471">P1471 方差</a></h3><p>$date:2022.4.28$</p><p><del>好久没有手切过蓝题了</del></p><p>区间维护题，较基础的线段树模板，结合了一点数学知识。</p><script type="math/tex; mode=display">\sum\limits^{r}_{i=l}(x_i+d)^2=\sum\limits^{r}_{i=l}(x_i)^2+2d\sum\limits_{i=l}^{r}x_i+(r-l+1)d^2</script><p>然后维护即可。记得在粘贴代码时改掉函数名。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M;</span><br><span class="line">db val[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Seg</span></span><br><span class="line">&#123;</span><br><span class="line">    db val,val2,tag;</span><br><span class="line">    <span class="type">int</span> l,r;</span><br><span class="line">    <span class="function">db <span class="title">sum</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1.0</span>*(r-l+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Tree[MAXN&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushUp</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p].val=Tree[p&lt;&lt;<span class="number">1</span>].val+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].val;</span><br><span class="line">    Tree[p].val2=Tree[p&lt;&lt;<span class="number">1</span>].val2+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].val2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushDown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Tree[p].tag)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>].val2+=(Tree[p&lt;&lt;<span class="number">1</span>].val*Tree[p].tag)*<span class="number">2</span>+Tree[p&lt;&lt;<span class="number">1</span>].<span class="built_in">sum</span>()*Tree[p].tag*Tree[p].tag;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].val2+=(Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].val*Tree[p].tag)*<span class="number">2</span>+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].<span class="built_in">sum</span>()*Tree[p].tag*Tree[p].tag;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>].val+=Tree[p&lt;&lt;<span class="number">1</span>].<span class="built_in">sum</span>()*Tree[p].tag;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].val+=Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].<span class="built_in">sum</span>()*Tree[p].tag;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>].tag+=Tree[p].tag,Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].tag+=Tree[p].tag;</span><br><span class="line">        Tree[p].tag=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p].l=l,Tree[p].r=r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p].val=val[l];</span><br><span class="line">        Tree[p].val2=val[l]*val[r];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>,l,mid),<span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="built_in">pushUp</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,db d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=Tree[p].l&amp;&amp;Tree[p].r&lt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p].val2+=(Tree[p].val*d)*<span class="number">2</span>+Tree[p].<span class="built_in">sum</span>()*d*d;</span><br><span class="line">        Tree[p].val+=Tree[p].<span class="built_in">sum</span>()*d;</span><br><span class="line">        Tree[p].tag+=d;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushDown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid=(Tree[p].l+Tree[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) <span class="built_in">modify</span>(p&lt;&lt;<span class="number">1</span>,l,r,d);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;r) <span class="built_in">modify</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,d);</span><br><span class="line">    <span class="built_in">pushUp</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">queryAverage</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=Tree[p].l&amp;&amp;Tree[p].r&lt;=r) <span class="keyword">return</span> Tree[p].val;</span><br><span class="line">    <span class="type">int</span> mid=(Tree[p].l+Tree[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    db val=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushDown</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) val+=<span class="built_in">queryAverage</span>(p&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;r) val+=<span class="built_in">queryAverage</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">queryVariance</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=Tree[p].l&amp;&amp;Tree[p].r&lt;=r) <span class="keyword">return</span> Tree[p].val2;</span><br><span class="line">    <span class="type">int</span> mid=(Tree[p].l+Tree[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    db val=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushDown</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) val+=<span class="built_in">queryVariance</span>(p&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;r) val+=<span class="built_in">queryVariance</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;segmentbit.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;segmentbit.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,M);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;val[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,N);</span><br><span class="line">    <span class="keyword">while</span>(M--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op,ql,qr;</span><br><span class="line">        <span class="built_in">read</span>(op,ql,qr);</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            db qk;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;qk);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>,ql,qr,qk);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\n&quot;</span>,<span class="built_in">queryAverage</span>(<span class="number">1</span>,ql,qr)/(qr-ql+<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            db x1=<span class="built_in">queryAverage</span>(<span class="number">1</span>,ql,qr),x2=<span class="built_in">queryVariance</span>(<span class="number">1</span>,ql,qr);</span><br><span class="line">            db res=x2+(qr-ql+<span class="number">1</span>)*(x1/(qr-ql+<span class="number">1</span>))*(x1/(qr-ql+<span class="number">1</span>))<span class="number">-2</span>*(x1/(qr-ql+<span class="number">1</span>))*x1;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\n&quot;</span>,res/(qr-ql+<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5</span></span><br><span class="line"><span class="comment">1 5 4 2 3</span></span><br><span class="line"><span class="comment">2 1 4</span></span><br><span class="line"><span class="comment">3 1 5</span></span><br><span class="line"><span class="comment">1 1 1 1</span></span><br><span class="line"><span class="comment">1 2 2 -1</span></span><br><span class="line"><span class="comment">3 1 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="15-P4162-SCOI2009-最长距离"><a href="#15-P4162-SCOI2009-最长距离" class="headerlink" title="15.P4162 [SCOI2009]最长距离"></a>15.<a href="https://www.luogu.com.cn/problem/P4162">P4162 [SCOI2009]最长距离</a></h3><p>$date:2022.05.06$</p><p>建图，将 $nm$ 的矩阵转化为一个有 $nm$ 个点的图，$c(i,j)=(map[j]=1)?1:0$ 即可，然后每到一个点记录一次答案记为 $res=\max\{res,calc(s,k)\}$ 。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">31</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> dx[]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> dy[]=&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="type">int</span> N,M,T;</span><br><span class="line"><span class="type">char</span> Map[MAXN][MAXN];</span><br><span class="line"><span class="type">int</span> Start[MAXN*MAXN];</span><br><span class="line">db Dist[MAXN*MAXN][MAXN*MAXN],res;</span><br><span class="line"><span class="type">char</span> ch;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getId</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (i<span class="number">-1</span>)*M+j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">calc</span><span class="params">(db x,db y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to,val;</span><br><span class="line">&#125;Edge[MAXN*MAXN*MAXN*MAXN&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN*MAXN],Total;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[u],v,w&#125;;Head[u]=Total;</span><br><span class="line">    <span class="comment">// Edge[++Total]=(edge)&#123;Head[v],u,w&#125;;Head[v]=Total;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> Dir[MAXN*MAXN];</span><br><span class="line"><span class="type">bool</span> Vis[MAXN*MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N*M;++i) Dir[i]=INF,Vis[i]=<span class="number">0</span>;</span><br><span class="line">    Dir[s]=Start[s],Vis[s]=<span class="number">1</span>;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;Q;</span><br><span class="line">    Q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="comment">// printf(&quot;start from %d with %d\n&quot;,s,Dir[s]);</span></span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u=Q.<span class="built_in">front</span>();Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">checkMax</span>(res,Dist[s][u]);</span><br><span class="line">        Vis[u]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> e=Head[u],v;e;e=Edge[e].next)</span><br><span class="line">        &#123;</span><br><span class="line">            v=Edge[e].to;</span><br><span class="line">            <span class="comment">// printf(&quot;road from %d to %d\n&quot;,u,v);</span></span><br><span class="line">            <span class="keyword">if</span>(Dir[v]&gt;Dir[u]+Edge[e].val)</span><br><span class="line">            &#123;</span><br><span class="line">                Dir[v]=Dir[u]+Edge[e].val;</span><br><span class="line">                <span class="comment">// printf(&quot;from %d to %d spend %d\n&quot;,u,v,Dir[v]);</span></span><br><span class="line">                <span class="keyword">if</span>(!Vis[v]&amp;&amp;T&gt;=Dir[v])</span><br><span class="line">                &#123;</span><br><span class="line">                    Vis[v]=<span class="number">1</span>;</span><br><span class="line">                    Q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;min-road.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;min-road.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,M,T);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,Map[i]+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=N;++j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=M;++k)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>;l&lt;=M;++l)</span><br><span class="line">                    Dist[<span class="built_in">getId</span>(i,k)][<span class="built_in">getId</span>(j,l)]=<span class="built_in">calc</span>(i-j,k-l);</span><br><span class="line">    <span class="comment">/*for(int i=1;i&lt;=N;++i)&#123;</span></span><br><span class="line"><span class="comment">        for(int j=1;j&lt;=M;++j)</span></span><br><span class="line"><span class="comment">            printf(&quot;%d &quot;,getId(i,j));</span></span><br><span class="line"><span class="comment">        puts(&quot;&quot;);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    return 0;*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            Start[<span class="built_in">getId</span>(i,j)]=Map[i][j]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>,w;k&lt;=<span class="number">4</span>;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> nx=i+dx[k],ny=j+dy[k];</span><br><span class="line">                <span class="keyword">if</span>(nx&lt;<span class="number">1</span>||nx&gt;N||ny&lt;<span class="number">1</span>||ny&gt;M) <span class="keyword">continue</span>;</span><br><span class="line">                w=Map[nx][ny]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                <span class="built_in">addEdge</span>(<span class="built_in">getId</span>(i,j),<span class="built_in">getId</span>(nx,ny),w);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N*M;++i) <span class="built_in">spfa</span>(i);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.6lf&quot;</span>,res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3 0</span></span><br><span class="line"><span class="comment">001</span></span><br><span class="line"><span class="comment">001</span></span><br><span class="line"><span class="comment">110</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="16-P6870-COCI2019-2020-5-Zapina"><a href="#16-P6870-COCI2019-2020-5-Zapina" class="headerlink" title="16.P6870 [COCI2019-2020#5] Zapina"></a>16.<a href="https://www.luogu.com.cn/problem/P6870">P6870 [COCI2019-2020#5] Zapina</a></h3><p>$date:2022.05.06$</p><p>数学dp ，组合数学题。</p><p>杨辉三角求组合数： $C(n,m)=C(n-1,m)+C(n-1,m-1)$</p><p>转移方程：</p><script type="math/tex; mode=display">dp[i][j]=\left\{\begin{aligned}&C(j,i)*(i-1)^{j-i},\text{使i开心} \\&\sum\limits^{k=j}_{k=0}dp[i-1][j-k]*C(j,k),k \in [0,j],k \neq i,\text{使i不开心}\\\end{aligned}\right.</script><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">351</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> Mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,dp[MAXN][MAXN],C[MAXN][MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">quickPow</span><span class="params">(ll a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res=res*a%Mod;</span><br><span class="line">        a=a*a%Mod;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        C[i][<span class="number">0</span>]=C[i][i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j<span class="number">-1</span>]+C[i<span class="number">-1</span>][j])%Mod;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="comment">/*for(int i=0;i&lt;=N;++i)&#123;</span></span><br><span class="line"><span class="comment">        for(int j=0;j&lt;=i;++j)</span></span><br><span class="line"><span class="comment">            printf(&quot;%d &quot;,C[i][j]);</span></span><br><span class="line"><span class="comment">        puts(&quot;&quot;);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=N;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j&gt;=i) dp[i][j]=<span class="number">1ll</span>*C[j][i]*<span class="built_in">quickPow</span>(i<span class="number">-1</span>,j-i)%Mod;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;=j;++k)</span><br><span class="line">                <span class="keyword">if</span>(i!=k) dp[i][j]=(dp[i][j]+<span class="number">1ll</span>*C[j][k]*dp[i<span class="number">-1</span>][j-k])%Mod;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,dp[N][N]%Mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">314</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="17-CF1119B-Alyona-and-a-Narrow-Fridge"><a href="#17-CF1119B-Alyona-and-a-Narrow-Fridge" class="headerlink" title="17.CF1119B Alyona and a Narrow Fridge"></a>17.<a href="https://www.luogu.com.cn/problem/CF1119B">CF1119B Alyona and a Narrow Fridge</a></h3><p>$date:2022.05.06$</p><p>很玄学的一道题，样例看不懂，题解不明白。</p><p>more and more vegetables, what should I do?</p><p>贺过去了，二分 $+$ 贪心。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e3</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> H,N,hgt[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;V;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a&gt;b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    V.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=x;++i) V.<span class="built_in">push_back</span>(hgt[i]);</span><br><span class="line">    <span class="built_in">sort</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>(),cmp);</span><br><span class="line">    <span class="type">int</span> maxn=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,pos1,pos2;i&lt;V.<span class="built_in">size</span>();++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((i+<span class="number">1</span>)&amp;<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            pos1=maxn+V[i];</span><br><span class="line">            <span class="keyword">if</span>(pos1&gt;H) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            pos2=maxn+V[i];</span><br><span class="line">            <span class="keyword">if</span>(pos2&gt;H) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            maxn=<span class="built_in">max</span>(pos1,pos2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp?.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp?.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,H);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">read</span>(hgt[i]);</span><br><span class="line">    <span class="type">int</span> l=<span class="number">1</span>,r=N+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(mid)) l=mid;</span><br><span class="line">        <span class="keyword">else</span> r=mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,l);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 7</span></span><br><span class="line"><span class="comment">2 3 5 4 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 区间dp </tag>
            
            <tag> 优化 </tag>
            
            <tag> RMQ </tag>
            
            <tag> 位运算 </tag>
            
            <tag> 数论 </tag>
            
            <tag> String </tag>
            
            <tag> 字符串 </tag>
            
            <tag> 数位dp </tag>
            
            <tag> 最短路 </tag>
            
            <tag> 图论 </tag>
            
            <tag> 搜索 </tag>
            
            <tag> 队列 </tag>
            
            <tag> bfs </tag>
            
            <tag> dfs </tag>
            
            <tag> 贪心 </tag>
            
            <tag> 平衡树 </tag>
            
            <tag> 枚举，暴力 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> SPFA </tag>
            
            <tag> 进制 </tag>
            
            <tag> Floyd </tag>
            
            <tag> 离散化 </tag>
            
            <tag> 状压dp </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> 二分 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 树状数组 </tag>
            
            <tag> 建图 </tag>
            
            <tag> 组合数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kmp字符串匹配算法</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/kmp/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/kmp/</url>
      
        <content type="html"><![CDATA[<p>“强大的并不是你在顺境中能多么快的前进，而是你能多快在逆流中找回你自己”</p><span id="more"></span><p>俗称 $KMP$ 算法，用法是在一个字符串 $A$ 中快速地找到一个子串 $B$ 的出现情况。是<strong>AC自动机</strong>的组成部分之一。</p><p>对于引言，你是否有想法呢？</p><p>对于一个字符串，如果当我们匹配失败，我们是否需要重新开始匹配，还是说，我们能够仅仅往前一点，然后从这一个位置再次比配。对于 $KMP$ 而言，我们有一个定义称为<strong>失配数组</strong>。是对于该点如果没有匹配成功而跳回的位置，一般记作 <code>nxt[]</code> 或者 <code>kmp[]</code> 。看个人喜好。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h3><p>我们需要遍历子串 $B$ 以记录失配数组的失配情况。如果该点无法匹配，则从该点以 <code>j=nxt[j]</code> 往前跳，直到可以再次匹配为止。然后以这样的顺序处理出失配数组。</p><h3 id="匹配"><a href="#匹配" class="headerlink" title="匹配"></a>匹配</h3><p>遍历字符串 $A$ ，定义一个指针记为 $j$ 表示当前已经匹配到了第 $j$ 位。如果 $a[i] \neq b[j]$ ，则往前失配，直到再次匹配为止，如果 <code>j=len(b)</code> ，则证明我们已经匹配到了一个完整的子串 $B$ 。之后的操作就根据题目而定了。</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="【模板】kmp"><a href="#【模板】kmp" class="headerlink" title="【模板】kmp"></a><a href="https://www.luogu.com.cn/problem/P3375">【模板】kmp</a></h3><p>按上述实现即可，可能不太清楚，所以接下来给出代码。</p><p>这是没有改码风之前的代码，凑合着看吧。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="type">char</span> stra[<span class="number">10000001</span>],strb[<span class="number">10000001</span>];</span><br><span class="line"><span class="type">int</span> Kmp[<span class="number">10000001</span>],N,M,j;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//freopen(&quot;.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="comment">//freopen(&quot;.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">cin&gt;&gt;(stra+<span class="number">1</span>)&gt;&gt;(strb+<span class="number">1</span>);</span><br><span class="line">    Kmp[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    N=<span class="built_in">strlen</span>(strb+<span class="number">1</span>);</span><br><span class="line">    M=<span class="built_in">strlen</span>(stra+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j&amp;&amp;strb[i]!=strb[j+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            j=Kmp[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(strb[i]==strb[j+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">        Kmp[i]=j;</span><br><span class="line">    &#125;</span><br><span class="line">    j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j&amp;&amp;strb[j+<span class="number">1</span>]!=stra[i])</span><br><span class="line">        &#123;</span><br><span class="line">            j=Kmp[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(stra[i]==strb[j+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j==N)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,i-N+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,Kmp[i]);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ABABABC</span></span><br><span class="line"><span class="comment">ABA</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="HNOI2008-GT考试"><a href="#HNOI2008-GT考试" class="headerlink" title="[HNOI2008]GT考试"></a><a href="https://www.luogu.com.cn/problem/P3193">[HNOI2008]GT考试</a></h3><p>一道比较难的 $kmp$ 题，因为 $kmp$ 的思路其实与 $dp$ 差不多，所以一般而言两者是连在一起考的。用 <code>f[i][j]</code> 表示对于 $i$ 位数匹配到 $j$ 位的答案数，似乎有点像数位dp。预处理出 <code>a[i][j]</code> 表示从 <code>f[x][i]</code> 转移到 <code>f[x+1][j]</code> 的可能数。</p><p>那么转移方程则是 $dp_{i,j}=\sum\limits^{m-1}_{k=0}dp_{i-1,k}*a_{k,j}$ 即可。则答案便是 $\sum\limits_{i=0}^{m-1}dp_{n,i}$ 。但这样的话，时间复杂度是 $O(nm^2)$ ，对于这道题而言只能得到 $40pt$ 。</p><p><a href="https://violeteternal.github.io/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/matrix/">前置芝士：矩阵快速幂</a></p><p>将 $dp_{i,j}$ 记作矩阵 $DP_{i}$ ，$DP_{i}$ 的第一层就是 $dp_{i,j}$ 转移方程变成了 $DP_{i}=DP_{i-1}*G$ 然后求 $DP_n$ 即可。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">21</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,K;</span><br><span class="line"><span class="type">int</span> f[MAXN][MAXN];        <span class="comment">//f(i,j)表示所有长度为i，且不包含M串</span></span><br><span class="line">                        <span class="comment">//且该串的末尾部分和S串当前匹配的最大长度为j</span></span><br><span class="line">                        <span class="comment">//的所有字符串的集合。</span></span><br><span class="line"><span class="type">char</span> str[MAXN];</span><br><span class="line"><span class="type">int</span> Kmp[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underExpr</span><span class="params">(<span class="type">int</span> c[][MAXN],<span class="type">int</span> a[][MAXN],<span class="type">int</span> b[][MAXN])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> t[MAXN][MAXN];</span><br><span class="line">    <span class="built_in">memset</span>(t,<span class="number">0</span>,<span class="built_in">sizeof</span>(t));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;M;++j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;M;++k)</span><br><span class="line">                t[i][j]=(t[i][j]+a[i][k]*b[k][j])%K;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;M;++j)</span><br><span class="line">            c[i][j]=t[i][j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQuickPow</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> f0[MAXN][MAXN]=&#123;<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>) <span class="built_in">underExpr</span>(f0,f0,f);</span><br><span class="line">        <span class="built_in">underExpr</span>(f,f,f);</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;++i) res=(res+f0[<span class="number">0</span>][i])%K;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;GTtest.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;GTtest.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M),<span class="built_in">underRead</span>(K);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j&amp;&amp;str[j+<span class="number">1</span>]!=str[i]) j=Kmp[j];</span><br><span class="line">        <span class="keyword">if</span>(str[j+<span class="number">1</span>]==str[i])++j;</span><br><span class="line">        Kmp[i]=j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//初始化f</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;M;++j)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> c=<span class="string">&#x27;0&#x27;</span>;c&lt;=<span class="string">&#x27;9&#x27;</span>;++c)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> k=j;</span><br><span class="line">            <span class="keyword">while</span>(k&amp;&amp;str[k+<span class="number">1</span>]!=c) k=Kmp[k];</span><br><span class="line">            <span class="keyword">if</span>(str[k+<span class="number">1</span>]==c) ++k;</span><br><span class="line">            <span class="keyword">if</span>(k&lt;M) ++f[j][k];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//f(n)=f(0)+A^N</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,<span class="built_in">underQuickPow</span>(N));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 3 100</span></span><br><span class="line"><span class="comment">111</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 优化 </tag>
            
            <tag> String </tag>
            
            <tag> 字符串 </tag>
            
            <tag> 搜索 </tag>
            
            <tag> KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>状态压缩dp</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-state-compression/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-state-compression/</url>
      
        <content type="html"><![CDATA[<p>“每天一遍，MLE再见”</p><span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>对于一类题而言，如果用 $dp$ 来做的话，会有 $m$ 个状态，而作为我们来讲，我们不可能去开一个数组 $dp[2][2][2][2][2][2][2]…[2]$ 来记录，因为空间是动态的。所以我们考虑将这 $m$ 个状态压缩成一个 $m$ 位的二进制数。存储为一位，则空间复杂度与时间复杂度都是 $O(2^m)$ 的话，枚举 $[0,2^m-1]$ ，而对于这个二进制数，它的第 $k$ 位为 $1$ 则满足第 $k$ 个条件，判断语句为 <code>if(i&gt;&gt;k&amp;1)</code> 即可。</p><p>这种题可实行的范围一般都不超过 $10 \sim 20$ ，所以很容易识别。</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="Acwing91-最短Hamilton路径"><a href="#Acwing91-最短Hamilton路径" class="headerlink" title="Acwing91.最短Hamilton路径"></a><a href="https://www.acwing.com/problem/content/93/">Acwing91.最短Hamilton路径</a></h3><p>最经典的状压题，我们用一个长度为 $n$ 的二进制数来存储，第 $k$ 位为 $0$ ，则表示第 $k$ 个点还没有到达；反之，则表示第 $k$ 个点已经到达。然后遍历即可，时间复杂度 $O(2^nn^2)$ 。</p><details>    <summary>查看代码</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS=<span class="number">1</span>&lt;&lt;<span class="number">21</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> val[MAXN][MAXN],dp[MAXS][MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-state-compression.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-state-compression.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;++j)</span><br><span class="line">            <span class="built_in">read</span>(val[i][j]);</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;++j)</span><br><span class="line">            <span class="keyword">if</span>(i&gt;&gt;j&amp;<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;n;++k)</span><br><span class="line">                    <span class="keyword">if</span>(i&gt;&gt;k&amp;<span class="number">1</span>)</span><br><span class="line">                        dp[i][j]=<span class="built_in">min</span>(dp[i][j],dp[i-(<span class="number">1</span>&lt;&lt;j)][k]+val[k][j]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,dp[(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>][n<span class="number">-1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">0 2 4 5 1</span></span><br><span class="line"><span class="comment">2 0 6 5 3</span></span><br><span class="line"><span class="comment">4 6 0 8 3</span></span><br><span class="line"><span class="comment">5 5 8 0 5</span></span><br><span class="line"><span class="comment">1 3 3 5 0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="P1896-SCOI2005-互不侵犯"><a href="#P1896-SCOI2005-互不侵犯" class="headerlink" title="P1896 [SCOI2005]互不侵犯"></a><a href="https://www.luogu.com.cn/problem/P1896">P1896 [SCOI2005]互不侵犯</a></h3><p>也是一道较为经典的状压dp题，考虑当前行与上一行的状态，满足：</p><ul><li>没有相邻的 $1$ </li><li>$s_{line}\&amp;s_{line-1}=0$</li></ul><p>即可。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS=(<span class="number">1</span>&lt;&lt;<span class="number">10</span>)<span class="number">-1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK=<span class="number">101</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,K,Total;</span><br><span class="line">ll dp[MAXK][MAXN][MAXS],ok[MAXS],cnt[MAXS];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>;s&lt;(<span class="number">1</span>&lt;&lt;N);++s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> o=s,c=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(o)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(o&amp;<span class="number">1</span>) ++c;</span><br><span class="line">            o&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt[s]=c;</span><br><span class="line">        <span class="keyword">if</span>(!(((s&lt;&lt;<span class="number">1</span>)|(s&gt;&gt;<span class="number">1</span>))&amp;s)) ok[++Total]=s;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-compression.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-compression.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N),<span class="built_in">read</span>(K);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> line=<span class="number">1</span>;line&lt;=N;++line)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>;l&lt;=Total;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> sl=ok[l];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> r=<span class="number">1</span>;r&lt;=Total;++r)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> sr=ok[r];</span><br><span class="line">                <span class="keyword">if</span>(!((sr|(sr&lt;&lt;<span class="number">1</span>)|(sr&gt;&gt;<span class="number">1</span>))&amp;sl))</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;=K;++k)</span><br><span class="line">                        <span class="keyword">if</span>(k-cnt[sl]&gt;=<span class="number">0</span>)</span><br><span class="line">                            dp[k][line][sl]+=dp[k-cnt[sl]][line<span class="number">-1</span>][sr];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ll ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Total;++i) ans+=dp[K][N][ok[i]];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="P2704-NOI2001-炮兵阵地"><a href="#P2704-NOI2001-炮兵阵地" class="headerlink" title="P2704 [NOI2001] 炮兵阵地"></a><a href="https://www.luogu.com.cn/problem/P2704">P2704 [NOI2001] 炮兵阵地</a></h3><p>这便是一道比较进阶的状压dp题了。因为对于一排而言，我们需要记录前两行的信息才能对该行的信息进行转移。所以需要维护前两行的状态，用 $dp[i][j][k]$ 表示第 $i$ 行的状态是 $j$ 并且 $i-1$ 行的状态是 $k$ 的答案总数。并对 $i-2$ 进行转移。</p><p>但是，这样的时间复杂度是 $2^{3m}n$ ，根本不够。所以，我们需要预处理出对于每一行而言的可行方案，直接在可行方案里计算即可。</p><p>然而，空间复杂度 $O(2^{2m}n)$ ，又超出了空间限制，所以我们可以像背包那样使用滚动数组。</p><details>    <summary>查看代码</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> popcount(x) __builtin_popcount(x)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">101</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">11</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS=<span class="number">1</span>&lt;&lt;<span class="number">10</span>|<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m,id[MAXS],sz;</span><br><span class="line"><span class="type">int</span> dp[<span class="number">2</span>][MAXS][MAXS];</span><br><span class="line"><span class="type">bool</span> valid[MAXN][MAXM];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;V,okV[MAXS][MAXS];</span><br><span class="line"><span class="type">char</span> op[MAXM+<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>;s&lt;(<span class="number">1</span>&lt;&lt;m);++s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">bool</span> flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;m<span class="number">-1</span>&amp;&amp;flag;++j)</span><br><span class="line">            <span class="keyword">if</span>(s&gt;&gt;j&amp;<span class="number">1</span>) flag=!(s&gt;&gt;(j+<span class="number">1</span>)&amp;<span class="number">1</span>)&amp;&amp;!(s&gt;&gt;(j+<span class="number">2</span>)&amp;<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(flag) id[s]=V.<span class="built_in">size</span>(),V.<span class="built_in">push_back</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    sz=V.<span class="built_in">size</span>();      <span class="comment">//V[0,sz-1] is valid</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;sz;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;sz;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(V[i]&amp;V[j]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;sz;++k)</span><br><span class="line">                <span class="keyword">if</span>(!(V[i]&amp;V[k])&amp;&amp;!(V[j]&amp;V[k])) okV[i][j].<span class="built_in">push_back</span>(k);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> op,<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line">        <span class="keyword">if</span>((s&gt;&gt;i&amp;<span class="number">1</span>)&amp;&amp;!valid[op][i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-sp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-sp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;m;++j) valid[i][j]=op[j]==<span class="string">&#x27;P&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*memset(dp[0],-63,sizeof(dp[0]));*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;sz;++j)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;sz;++k)</span><br><span class="line">            dp[<span class="number">0</span>][j][k]=-INF;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/*memset(dp[i&amp;1],0,sizeof(dp[i&amp;1]));*/</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;sz;++j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;sz;++k)</span><br><span class="line">                dp[i&amp;<span class="number">1</span>][j][k]=-INF;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;sz;++j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;sz;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[(i<span class="number">-1</span>)&amp;<span class="number">1</span>][j][k]==-INF) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> nxt:okV[j][k])</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">check</span>(i,V[nxt])) dp[i&amp;<span class="number">1</span>][nxt][j]=<span class="built_in">max</span>(dp[i&amp;<span class="number">1</span>][nxt][j],dp[(i<span class="number">-1</span>)&amp;<span class="number">1</span>][j][k]+<span class="built_in">popcount</span>(V[nxt]));</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;sz;++j)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;sz;++k)</span><br><span class="line">        res=<span class="built_in">max</span>(res,dp[n&amp;<span class="number">1</span>][j][k]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 4</span></span><br><span class="line"><span class="comment">PHPP</span></span><br><span class="line"><span class="comment">PPHH</span></span><br><span class="line"><span class="comment">PPPP</span></span><br><span class="line"><span class="comment">PHPP</span></span><br><span class="line"><span class="comment">PHHP</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>其实，状态压缩并不仅限于使用在dp内，很多地方都能用到。方便，但十分难调（机房某巨佬所言）。算是dp一环中比较难的一类了。（之后还会有四边形不等式和斜率优化）</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 优化 </tag>
            
            <tag> 状压dp </tag>
            
            <tag> 状态压缩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树型dp</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-tree/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-tree/</url>
      
        <content type="html"><![CDATA[<p>“父承子业”</p><span id="more"></span><p>简单来说就是在一棵树上进行 $dp$ 操作。一般是从子节点转移到父节点。初始化为叶节点。</p><p>其可扩展性十分高。所以没有固定模板而言。但一般实现方式如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span><span class="comment">//当前节点以及其父节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dp[x]=<span class="comment">/*something*/</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x],v;e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((v=Edge[e].to)==last) <span class="keyword">continue</span>;<span class="comment">//不可回溯</span></span><br><span class="line">        <span class="built_in">dp</span>(v,x);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        some Codes;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    some Code;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">dp</span>(Rt,<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="求树的直径"><a href="#求树的直径" class="headerlink" title="求树的直径"></a>求树的直径</h3><p>两种方法</p><ol><li>两遍 $bfs$ 或 $dfs$ 。第一次从任意点开始，找到该点能到达的最远距离，第二次从找到的点出发，再次找最远点。这两点就是树的直径。复杂度 $O(2n)$ 。</li><li>考虑树型 $dp$ 。时间复杂度 $O(n)$ 。</li></ol><p>第一种方法不必多述，而对于第二种方法：我们用 $dp_{k,x},k \in \{0,1\},x \in n$ 来记录该点所能到达其子树的最远距离和次远距离。</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="P3047-USACO12FEB-Nearby-Cows-G"><a href="#P3047-USACO12FEB-Nearby-Cows-G" class="headerlink" title="P3047 [USACO12FEB]Nearby Cows G"></a><a href="https://www.luogu.com.cn/problem/P3047">P3047 [USACO12FEB]Nearby Cows G</a></h3><p>对于一个点 $x$ ，与它相距不超过 $k$ 的点有两种情况：</p><ul><li>在 $x$ 的儿子之中。</li><li>在 $x$ 之上（或其父节点的另一棵子树）</li></ul><p>那么我们进行两次遍历，第一次查找每一个点向下查找能找到的点权值，记为 <code>dp[0][x][k]</code> ，第二次查找父节点满足条件的点权值，将两次计算相加即可。需要进行容斥。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK=<span class="number">21</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,K,Val[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">&#125;Edge[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN],Total;</span><br><span class="line"><span class="type">int</span> dp[<span class="number">2</span>][MAXN][MAXK];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(Tree)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">    Edge[++Total]=(Tree)&#123;Head[v],u&#125;;Head[v]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=K;++i) dp[<span class="number">0</span>][x][i]=Val[x];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x],v;e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((v=Edge[e].to)==last) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(v,x);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=K;++i) dp[<span class="number">0</span>][x][i]+=dp[<span class="number">0</span>][v][i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfsSec</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x],v;e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((v=Edge[e].to)==last) <span class="keyword">continue</span>;</span><br><span class="line">        dp[<span class="number">1</span>][v][<span class="number">1</span>]+=dp[<span class="number">0</span>][x][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=K;++i) dp[<span class="number">1</span>][v][i]+=dp[<span class="number">1</span>][x][i<span class="number">-1</span>]-dp[<span class="number">0</span>][v][i<span class="number">-2</span>];</span><br><span class="line">        <span class="built_in">dfsSec</span>(v,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;tredp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;tredp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N),<span class="built_in">read</span>(K);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u,v;</span><br><span class="line">        <span class="built_in">read</span>(u),<span class="built_in">read</span>(v);</span><br><span class="line">        <span class="built_in">addEdge</span>(u,v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">read</span>(Val[i]);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=K;++j)</span><br><span class="line">            dp[<span class="number">1</span>][i][j]=dp[<span class="number">0</span>][i][j];</span><br><span class="line">    <span class="built_in">dfsSec</span>(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,dp[<span class="number">1</span>][i][K]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6 2 </span></span><br><span class="line"><span class="comment">5 1 </span></span><br><span class="line"><span class="comment">3 6 </span></span><br><span class="line"><span class="comment">2 4 </span></span><br><span class="line"><span class="comment">2 1 </span></span><br><span class="line"><span class="comment">3 2 </span></span><br><span class="line"><span class="comment">1 </span></span><br><span class="line"><span class="comment">2 </span></span><br><span class="line"><span class="comment">3 </span></span><br><span class="line"><span class="comment">4 </span></span><br><span class="line"><span class="comment">5 </span></span><br><span class="line"><span class="comment">6 </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="P7103-「C-E-L-U-01」族谱树"><a href="#P7103-「C-E-L-U-01」族谱树" class="headerlink" title="P7103 「C.E.L.U-01」族谱树"></a><a href="https://www.luogu.com.cn/problem/P7103">P7103 「C.E.L.U-01」族谱树</a></h3><p>这道题其实并不是一道纯粹树型 $dp$ 。直接用 $Tarjan$ 求所有深度的 $lca$ 即可。复杂度 $O(n+q)$ 。据说 $O(n \log n)$ 会被卡。不清楚。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">5e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,K[MAXN],Q;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">&#125;Edge[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN],Total;</span><br><span class="line"><span class="type">int</span> f[MAXN],dep[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(Tree)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==f[x]) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dpTree</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[x]=dep[last]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x];e;e=Edge[e].next) <span class="built_in">dpTree</span>(Edge[e].to,x),f[Edge[e].to]=x;</span><br><span class="line">    K[dep[x]]=K[dep[x]]?<span class="built_in">find</span>(K[dep[x]]):x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;tredp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;tredp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N),<span class="built_in">read</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,fa;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(fa);f[i]=i;</span><br><span class="line">        <span class="built_in">addEdge</span>(fa,i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dpTree</span>(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">while</span>(M--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(Q);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,K[Q]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8 3</span></span><br><span class="line"><span class="comment">0 1 1 2 2 3 4 5</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="Loj-10155-「一本通-5-2-例-3」数字转换"><a href="#Loj-10155-「一本通-5-2-例-3」数字转换" class="headerlink" title="Loj#10155. 「一本通 5.2 例 3」数字转换"></a><a href="https://loj.ac/p/10155">Loj#10155. 「一本通 5.2 例 3」数字转换</a></h3><p>这题我还比较喜欢。不看标签我是绝对不会想到用树型 $dp$ 来解的。我们记数 $i$ 的约数和为 $f(i)$ 。而当 $f(i) \leq i$ 时，可以互相转换。如果将每一个数都看作一个节点，则我们连一条边 $c(i,f(i))$ 。然后对于这一个无向图。求出其直径即可。而对于线性求约数和。读者可以自行思考如何实现复杂度 $O(n \log n)$，或者看代码。</p><details>    <summary>AC Code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> Limit,f[MAXN],dp[<span class="number">3</span>][MAXN],ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;MAXN;++i) f[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;MAXN;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>;i*j&lt;MAXN;++j)</span><br><span class="line">            f[i*j]+=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">&#125;Edge[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN],Total;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(Tree)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">    Edge[++Total]=(Tree)&#123;Head[v],u&#125;;Head[v]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dpTree</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x];e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v=Edge[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v==last||v==x) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dpTree</span>(v,x);</span><br><span class="line">        <span class="keyword">if</span>(dp[<span class="number">1</span>][x]&lt;dp[<span class="number">1</span>][v]+<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[<span class="number">2</span>][x]=dp[<span class="number">1</span>][x];</span><br><span class="line">            dp[<span class="number">1</span>][x]=dp[<span class="number">1</span>][v]+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(dp[<span class="number">2</span>][x]&lt;dp[<span class="number">1</span>][v]+<span class="number">1</span>) dp[<span class="number">2</span>][x]=dp[<span class="number">1</span>][v]+<span class="number">1</span>;</span><br><span class="line">        ans=<span class="built_in">max</span>(ans,dp[<span class="number">1</span>][x]+dp[<span class="number">2</span>][x]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;tree-d.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;tree-d.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">read</span>(Limit);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Limit;++i) <span class="keyword">if</span>(i&gt;=f[i]) <span class="built_in">addEdge</span>(i,f[i]);</span><br><span class="line">    <span class="comment">// for(int i=1;i&lt;=Limit;++i) cout&lt;&lt;i&lt;&lt;&quot; &quot;&lt;&lt;f[i]&lt;&lt;endl;</span></span><br><span class="line">    <span class="built_in">dpTree</span>(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">79</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 优化 </tag>
            
            <tag> 图论 </tag>
            
            <tag> 搜索 </tag>
            
            <tag> LCA </tag>
            
            <tag> 树型dp </tag>
            
            <tag> 树型结构 </tag>
            
            <tag> 并查集 </tag>
            
            <tag> 递归 </tag>
            
            <tag> 换根dp </tag>
            
            <tag> 二次扫描与换根法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树上最近公共祖先(LCA)</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/lca/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/lca/</url>
      
        <content type="html"><![CDATA[<p>“你与我最初的缔结”</p><span id="more"></span><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><strong>LCA（Least Common Ancestors）</strong>：即最近公共祖先，是指在有根树中，找出某两个结点 $u$ 和 $v$ 最近的公共祖先。</p><p>对于下图（取自洛谷）：</p><p><img src="https://cdn.luogu.com.cn/upload/pic/61612.png" alt="LCA"></p><p>$lca(13,5)=3$</p><p>$lca(6,4)=4$</p><p>$lca(18,2)=2$</p><p>$lca(15,18)=5$</p><p>…</p><h2 id="朴素思路"><a href="#朴素思路" class="headerlink" title="朴素思路"></a>朴素思路</h2><p>从一个点开始，向上标记至根节点；然后将另一点向上搜索到第一个标记的点，该点则是两点的 $lca$ 。这样的复杂度是 $O(nq)$ ，$q$ 表示询问次数。<del>非常滴慢</del>。</p><h2 id="一般方法"><a href="#一般方法" class="headerlink" title="一般方法"></a>一般方法</h2><h3 id="倍增"><a href="#倍增" class="headerlink" title="倍增"></a>倍增</h3><h3 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分"></a>树链剖分</h3><h3 id="Tarjan"><a href="#Tarjan" class="headerlink" title="Tarjan"></a>Tarjan</h3><h3 id="st表"><a href="#st表" class="headerlink" title="st表"></a>st表</h3><p>做到 $O(n \log n)$ 的预处理，$O(1)$ 的查询，算比较快的了。将整个树遍历，每遍历一个点将其加至序列末尾。记为数组 $id(x)$ 。无论是到达还是回溯都需要记录。可以证明该序列不会超过 $2n-1$ 。从 $x$ 到 $y$ 需要从 $lca$ 的一个子树走到另一个子树。则在区间 $[id(x),id(y)]$ 之间一定存在 $lca(x,y)$ 。</p><p>而 $lca(x,y)$ 就是其中深度最小的点。用 $st$ 表维护。</p><details>    <summary>ST表<summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">5e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,Idx,Rt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">&#125;Edge[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN],Total;</span><br><span class="line"><span class="type">int</span> Log[MAXN&lt;&lt;<span class="number">1</span>],St[MAXN&lt;&lt;<span class="number">1</span>][<span class="number">64</span>],Dep[MAXN],Id[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAddEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[v],u&#125;;Head[v]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underSwap</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x^=y^=x^=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underDfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    St[++Idx][<span class="number">0</span>]=x;Id[x]=Idx;Dep[x]=Dep[last]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x],v;e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((v=Edge[e].to)==last) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">underDfs</span>(v,x);</span><br><span class="line">        St[++Idx][<span class="number">0</span>]=x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underDepMin</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dep[a]&lt;Dep[b]?a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=Idx;++i) Log[i]=Log[i&gt;&gt;<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;k)&lt;=Idx;++k)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;k)<span class="number">-1</span>&lt;=Idx;++i)</span><br><span class="line">            St[i][k]=<span class="built_in">underDepMin</span>(St[i][k<span class="number">-1</span>],St[i+(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))][k<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underLca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=Id[x],y=Id[y];</span><br><span class="line">    <span class="keyword">if</span>(x&gt;y) <span class="built_in">underSwap</span>(x,y);</span><br><span class="line">    <span class="type">int</span> k=Log[y-x+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">underDepMin</span>(St[x][k],St[y-(<span class="number">1</span>&lt;&lt;(k))+<span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;LCA.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;LCA.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M),<span class="built_in">underRead</span>(Rt);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,u,v;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(u),<span class="built_in">underRead</span>(v);</span><br><span class="line">        <span class="built_in">underAddEdge</span>(u,v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underDfs</span>(Rt,<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">underInit</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x,y;M;--M)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(x),<span class="built_in">underRead</span>(y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underLca</span>(x,y));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5 4</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">5 1</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">3 2</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 搜索 </tag>
            
            <tag> LCA </tag>
            
            <tag> Tarjan </tag>
            
            <tag> 树型结构 </tag>
            
            <tag> 并查集 </tag>
            
            <tag> 递归 </tag>
            
            <tag> ST表 </tag>
            
            <tag> 倍增 </tag>
            
            <tag> 树链剖分 </tag>
            
            <tag> 分治 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数位dp</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-digit/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-digit/</url>
      
        <content type="html"><![CDATA[<p>“聚小而大”</p><span id="more"></span><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>一种以位数为转移条件的 $dp$ ，一般是统计一个区间内满足一类条件的计数 $dp$ 。一般的初始转移有二维 $dp_{i,j}$ 表示有 $i$ 位且末位为 $j$ 的统计个数。一般满足差分性质（与<strong>树状数组</strong>类似），即 $[l,r]=[1,r]-[1,l-1]$ 的性质。</p><h2 id="写法"><a href="#写法" class="headerlink" title="写法"></a>写法</h2><h3 id="迭代式"><a href="#迭代式" class="headerlink" title="迭代式"></a>迭代式</h3><p>即使用 <code>for</code> 循环来遍历整个 <code>dp</code> 数组。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;Num;<span class="comment">//存储limit的每一位</span></span><br><span class="line">    <span class="keyword">while</span>(x) Num.<span class="built_in">push_back</span>(x%<span class="number">10</span>),x/=<span class="number">10</span>;</span><br><span class="line">    ll res=<span class="number">0</span>;<span class="comment">//存储答案</span></span><br><span class="line">    <span class="type">int</span> last=<span class="comment">/*init*/</span>;<span class="comment">//限制条件s</span></span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=Num.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=Num[i];</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;x;++j) <span class="keyword">if</span>(<span class="comment">/*some condition*/</span>) res+=dp[i+<span class="number">1</span>][j];</span><br><span class="line">        <span class="keyword">if</span>(<span class="comment">/*some condition*/</span>) last=x;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>(!i) ++res;</span><br><span class="line">&#125;<span class="comment">//以limit=119547为例，这部分计算的是[100000,119547]的值</span></span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=Num.<span class="built_in">size</span>()<span class="number">-2</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">9</span>;++j)</span><br><span class="line">            res+=dp[i+<span class="number">1</span>][j];</span><br><span class="line">    <span class="comment">//同上，这部分计算[1,99999]的总值</span></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="记忆化"><a href="#记忆化" class="headerlink" title="记忆化"></a>记忆化</h3><p>使用<code>dfs</code>遍历所有的情况</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="type">int</span> x<span class="comment">/*,bool con1,bool con2...bool conn*/</span>)</span><span class="comment">//一些限制条件，x表示位数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!x) <span class="keyword">return</span> <span class="comment">/*something*/</span>;</span><br><span class="line">    ll &amp;res=dp[x]<span class="comment">/*[some][conditions]...[]*/</span>;</span><br><span class="line">    <span class="keyword">if</span>(~res) <span class="keyword">return</span> res;<span class="comment">//该位置已达到</span></span><br><span class="line">    res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;=cntN;++i)<span class="comment">//limit范围内</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="comment">/*some conditions*/</span>) <span class="comment">/*something*/</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="comment">/*some conditions*/</span>) <span class="comment">/*something*/</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">/*something*/</span>;</span><br><span class="line">        res+=<span class="built_in">dfs</span>(x<span class="number">-1</span><span class="comment">/*,...,...,...,*/</span>);<span class="comment">//查找下一位</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>将所有应算的都算出来， $dp$ 的过程只是在查找 $limit$ 范围之内的。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">9</span>;++i) dp[<span class="number">1</span>][i]=<span class="number">1</span>;<span class="comment">//处理[0,9]</span></span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;MAXN;++i)</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">9</span>;++j)</span><br><span class="line">            <span class="comment">/*for(re int l=?;?;?)*/</span></span><br><span class="line">            <span class="comment">/*some conditions*/</span>dp[i][j]=dp[i<span class="number">-1</span>][<span class="comment">/*some conditions*/</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="Luogu-P2657-windy数"><a href="#Luogu-P2657-windy数" class="headerlink" title="Luogu P2657 windy数"></a><a href="https://www.luogu.com.cn/problem/P2657">Luogu P2657 windy数</a></h3><h4 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h4><p>数位 $dp$ 模板题，用 $dp_{i,j}$ 表示位数为 $i$ ，最高位是 $j$ 的计数，递推出在 $limit$ 内满足的个数，对于相邻的两位，只要其相差不到 $2$ 都可以相加。最终答案便是 <code>dp(r)-dp(l-1)</code> 。</p><h4 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h4><p>递推写法。</p><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dp[<span class="number">11</span>][<span class="number">11</span>],l,r;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underAbs</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x&gt;<span class="number">0</span>?x:-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">9</span>;++i) dp[<span class="number">1</span>][i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">10</span>;++i)</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">9</span>;++j)</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> l=<span class="number">0</span>;l&lt;=<span class="number">9</span>;++l)</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">underAbs</span>(l-j)&gt;=<span class="number">2</span>)</span><br><span class="line">                    dp[i][l]+=dp[i<span class="number">-1</span>][j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underDp</span><span class="params">(<span class="type">int</span> N)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!N) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;Num;</span><br><span class="line">    Num.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="type">int</span> n=N,res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n) Num.<span class="built_in">push_back</span>(n%<span class="number">10</span>),n/=<span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> last=<span class="number">-2</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=Num.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=Num[i];</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=i==Num.<span class="built_in">size</span>()<span class="number">-1</span>;j&lt;x;++j)</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">underAbs</span>(j-last)&gt;=<span class="number">2</span>) res+=dp[i+<span class="number">1</span>][j];</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">underAbs</span>(x-last)&gt;=<span class="number">2</span>) last=x;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>(!i) ++res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=Num.<span class="built_in">size</span>()<span class="number">-2</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">9</span>;++j)</span><br><span class="line">            res+=dp[i+<span class="number">1</span>][j];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;digit-dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;digit-dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(l),<span class="built_in">underRead</span>(r);</span><br><span class="line">    <span class="built_in">underInit</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,<span class="built_in">underDp</span>(r)-<span class="built_in">underDp</span>(l<span class="number">-1</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">25 50</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="Loj-10166-数字游戏"><a href="#Loj-10166-数字游戏" class="headerlink" title="Loj #10166 数字游戏"></a><a href="https://loj.ac/p/10166">Loj #10166 数字游戏</a></h3><h4 id="解释-1"><a href="#解释-1" class="headerlink" title="解释"></a>解释</h4><p>与上一题差不了多少。预处理 $dp_{i,j,k}$ 表示 $i$ 位最高位为 $j$ 且模 $k$ 的计数即可。</p><h4 id="AC-Code-1"><a href="#AC-Code-1" class="headerlink" title="AC Code"></a>AC Code</h4><p>同样是迭代式写法。</p><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXMOD=<span class="number">101</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> l,r,mod;</span><br><span class="line">ll dp[MAXN][<span class="number">10</span>][MAXMOD];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underMod</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x%mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">9</span>;++i) dp[<span class="number">1</span>][i][i%mod]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">2</span>;i&lt;MAXN;++i)</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">9</span>;++j)</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> k=<span class="number">0</span>;k&lt;=<span class="number">9</span>;++k)</span><br><span class="line">                <span class="keyword">for</span>(re <span class="type">int</span> l=<span class="number">0</span>;l&lt;mod;++l)</span><br><span class="line">                    dp[i][j][l]+=dp[i<span class="number">-1</span>][k][<span class="built_in">underMod</span>(l-j)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">underDp</span><span class="params">(<span class="type">int</span> N)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!N) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;Num;</span><br><span class="line">    <span class="keyword">while</span>(N) Num.<span class="built_in">push_back</span>(N%<span class="number">10</span>),N/=<span class="number">10</span>;</span><br><span class="line">    ll res=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> last=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=Num.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=Num[i];</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;x;++j) res+=dp[i+<span class="number">1</span>][j][<span class="built_in">underMod</span>(-last)];</span><br><span class="line">        last=<span class="built_in">underMod</span>(last+x);</span><br><span class="line">        <span class="keyword">if</span>(!i&amp;&amp;!last) ++res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;digit-dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;digit-dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;l&gt;&gt;r&gt;&gt;mod)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underInit</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">underDp</span>(r)-<span class="built_in">underDp</span>(l<span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1 19 9</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="Luogu-P6669-组合数问题"><a href="#Luogu-P6669-组合数问题" class="headerlink" title="Luogu P6669 组合数问题"></a><a href="https://www.luogu.com.cn/problem/P6669">Luogu P6669 组合数问题</a></h3><h4 id="解释-2"><a href="#解释-2" class="headerlink" title="解释"></a>解释</h4><p>其实这道题用记忆化要好些一些，一个五维数组记录位数，$n$ 数是否达到上限， $m$ 数是否达到上限，$n$和 $m$ 是否相同过以及 $n$ 是否小于过 $m$ 的情况。这里需要很多组合数的前置知识（比如<strong>卢卡斯定理</strong>）以优化。这里不多解释，有兴趣可以在洛谷上看题解。</p><h4 id="AC-Code-2"><a href="#AC-Code-2" class="headerlink" title="AC Code"></a>AC Code</h4><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">61</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll n,m,dp[MAXN][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>],N[MAXN],M[MAXN],k;</span><br><span class="line"><span class="type">int</span> T;</span><br><span class="line"><span class="function">ll <span class="title">underDfs</span><span class="params">(<span class="type">int</span> x,<span class="type">bool</span> qn,<span class="type">bool</span> qm,<span class="type">bool</span> dif,<span class="type">bool</span> sml)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!x) <span class="keyword">return</span> sml;</span><br><span class="line">    ll &amp;res=dp[x][qn][qm][dif][sml];</span><br><span class="line">    <span class="keyword">if</span>(~res) <span class="keyword">return</span> res;</span><br><span class="line">    res=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> cntN=qn?k<span class="number">-1</span>:N[x],cntM=qm?k<span class="number">-1</span>:M[x];</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;=cntN;++i)</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;(j&lt;=i||dif)&amp;&amp;j&lt;=cntM;++j)</span><br><span class="line">            res=(res+<span class="built_in">underDfs</span>(x<span class="number">-1</span>,qn|(i&lt;cntN),qm|(j&lt;cntM),dif|(i!=j),sml|(i&lt;j)))%MOD;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;digit-dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;digit-dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(T),<span class="built_in">underRead</span>(k);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(n),<span class="built_in">underRead</span>(m);</span><br><span class="line">        <span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">        ll Max=<span class="built_in">underMax</span>(n,m),size=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(Max) Max/=k,++size;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=size;++i) N[i]=n%k,n/=k;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=size;++i) M[i]=m%k,m/=k;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">underDfs</span>(size,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 优化 </tag>
            
            <tag> 数位dp </tag>
            
            <tag> 组合数学 </tag>
            
            <tag> Lucas定理 </tag>
            
            <tag> 二项式定理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOI-Online 2022 提高组</title>
      <link href="/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/noionline-senior-2022/"/>
      <url>/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/noionline-senior-2022/</url>
      
        <content type="html"><![CDATA[<p>被单调队列了。</p><span id="more"></span><h2 id="T1-P8251-丹钓战"><a href="#T1-P8251-丹钓战" class="headerlink" title="T1 P8251 丹钓战"></a><a href="https://www.luogu.com.cn/problem/P8251">T1 P8251 丹钓战</a></h2><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>单调栈预处理出一个 $c$ 数组以记录每一个数对答案的贡献。然后将题意转化为求 $[l,r]$ 中小于 $l$ 的个数，每个元素对答案的贡献当且仅当其下的元素不在 $[l,r]$ 之间。用主席树维护即可。</p><p>官方时间复杂度 $O((n+q) \log n)$</p><p><del>考场没打出来，暴力30pt</del></p><h3 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">5e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,T,Rt[MAXN],Idx,Ql,Qr;</span><br><span class="line"><span class="type">int</span> a[MAXN],b[MAXN],c[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PST</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l,r,dat;</span><br><span class="line">&#125;Tree[MAXN&lt;&lt;<span class="number">6</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[x].dat=Tree[Tree[x].l].dat+Tree[Tree[x].r].dat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underBuild</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=++Idx;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">underBuild</span>(Tree[x].l,l,mid),<span class="built_in">underBuild</span>(Tree[x].r,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[++Idx]=Tree[x];</span><br><span class="line">    ++Tree[Idx].dat,x=Idx;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;=mid) <span class="built_in">underModify</span>(Tree[x].l,l,mid,d);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">underModify</span>(Tree[x].r,mid+<span class="number">1</span>,r,d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQuery</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k==mid) <span class="keyword">return</span> Tree[Tree[x].l].dat;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;mid) <span class="keyword">return</span> <span class="built_in">underQuery</span>(Tree[x].l,l,mid,k);</span><br><span class="line">    <span class="keyword">return</span> Tree[Tree[x].l].dat+<span class="built_in">underQuery</span>(Tree[x].r,mid+<span class="number">1</span>,r,k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;stack.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;stack.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">underRead</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">underRead</span>(b[i]);</span><br><span class="line">    a[<span class="number">0</span>]=c[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    b[<span class="number">0</span>]=INF;</span><br><span class="line">    <span class="built_in">underBuild</span>(Rt[<span class="number">0</span>],<span class="number">0</span>,N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> l=<span class="number">0</span>,r=T,mid;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)</span><br><span class="line">        &#123;</span><br><span class="line">            mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(b[i]&lt;b[c[mid]]) l=mid;</span><br><span class="line">            <span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(a[c[l]]==a[i]) --l;</span><br><span class="line">        T=l+<span class="number">1</span>;</span><br><span class="line">        c[T]=i;</span><br><span class="line">        Rt[i]=Rt[i<span class="number">-1</span>];</span><br><span class="line">        <span class="built_in">underModify</span>(Rt[i],<span class="number">0</span>,N,c[l]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(Ql),<span class="built_in">underRead</span>(Qr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underQuery</span>(Rt[Qr],<span class="number">0</span>,N,Ql<span class="number">-1</span>)-<span class="built_in">underQuery</span>(Rt[Ql<span class="number">-1</span>],<span class="number">0</span>,N,Ql<span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 4</span></span><br><span class="line"><span class="comment">3 1 3 1 2 3 3 2 1 1</span></span><br><span class="line"><span class="comment">10 10 2 9 7 5 4 7 6 1</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">7 8</span></span><br><span class="line"><span class="comment">7 10</span></span><br><span class="line"><span class="comment">1 8</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="T2-P8252-讨论"><a href="#T2-P8252-讨论" class="headerlink" title="T2 P8252 讨论"></a><a href="https://www.luogu.com.cn/problem/P8252">T2 P8252 讨论</a></h2><h2 id="T3-P8253-如何正确地排序"><a href="#T3-P8253-如何正确地排序" class="headerlink" title="T3 P8253 如何正确地排序"></a><a href="https://www.luogu.com.cn/problem/P8253">T3 P8253 如何正确地排序</a></h2>]]></content>
      
      
      <categories>
          
          <category> 模拟赛/比赛 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RMQ </tag>
            
            <tag> 数论 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 分治 </tag>
            
            <tag> 单调栈 </tag>
            
            <tag> 主席树 </tag>
            
            <tag> 可持久化数据结构 </tag>
            
            <tag> 容斥原理 </tag>
            
            <tag> 三维偏序 </tag>
            
            <tag> CDQ分治 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构2022.03.20练习</title>
      <link href="/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220320/"/>
      <url>/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220320/</url>
      
        <content type="html"><![CDATA[<p>结果：C Accepted</p><p>改题进度：BC Accepted</p><span id="more"></span><h2 id="Task-One——Tree"><a href="#Task-One——Tree" class="headerlink" title="Task One——Tree"></a>Task One——Tree</h2><p>始终不得求解</p><h2 id="Task-Two——普通计算姬-common"><a href="#Task-Two——普通计算姬-common" class="headerlink" title="Task Two——普通计算姬(common)"></a>Task Two——普通计算姬(common)</h2><p><a href="https://hydro.ac/d/bzoj/p/4765">题目链接</a></p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>求出该树的 $dfs$ 序。对于每一次询问，用树状数组或者线段树维护即可。对于修改，部分分做法即是对树状数组进行暴力修改。然而这样只能得 $90pt$ 。然后将整个 $dfs$ 序的序列进行分块，记录每一个点对每一个序列的贡献，修改序列和即可。最后一个点会爆 $long \ long$ ，需要开 $ull$ </p><h3 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ls p&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rs p&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,u,v,op,Qf,Qs,Rt,Idx,Blo;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">&#125;Edge[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> Head[MAXN],Total,cnt[MAXN],pos[MAXN],r[MAXN][<span class="number">401</span>];</span><br><span class="line">ull Val[MAXN],Tre[MAXN],sum[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Segment</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l,r;</span><br><span class="line">&#125;Seg[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAddEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[u],v&#125;;Head[u]=Total;</span><br><span class="line">    Edge[++Total]=(edge)&#123;Head[v],u&#125;;Head[v]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underDfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Seg[x].l=++Idx;++cnt[pos[x]];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Blo;++i) r[x][i]=cnt[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=Head[x];e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v=Edge[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v!=last) <span class="built_in">underDfs</span>(v,x);</span><br><span class="line">    &#125;</span><br><span class="line">    Seg[x].r=Idx;--cnt[pos[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underLowbit</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAdd</span><span class="params">(<span class="type">int</span> x,ull val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(;x&lt;=N;x+=<span class="built_in">underLowbit</span>(x)) Tre[x]+=val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ull <span class="title">underQuery</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ull ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;x&gt;=<span class="number">1</span>;x-=<span class="built_in">underLowbit</span>(x)) ans+=Tre[x];</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ull <span class="title">underCalc</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">underQuery</span>(r)-<span class="built_in">underQuery</span>(l<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInitBlock</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> block=<span class="built_in">sqrt</span>(N);</span><br><span class="line">    Blo=(N%block)?(N/block+<span class="number">1</span>):(N/block);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) pos[i]=(i<span class="number">-1</span>)/Blo+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underUpdate</span><span class="params">(<span class="type">int</span> x,ull k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Blo;++i) sum[i]+=(ull)r[x][i]*k;</span><br><span class="line">    <span class="built_in">underAdd</span>(Seg[x].l,k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ull <span class="title">underAns</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ull res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos[r]-pos[l]&lt;=<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) res+=<span class="built_in">underCalc</span>(Seg[i].l,Seg[i].r);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=pos[l]*Blo;++i) res+=<span class="built_in">underCalc</span>(Seg[i].l,Seg[i].r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=pos[l]+<span class="number">1</span>;i&lt;=pos[r]<span class="number">-1</span>;++i) res+=sum[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(pos[r]<span class="number">-1</span>)*Blo+<span class="number">1</span>;i&lt;=r;++i) res+=<span class="built_in">underCalc</span>(Seg[i].l,Seg[i].r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;common.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;common.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="built_in">underInitBlock</span>();</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">underRead</span>(Val[i]);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(u),<span class="built_in">underRead</span>(v);</span><br><span class="line">        <span class="keyword">if</span>(!u) Rt=v;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!u) Rt=u;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">underAddEdge</span>(u,v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underDfs</span>(Rt,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">underUpdate</span>(i,Val[i]);</span><br><span class="line">    <span class="keyword">while</span>(M--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(op),<span class="built_in">underRead</span>(Qf),<span class="built_in">underRead</span>(Qs);</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">underUpdate</span>(Qf,Qs-Val[Qf]);</span><br><span class="line">            Val[Qf]=Qs;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%llu\n&quot;</span>,<span class="built_in">underAns</span>(Qf,Qs));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6 4</span></span><br><span class="line"><span class="comment">0 0 3 4 0 1</span></span><br><span class="line"><span class="comment">0 1</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">2 1 2</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">2 3 6</span></span><br><span class="line"><span class="comment">2 3 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="Task-Three——文艺计算姬-art"><a href="#Task-Three——文艺计算姬-art" class="headerlink" title="Task Three——文艺计算姬(art)"></a>Task Three——文艺计算姬(art)</h2><p><a href="https://hydro.ac/d/bzoj/p/4766">题目链接</a></p><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>暴力取一些比较小的点，然后推公式。毕竟 $1 \leq n,m \leq 10^{18}$ 。</p><p>然后推得公式为 $ans=n^{m-1}m^{n-1}$ 。然后用快速幂即可。注意 $1e18*1e18$ 会爆 $long\ long$ 。所以需要快速乘。</p><h3 id="AC-Code-1"><a href="#AC-Code-1" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll N,M,P,tot,ans;</span><br><span class="line"><span class="type">int</span> fa[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n+m;++i) fa[i]=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underFind</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(fa[x]==x) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> fa[x]=<span class="built_in">underFind</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underD</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m,<span class="type">int</span> edge)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(edge==n+m<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ++ans;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=n+<span class="number">1</span>;j&lt;=m;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">underFind</span>(i)!=<span class="built_in">underFind</span>(j))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> p1=<span class="built_in">underFind</span>(i),p2=<span class="built_in">underFind</span>(j);</span><br><span class="line">                fa[p1]=p2;</span><br><span class="line">                <span class="built_in">underD</span>(n,m,edge+<span class="number">1</span>);</span><br><span class="line">                fa[p1]=p1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">underSmi</span><span class="params">(ll a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(b&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res=(res+a)%p;</span><br><span class="line">        a=(a+a)%p;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// printf(&quot;%lld %lld %lld\n&quot;,a,b,res);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">underQmi</span><span class="params">(ll a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res=<span class="built_in">underSmi</span>(res,a,p)%p;</span><br><span class="line">        a=<span class="built_in">underSmi</span>(a,a,p)%p;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;art.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;art.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M),<span class="built_in">underRead</span>(P);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,<span class="built_in">underSmi</span>(<span class="built_in">underQmi</span>(N,M<span class="number">-1</span>,P),<span class="built_in">underQmi</span>(M,N<span class="number">-1</span>,P),P));</span><br><span class="line">    <span class="comment">// printf(&quot;%lld %lld\n&quot;,N,M);</span></span><br><span class="line">    <span class="comment">/*for(re int i=1;i&lt;=N;++i)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        for(re int j=1;j&lt;=M;++j)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            underInit(i,j);</span></span><br><span class="line"><span class="comment">            underD(i,j,0);</span></span><br><span class="line"><span class="comment">            printf(&quot;%d,%d=%lld\n&quot;,i,j,ans);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1,1=1</span></span><br><span class="line"><span class="comment">1,2=1</span></span><br><span class="line"><span class="comment">2,2=4</span></span><br><span class="line"><span class="comment">2,3=12</span></span><br><span class="line"><span class="comment">2,4=32</span></span><br><span class="line"><span class="comment">3,1=1</span></span><br><span class="line"><span class="comment">3,2=12</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">f(n,m)=n^(m-1)*m^(n-1)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 模拟赛/比赛 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> RMQ </tag>
            
            <tag> 数论 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 树状数组 </tag>
            
            <tag> 块状链表，块状数组，分块 </tag>
            
            <tag> Dfs序 </tag>
            
            <tag> Prufer序 </tag>
            
            <tag> Matrix-Tree定理 </tag>
            
            <tag> LCA </tag>
            
            <tag> Tarjan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P3850书架</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/p3850/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/p3850/</url>
      
        <content type="html"><![CDATA[<p>“STL的妙用”</p><span id="more"></span><p>使用 $rope$ 轻松解决。</p><p><a href="https://violeteternal.github.io/Eternity/%E9%A2%98%E8%A7%A3/p4008">rope的使用</a></p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,x;</span><br><span class="line">string t[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line">rope&lt;<span class="type">int</span>&gt;R;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;rope.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;rope.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;t[R.<span class="built_in">size</span>()];</span><br><span class="line">        R.<span class="built_in">push_back</span>(R.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underRead</span>(N);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;t[R.<span class="built_in">size</span>()];</span><br><span class="line">        <span class="built_in">underRead</span>(x);</span><br><span class="line">        R.<span class="built_in">insert</span>(x,R.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underRead</span>(N);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(x);</span><br><span class="line">        cout&lt;&lt;t[R[x]]&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> Splay </tag>
            
            <tag> STL </tag>
            
            <tag> rope </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dcoj2008 蜜雪冰城</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/dcoj2008/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/dcoj2008/</url>
      
        <content type="html"><![CDATA[<p>区间dp经典题</p><span id="more"></span><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定 $m$ 个三元组 $\{a_i,b_i,c_i\}$ ，表示第 $i$ 个人会选择区间 $[a_i,b_i]$ 中最便宜的值 $val_k$ 如果 $c_i \leq val_k$ 。设计一个长度为 $n$ 的数列 $val_i$ 使收益最大。</p><p>输出最大收益以及一种方案，含 $spj$ 。</p><p>样例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#1 in:</span><br><span class="line">7 5</span><br><span class="line">1 4 7</span><br><span class="line">3 7 13</span><br><span class="line">5 6 20</span><br><span class="line">6 7 1</span><br><span class="line">1 2 5</span><br><span class="line"></span><br><span class="line">#1 out:</span><br><span class="line">43</span><br><span class="line">5 5 13 13 20 20 13</span><br><span class="line"></span><br><span class="line">#2 in:</span><br><span class="line">10 10</span><br><span class="line">1 7 3141</span><br><span class="line">2 8 5926</span><br><span class="line">3 5 5358</span><br><span class="line">1 9 9793</span><br><span class="line">5 10 2384</span><br><span class="line">4 7 6264</span><br><span class="line">5 9 3383</span><br><span class="line">9 10 27950</span><br><span class="line">3 8 2884</span><br><span class="line">1 7 1971</span><br><span class="line"></span><br><span class="line">#2 out:</span><br><span class="line">55021</span><br><span class="line">1971 2384 5358 6264 6264 6264 6264 2384 27950 27950</span><br></pre></td></tr></table></figure><p>数据范围：</p><p>$n \leq 50,m \leq 4000,1 \leq a_i \leq b_i \leq n,1 \leq c_i \leq 500000$</p><p>$subtask1:n=1$</p><p>$subtask2:n,m$</p><p>$subtask3:$无特殊限制</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>首先，我们必须明白：$val_k \in T,T=\{c_1,c_2…c_m\},k \in [1,n]$ 。这需要一些简单的证明，这里不多赘述。</p><h3 id="部分分"><a href="#部分分" class="headerlink" title="部分分"></a>部分分</h3><p>对于 $subtask1$ 而言，暴力枚举每一个价格，求出最大收益。期望得分： $30pt$</p><p>对于 $suntask2$ 而言，用 $O(2^m)$ 的时间暴力枚举每一个人是否会贡献答案。用线段树维护区间值，求出最大收益。时间复杂度 $O(2^m(n+m)\log n)$ ，期望得分： $60pt$ 。</p><p><del>这题确实良心</del></p><h3 id="区间dp"><a href="#区间dp" class="headerlink" title="区间dp"></a>区间dp</h3><p>首先离散化出有多少个不同的 $c_i$ ，用 $M$ 表示离散化之后的个数。我们设 $val_k$ 是区间 $[l,r]$ 之间的最小值。$(l \leq k \leq r)$ ，则对于任何一个 $l \leq a_i \leq b_i \leq r$  的人而言，他的答案贡献必定是 $val_k$ 。那么我们用 $dp_{l,r,v}$ 表示区间 $[l,r]$ 内最小值为 $v$ 已得到的最优解。$cnt_k$ 表示有多少个人对该点的答案有贡献。则转移方程为：</p><p>$dp_{l,r,v}=\max\{dp_{l,r,v},dp_{l,k-1,v_1}+dp_{k+1,r,v_2}+cnt_k*v\}(v \leq v_1,v_2 \leq c_M)$</p><p>也许你会直呼：<del>就这？</del></p><p>怎么可能！你算算复杂度：区间枚举 $O(n^3)$ 枚举价值 $O(m^3)$ 。加起来 $O(n^3m^3)$ 。过得了个寄！你说用四边形不等式优化到 $O(n^2m^3)$ ？开玩笑！？还不是过不了，何况这道题不能用四边形不等式优化。</p><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>不能从 $n$ 入手，就优化 $m$ 。用一个数组 $g_{l,r,v}$ 预处理出 $\max\{dp_{l,r,v_1}\},v \leq v_1 \leq c_M$ 。直接优化成 $O(n^3m)$ 那过这道题就是氢氢忪忪了。</p><h3 id="输出方案"><a href="#输出方案" class="headerlink" title="输出方案"></a>输出方案</h3><p>记录每一种 $[l,r]$ 是从哪一个 $k$ 转移过来的即可。</p><h2 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h2><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">51</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">4001</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,a[MAXM],b[MAXM],c[MAXM],cnt[MAXM],ans;</span><br><span class="line"><span class="type">int</span> dp[MAXN][MAXN][MAXM],g[MAXN][MAXN][MAXM];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;V;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">        <span class="keyword">if</span>(l&lt;=a[i]&amp;&amp;b[i]&lt;=r&amp;&amp;a[i]&lt;=k&amp;&amp;k&lt;=b[i]) ++cnt[c[i]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> num[MAXN][MAXN][MAXM],renum[MAXN][MAXN][MAXM];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPrint</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> id=num[l][r][k];</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=id<span class="number">-1</span>) <span class="built_in">underPrint</span>(l,num[l][r][k]<span class="number">-1</span>,renum[l][id<span class="number">-1</span>][k]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,V[k<span class="number">-1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(id+<span class="number">1</span>&lt;=r) <span class="built_in">underPrint</span>(id+<span class="number">1</span>,r,renum[id+<span class="number">1</span>][r][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;section-dp.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;section-dp.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(a[i]),<span class="built_in">underRead</span>(b[i]),<span class="built_in">underRead</span>(c[i]);</span><br><span class="line">        V.<span class="built_in">push_back</span>(c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>());</span><br><span class="line">    V.<span class="built_in">erase</span>(<span class="built_in">unique</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>()),V.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i) c[i]=<span class="built_in">lower_bound</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>(),c[i])-V.<span class="built_in">begin</span>()+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l=N;l&gt;=<span class="number">1</span>;--l)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> r=l;r&lt;=N;++r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=l,sum;k&lt;=r;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">underInit</span>(l,r,k);</span><br><span class="line">                sum=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=V.<span class="built_in">size</span>();i&gt;=<span class="number">1</span>;--i)</span><br><span class="line">                &#123;</span><br><span class="line">                    sum+=cnt[i];</span><br><span class="line">                    ans=sum*V[i<span class="number">-1</span>]+g[l][k<span class="number">-1</span>][i]+g[k+<span class="number">1</span>][r][i];</span><br><span class="line">                    <span class="keyword">if</span>(ans&gt;dp[l][r][i]||!dp[l][r][i])</span><br><span class="line">                    &#123;</span><br><span class="line">                        dp[l][r][i]=ans;</span><br><span class="line">                        num[l][r][i]=k;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=V.<span class="built_in">size</span>();k&gt;=<span class="number">1</span>;--k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[l][r][k]&gt;g[l][r][k+<span class="number">1</span>]||!g[l][r][k+<span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    g[l][r][k]=dp[l][r][k];</span><br><span class="line">                    renum[l][r][k]=k;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    g[l][r][k]=g[l][r][k+<span class="number">1</span>];</span><br><span class="line">                    renum[l][r][k]=renum[l][r][k+<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,g[<span class="number">1</span>][N][<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">underPrint</span>(<span class="number">1</span>,N,renum[<span class="number">1</span>][N][<span class="number">1</span>]);</span><br><span class="line">    cerr&lt;&lt;endl&lt;&lt;<span class="string">&quot;time:&quot;</span>&lt;&lt;<span class="built_in">clock</span>()&lt;&lt;<span class="string">&quot;ms&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7 5</span></span><br><span class="line"><span class="comment">1 4 7</span></span><br><span class="line"><span class="comment">3 7 13</span></span><br><span class="line"><span class="comment">5 6 20</span></span><br><span class="line"><span class="comment">6 7 1</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 区间dp </tag>
            
            <tag> 离散化 </tag>
            
            <tag> STL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>区间dp</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-of-section/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-of-section/</url>
      
        <content type="html"><![CDATA[<p>“随着方程推进，我对你的爱达到了最优解”</p><span id="more"></span><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>在区间上进行动态规划，从而求解一段区间上的最优解。通过合并小区间递推出大区间的 $dp$ 算法。</p><h2 id="思路-实现"><a href="#思路-实现" class="headerlink" title="思路/实现"></a>思路/实现</h2><p><strong>合并</strong>：即将两个或多个部分进行整合，当然也可以反过来；</p><p><strong>特征</strong>：能将问题分解为能两两合并的形式；</p><p><strong>求解</strong>：对整个问题设最优值，枚举合并点，将问题分解为左右两个部分，最后合并两个部分的最优值得到原问题的最优值。</p><p>一般来说，其转移方程都与：</p><p>$dp_{i,j}=\max\{dp_{i,j},dp_{i,k}+dp_{k,j}+cost_k\},k \in [l,r]$</p><p>类似。注意，此处的 $\max$ 并不一定指数值上的较大值。</p><p>一般来说，能够达到 $O(n^3)$ 复杂度的题都要考虑区间 $dp$ 。对于小部分题而言，能够用<strong>四边形不等式</strong>优化到 $O(n^2)$ 。</p><h3 id="区间dp的三种写法"><a href="#区间dp的三种写法" class="headerlink" title="区间dp的三种写法"></a>区间dp的三种写法</h3><p>都可以证明出是从小区间到大区间。</p><p>$len$ 表示区间长度，$l$ 表示左端点， $r$ 表示右端点。$k$ 为枚举点。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> len=<span class="number">1</span>;len&lt;=n;++len)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>;l&lt;=n-len+<span class="number">1</span>;++l)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> r=l+len<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;=r;++k)</span><br><span class="line">            <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l=n;l&gt;=<span class="number">1</span>;--l)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> r=l;r&lt;=n;++r)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;=r;++k)</span><br><span class="line">            <span class="comment">//do something</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> r=<span class="number">1</span>;r&lt;=n;++r)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l=r;l&gt;=<span class="number">1</span>;--l)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;=r;++k)</span><br><span class="line">            <span class="comment">//do something</span></span><br></pre></td></tr></table></figure><p>没什么太大区别，看自己习惯。</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="Luogu-P1880-NOI1995-石子合并"><a href="#Luogu-P1880-NOI1995-石子合并" class="headerlink" title="Luogu P1880 [NOI1995] 石子合并"></a><a href="https://www.luogu.com.cn/problem/P1880">Luogu P1880 [NOI1995] 石子合并</a></h3><h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><p>给定 $n$ 个数，每次操作将相邻两堆合并。得分为两个数字的和。求最大得分和最小的分。</p><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p><strong>暴力</strong>：</p><p>暴力合并，时间复杂度 $O(n!)$</p><p><strong>区间dp</strong>：</p><p>对于每一个状态 $dp_{i,j}$ 都可由 $dp_{i,k}$ 与 $dp_{k+1,j}$ 转移而来。</p><p>$dp_{i,j}=\max\{dp_{i,j},dp_{i,k}+dp_{k+1,j}\},k \in [i,j]$</p><p>具体过程还需读者自行思考。</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="type">int</span> n,Stone[<span class="number">201</span>];</span><br><span class="line"><span class="type">int</span> StonePrime[<span class="number">201</span>];</span><br><span class="line"><span class="type">int</span> F[<span class="number">201</span>][<span class="number">201</span>],MaxG;</span><br><span class="line"><span class="type">int</span> G[<span class="number">201</span>][<span class="number">201</span>],MinF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Min</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&gt;b?b:a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Max</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&gt;b?a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//freopen(&quot;.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="comment">//freopen(&quot;.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">F[i][i]=<span class="number">0</span>;</span><br><span class="line">G[i][i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">StonePrime[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;Stone[i]);</span><br><span class="line">Stone[i+n]=Stone[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i)</span><br><span class="line">&#123;</span><br><span class="line">StonePrime[i]=Stone[i]+StonePrime[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> p=<span class="number">1</span>;p&lt;n;++p)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=p+i;(i&lt;n*<span class="number">2</span>)&amp;&amp;(j&lt;<span class="number">2</span>*n);++i,j=p+i)</span><br><span class="line">&#123;</span><br><span class="line">F[i][j]=<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=i;k&lt;j;++k)</span><br><span class="line">&#123;</span><br><span class="line">F[i][j]=<span class="built_in">Min</span>(F[i][j],F[i][k]+F[k+<span class="number">1</span>][j]+StonePrime[j]-StonePrime[i<span class="number">-1</span>]);</span><br><span class="line">G[i][j]=<span class="built_in">Max</span>(G[i][j],G[i][k]+G[k+<span class="number">1</span>][j]+StonePrime[j]-StonePrime[i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">MinF=<span class="built_in">Min</span>(MinF,F[i][i+n<span class="number">-1</span>]);</span><br><span class="line">MaxG=<span class="built_in">Max</span>(MaxG,G[i][i+n<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n%d&quot;</span>,MinF,MaxG);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">4 5 9 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="Luogu-P1063-NOIP2006-提高组-能量项链"><a href="#Luogu-P1063-NOIP2006-提高组-能量项链" class="headerlink" title="Luogu P1063 [NOIP2006 提高组] 能量项链"></a><a href="https://www.luogu.com.cn/problem/P1063">Luogu P1063 [NOIP2006 提高组] 能量项链</a></h3><h4 id="转移方程"><a href="#转移方程" class="headerlink" title="转移方程"></a>转移方程</h4><p>$dp_{l,r}=\max\{dp_{l,r},dp{l,k}+dp{k,r}+val_l<em>val_k</em>val_r\},k \in [l,r]$</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="type">int</span> n,Power[<span class="number">201</span>];</span><br><span class="line"><span class="type">int</span> G[<span class="number">201</span>][<span class="number">201</span>],MaxG;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Min</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&gt;b?b:a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Max</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&gt;b?a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//freopen(&quot;.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="comment">//freopen(&quot;.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;Power[i]);</span><br><span class="line">Power[i+n]=Power[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;n*<span class="number">2</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">-1</span>;i-j&lt;n&amp;&amp;j&gt;=<span class="number">1</span>;--j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=j;k&lt;i;++k)</span><br><span class="line">&#123;</span><br><span class="line">G[j][i]=<span class="built_in">Max</span>(G[j][i],G[k+<span class="number">1</span>][i]+G[j][k]+Power[j]*Power[k+<span class="number">1</span>]*Power[i+<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">MaxG=<span class="built_in">Max</span>(MaxG,G[j][i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,MaxG);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">2 3 5 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="其他题目"><a href="#其他题目" class="headerlink" title="其他题目"></a>其他题目</h3><p><a href="https://violeteternal.github.io/Eternity/题解/dcoj2008">DCOJ#.2008蜜雪冰城</a></p><p><a href="">LuoguP1436棋盘分割</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 区间dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4008 [NOI2003]文本编辑器</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/p4008/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/p4008/</url>
      
        <content type="html"><![CDATA[<p>我愿称之为最强 $STL$ ！！！</p><span id="more"></span><script src="/js/mathjax.js"></script><h3 id="Rope"><a href="#Rope" class="headerlink" title="Rope"></a>Rope</h3><p>学习了一种超级强大的 $STL$ ，甚至于很多竞赛禁止使用。</p><blockquote><p>$rope$</p></blockquote><p>非标准 $STL$ ，仅能在 $C++11$ 以后使用。</p><p>需要头文件 <code>#include&lt;ext/rope&gt;</code></p><p>并需要 <code>using namespace __gnu_cxx;</code></p><p>定义为 <code>rope&lt;变量类型&gt;变量名</code> 或 <code>crope 变量名称</code></p><p><code>crope R</code> 其实就是 <code>rope&lt;char&gt;R</code></p><p>结合了<strong>链表</strong>和<strong>数组</strong>各自优点的块状链表。内部结构<strong>可持久化平衡树</strong>套<strong>红黑树</strong>。</p><h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><p><code>push_back(x)</code> : 在末尾添加 $x$  ( $x$ 是 <code>char</code> 类型的)。</p><p><code>insert(pos,x)</code>:在 $pos$ 插入 $x$  ( $x$ 是字符串, $x$ 后面加个 $int$ 参数可以只能 $x$ 中插入几个)。</p><p><code>erase(pos,x)</code>: 从 $pos$ 开始删除 $x$ 个。</p><p><code>replace(pos,x)</code>: 从 $pos$ 开始换成 $x$ ( $x$ 是字符串, $x$ 后面加个 $int$ 参数可以只能 $x$ 中的前几个)。</p><p><code>substr(pos,x)</code>提取 $pos$ 开始 $x$ 个。</p><p><code>copy(pos,len,x)</code>:从 $pos$ 到 $pos+len$ 替换成 $x$ 。</p><p>访问：同数组，用<code>R[x]</code>即可。大部分操作都是 $O(\log n)$ 的复杂度。</p><h2 id="该题"><a href="#该题" class="headerlink" title="该题"></a>该题</h2><p>当用上 $rope$ 后，可持久的紫题没有丝毫威严。</p><p>吸氧过：</p><h3 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,pos;</span><br><span class="line">string Str;</span><br><span class="line">rope&lt;<span class="type">char</span>&gt;R;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;rope.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;rope.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;Str;</span><br><span class="line">        <span class="keyword">if</span>(Str[<span class="number">0</span>]==<span class="string">&#x27;M&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> k;</span><br><span class="line">            <span class="built_in">underRead</span>(k);</span><br><span class="line">            pos=k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Str[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> n;</span><br><span class="line">            <span class="built_in">underRead</span>(n);</span><br><span class="line">            <span class="type">char</span> ch;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">            &#123;</span><br><span class="line">                ch=<span class="built_in">gh</span>();</span><br><span class="line">                <span class="keyword">if</span>(ch&lt;<span class="number">32</span>||ch&gt;<span class="number">126</span>) --i;</span><br><span class="line">                <span class="keyword">else</span> R.<span class="built_in">insert</span>(pos+i,ch);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Str[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> n;</span><br><span class="line">            <span class="built_in">underRead</span>(n);</span><br><span class="line">            R.<span class="built_in">erase</span>(pos,n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Str[<span class="number">0</span>]==<span class="string">&#x27;G&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> n;</span><br><span class="line">            <span class="built_in">underRead</span>(n);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i) cout&lt;&lt;R[pos+i];</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Str[<span class="number">0</span>]==<span class="string">&#x27;P&#x27;</span>) --pos;</span><br><span class="line">        <span class="keyword">else</span> ++pos;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">15</span></span><br><span class="line"><span class="comment">Insert 26</span></span><br><span class="line"><span class="comment">abcdefghijklmnop</span></span><br><span class="line"><span class="comment">qrstuv wxy</span></span><br><span class="line"><span class="comment">Move 15</span></span><br><span class="line"><span class="comment">Delete 11</span></span><br><span class="line"><span class="comment">Move 5</span></span><br><span class="line"><span class="comment">Insert 1</span></span><br><span class="line"><span class="comment">^</span></span><br><span class="line"><span class="comment">Next</span></span><br><span class="line"><span class="comment">Insert 1</span></span><br><span class="line"><span class="comment">_</span></span><br><span class="line"><span class="comment">Next</span></span><br><span class="line"><span class="comment">Next</span></span><br><span class="line"><span class="comment">Insert 4</span></span><br><span class="line"><span class="comment">.\/.</span></span><br><span class="line"><span class="comment">Get 4</span></span><br><span class="line"><span class="comment">Prev</span></span><br><span class="line"><span class="comment">Insert 1</span></span><br><span class="line"><span class="comment">^</span></span><br><span class="line"><span class="comment">Move 0</span></span><br><span class="line"><span class="comment">Get 22</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">Insert 5 opres</span></span><br><span class="line"><span class="comment">Get 3</span></span><br><span class="line"><span class="comment">Next</span></span><br><span class="line"><span class="comment">Next</span></span><br><span class="line"><span class="comment">Get 3</span></span><br><span class="line"><span class="comment">Insert 10 undertales</span></span><br><span class="line"><span class="comment">Move 6</span></span><br><span class="line"><span class="comment">Get 10</span></span><br><span class="line"><span class="comment">Delete 1</span></span><br><span class="line"><span class="comment">Get 9</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 平衡树 </tag>
            
            <tag> 块状链表，块状数组，分块 </tag>
            
            <tag> STL </tag>
            
            <tag> 递归 </tag>
            
            <tag> 可持久化数据结构 </tag>
            
            <tag> rope </tag>
            
            <tag> 可持久化平衡树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P1503 鬼子进村</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/p1503/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/p1503/</url>
      
        <content type="html"><![CDATA[<p>$Splay$</p><span id="more"></span><p>求前驱后继。</p><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,Idx,Vis[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Splay</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> chi[<span class="number">2</span>],fa;</span><br><span class="line">    <span class="type">int</span> size,val;</span><br><span class="line">&#125;Tree[MAXN];</span><br><span class="line"><span class="type">int</span> Root,Qx;</span><br><span class="line"><span class="type">char</span> op;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[x].size=Tree[Tree[x].chi[<span class="number">0</span>]].size+Tree[Tree[x].chi[<span class="number">1</span>]].size+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">    <span class="type">int</span> k=Tree[y].chi[<span class="number">1</span>]==x;</span><br><span class="line">    Tree[z].chi[Tree[z].chi[<span class="number">1</span>]==y]=x;</span><br><span class="line">    Tree[x].fa=z;</span><br><span class="line">    Tree[y].chi[k]=Tree[x].chi[k^<span class="number">1</span>];</span><br><span class="line">    Tree[Tree[x].chi[k^<span class="number">1</span>]].fa=y;</span><br><span class="line">    Tree[x].chi[k^<span class="number">1</span>]=y;</span><br><span class="line">    Tree[y].fa=x;</span><br><span class="line">    <span class="built_in">underPushUp</span>(y);</span><br><span class="line">    <span class="built_in">underPushUp</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Splay</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(Tree[x].fa!=k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">        <span class="keyword">if</span>(z!=k)</span><br><span class="line">            <span class="keyword">if</span>((Tree[y].chi[<span class="number">1</span>]==x)^(Tree[z].chi[<span class="number">1</span>]==y))</span><br><span class="line">                <span class="built_in">underRotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">underRotate</span>(y);</span><br><span class="line">        <span class="built_in">underRotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!k) Root=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInsert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,p;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        p=u;</span><br><span class="line">        u=Tree[u].chi[x&gt;Tree[u].val];</span><br><span class="line">    &#125;</span><br><span class="line">    u=++Idx;</span><br><span class="line">    <span class="keyword">if</span>(p) Tree[p].chi[x&gt;Tree[p].val]=u;</span><br><span class="line">    Tree[u].val=x;</span><br><span class="line">    Tree[u].size=<span class="number">1</span>;</span><br><span class="line">    Tree[u].fa=p;</span><br><span class="line">    <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Root=++Idx;</span><br><span class="line">    Tree[Root].fa=<span class="number">0</span>;</span><br><span class="line">    Tree[Root].val=<span class="number">0</span>;</span><br><span class="line">    Tree[Root].size=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">underInsert</span>(N+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetPre</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,res,v=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        v=u;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].val&lt;x)</span><br><span class="line">        &#123;</span><br><span class="line">            res=u;</span><br><span class="line">            u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(v,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetNxt</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,res,v=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        v=u;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].val&gt;x)</span><br><span class="line">        &#123;</span><br><span class="line">            res=u;</span><br><span class="line">            u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(v,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underErase</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> l=<span class="built_in">underGetPre</span>(x),r=<span class="built_in">underGetNxt</span>(x);</span><br><span class="line">    <span class="built_in">Splay</span>(l,<span class="number">0</span>),<span class="built_in">Splay</span>(r,l);</span><br><span class="line">    Tree[Tree[r].chi[<span class="number">0</span>]].size=<span class="number">0</span>;</span><br><span class="line">    Tree[Tree[r].chi[<span class="number">0</span>]].fa=<span class="number">0</span>;</span><br><span class="line">    Tree[r].chi[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Splay</span>(r,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> top,S[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;splay.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;splay.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="built_in">underInit</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;op;</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">underRead</span>(Qx);</span><br><span class="line">            <span class="built_in">underInsert</span>(Qx);</span><br><span class="line">            S[++top]=Qx;</span><br><span class="line">            Vis[Qx]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vis[S[top]]=<span class="number">0</span>;</span><br><span class="line">            <span class="built_in">underErase</span>(S[top--]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">underRead</span>(Qx);</span><br><span class="line">            <span class="keyword">if</span>(Vis[Qx]) <span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Tree[<span class="built_in">underGetNxt</span>(Qx)].val-Tree[<span class="built_in">underGetPre</span>(Qx)].val<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7 9</span></span><br><span class="line"><span class="comment">D 3</span></span><br><span class="line"><span class="comment">D 6</span></span><br><span class="line"><span class="comment">D 5</span></span><br><span class="line"><span class="comment">Q 4</span></span><br><span class="line"><span class="comment">Q 5</span></span><br><span class="line"><span class="comment">R</span></span><br><span class="line"><span class="comment">Q 4</span></span><br><span class="line"><span class="comment">R</span></span><br><span class="line"><span class="comment">Q 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> Splay </tag>
            
            <tag> Treap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P2073 送花</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/p2073/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/p2073/</url>
      
        <content type="html"><![CDATA[<script src="/js/mathjax.js"></script><p>$STL\ yyds!$</p><span id="more"></span><p>敲了半天的 $Splay$ 无果后索性换 $stl$ ，没想到居然还跑进了最优解！？<del>顺便学了一下 $map$</del></p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">map&lt;ll,ll&gt;M;</span><br><span class="line">ll op,w,c;</span><br><span class="line">ll res,ans;</span><br><span class="line"><span class="comment">/*int M,Idx,op;</span></span><br><span class="line"><span class="comment">struct Val</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int w,c;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">struct Splay</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int chi[2],fa;</span></span><br><span class="line"><span class="comment">    int num,size;</span></span><br><span class="line"><span class="comment">    Val val;</span></span><br><span class="line"><span class="comment">&#125;Tree[MAXN];</span></span><br><span class="line"><span class="comment">int Root;</span></span><br><span class="line"><span class="comment">int Vis[MAXN],ans;</span></span><br><span class="line"><span class="comment">inline void underPushUp(int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    Tree[x].size=Tree[Tree[x].chi[0]].size+Tree[Tree[x].chi[1]].size+Tree[x].num;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underRotate(int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int y=Tree[x].fa,z=Tree[y].fa;</span></span><br><span class="line"><span class="comment">    int k=Tree[y].chi[1]==x;</span></span><br><span class="line"><span class="comment">    Tree[z].chi[Tree[z].chi[1]==y]=x;</span></span><br><span class="line"><span class="comment">    Tree[x].fa=z;</span></span><br><span class="line"><span class="comment">    Tree[y].chi[k]=Tree[x].chi[k^1];</span></span><br><span class="line"><span class="comment">    Tree[Tree[x].chi[k^1]].fa=y;</span></span><br><span class="line"><span class="comment">    Tree[x].chi[k^1]=y;</span></span><br><span class="line"><span class="comment">    Tree[y].fa=x;</span></span><br><span class="line"><span class="comment">    underPushUp(y);</span></span><br><span class="line"><span class="comment">    underPushUp(x);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void Splay(int x,int k)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    while(Tree[x].fa!=k)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        int y=Tree[x].fa,z=Tree[y].fa;</span></span><br><span class="line"><span class="comment">        if(z!=k)</span></span><br><span class="line"><span class="comment">            if((Tree[y].chi[1]==x)^(Tree[z].chi[1]==y))</span></span><br><span class="line"><span class="comment">                underRotate(x);</span></span><br><span class="line"><span class="comment">            else</span></span><br><span class="line"><span class="comment">                underRotate(y);</span></span><br><span class="line"><span class="comment">        underRotate(x);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    if(!k) Root=x;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">bool f;</span></span><br><span class="line"><span class="comment">inline void underInsert(Val x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int u=Root,p;</span></span><br><span class="line"><span class="comment">    while(u)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        if(Tree[u].val.c==x.c)</span></span><br><span class="line"><span class="comment">        &#123;  </span></span><br><span class="line"><span class="comment">            f=1;</span></span><br><span class="line"><span class="comment">            return ;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        p=u;</span></span><br><span class="line"><span class="comment">        u=Tree[u].chi[x.c&gt;Tree[u].val.c];</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    u=++Idx;</span></span><br><span class="line"><span class="comment">    if(p) Tree[p].chi[x.c&gt;Tree[p].val.c]=u;</span></span><br><span class="line"><span class="comment">    Tree[u].val.c=x.c;</span></span><br><span class="line"><span class="comment">    Tree[u].val.w=x.w;</span></span><br><span class="line"><span class="comment">    Tree[u].size=1;</span></span><br><span class="line"><span class="comment">    Tree[u].fa=p;</span></span><br><span class="line"><span class="comment">    Tree[u].num=1;</span></span><br><span class="line"><span class="comment">    Splay(u,0);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underInit()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    Root=++Idx;</span></span><br><span class="line"><span class="comment">    Tree[Root].fa=0;</span></span><br><span class="line"><span class="comment">    Tree[Root].num=1;</span></span><br><span class="line"><span class="comment">    Tree[Root].size=1;</span></span><br><span class="line"><span class="comment">    Tree[Root].val.c=INF;</span></span><br><span class="line"><span class="comment">    Val u;</span></span><br><span class="line"><span class="comment">    u.w=0,u.c=-INF;</span></span><br><span class="line"><span class="comment">    underInsert(u);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline int underGetPre(int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int u=Root,res,v=Root;</span></span><br><span class="line"><span class="comment">    while(u)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        v=u;</span></span><br><span class="line"><span class="comment">        if(Tree[u].val.c&lt;x)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            res=u;</span></span><br><span class="line"><span class="comment">            u=Tree[u].chi[1];</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        else u=Tree[u].chi[0];</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    Splay(v,0);</span></span><br><span class="line"><span class="comment">    return res;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline int underGetNxt(int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int u=Root,res,v=Root;</span></span><br><span class="line"><span class="comment">    while(u)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        v=u;</span></span><br><span class="line"><span class="comment">        if(Tree[u].val.c&gt;x)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            res=u;</span></span><br><span class="line"><span class="comment">            u=Tree[u].chi[0];</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        else u=Tree[u].chi[1];</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    Splay(v,0);</span></span><br><span class="line"><span class="comment">    return res;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underErase(int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int l=underGetPre(x),r=underGetNxt(x);</span></span><br><span class="line"><span class="comment">    Splay(l,0),Splay(r,l);</span></span><br><span class="line"><span class="comment">    Tree[Tree[r].chi[0]].fa=0;</span></span><br><span class="line"><span class="comment">    Tree[r].chi[0]=0;</span></span><br><span class="line"><span class="comment">    Splay(r,0);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;splay.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;splay.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="comment">/*underInit();*/</span></span><br><span class="line">    map&lt;ll,ll&gt;::iterator it;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(op);</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">underRead</span>(w),<span class="built_in">underRead</span>(c);</span><br><span class="line">            <span class="comment">// if(M.count(c)) continue;</span></span><br><span class="line">            M.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(c,w));</span><br><span class="line">            <span class="comment">/*Val Q;</span></span><br><span class="line"><span class="comment">            scanf(&quot;%d%d&quot;,&amp;Q.w,&amp;Q.c);</span></span><br><span class="line"><span class="comment">            f=0;</span></span><br><span class="line"><span class="comment">            underInsert(Q);</span></span><br><span class="line"><span class="comment">            if(f) Vis[Q.c]=Q.w;</span></span><br><span class="line"><span class="comment">            ans+=Q.w;*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>&amp;&amp;!M.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            it=M.<span class="built_in">begin</span>();</span><br><span class="line">            M.<span class="built_in">erase</span>(it);</span><br><span class="line">            <span class="comment">/*int x=underGetPre(INF);</span></span><br><span class="line"><span class="comment">            if(!Vis[Tree[x].val.c]) continue;</span></span><br><span class="line"><span class="comment">            underErase(Tree[x].val.c);</span></span><br><span class="line"><span class="comment">            ans-=Vis[Tree[x].val.c];</span></span><br><span class="line"><span class="comment">            Vis[Tree[x].val.c]=0;*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>&amp;&amp;!M.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            it=M.<span class="built_in">end</span>();</span><br><span class="line">            M.<span class="built_in">erase</span>(--it);</span><br><span class="line">            <span class="comment">/*int x=underGetNxt(-INF);</span></span><br><span class="line"><span class="comment">            if(!Vis[Tree[x].val.c]) continue;</span></span><br><span class="line"><span class="comment">            underErase(Tree[x].val.c);</span></span><br><span class="line"><span class="comment">            ans-=Vis[Tree[x].val.c];</span></span><br><span class="line"><span class="comment">            Vis[Tree[x].val.c]=0;*/</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(map&lt;ll,ll&gt;::iterator i=M.<span class="built_in">begin</span>();i!=M.<span class="built_in">end</span>();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans+=(*i).second;</span><br><span class="line">        res+=(*i).first;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld&quot;</span>,ans,res);</span><br><span class="line">    <span class="comment">/*printf(&quot;%d&quot;,ans);*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1 1 1</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">1 3 3</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 5 2</span></span><br><span class="line"><span class="comment">-1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> Splay </tag>
            
            <tag> STL </tag>
            
            <tag> 单调队列 </tag>
            
            <tag> map </tag>
            
            <tag> set </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>S.H.A.D.O.W</title>
      <link href="/Eternity/Until-The-End/my-junior-high-school-life/"/>
      <url>/Eternity/Until-The-End/my-junior-high-school-life/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c03ccd7e5dd79fd821fbaa60f7d7b0d99f50caa7ef9de424785a1a58ce04eb32">14efcbdfd474efdf0e2e4c1faeb6cebe83378c12d0c7bf6977f3ab38867a6d7d7aa298b916287ea14250181d451aa6bf23a84f7f09995f535488ddd6d3d6aaa0dd3a0ca6e8b001976fa0a56f26f71ac4f7ac8f37c69adcf0610ba983c64b9124aebe5d5986b3fd79eb2f278052ddd56016c9135368a09995628c0b1800384d3b8858764ac2330ef798f611b07e1cde3c70df83862d061e6fcf23d0c7f38758d15988358f295b83e0308e6bd812781f1bc4a8f4eb8e7ac1e099dba2a721308e82b5c8ded715d7fe6b8a1e6754d53d8dd1988b78809c8c7b2dbcd553723abb082a4314da931b7072f1902a58167b34694b950fc9ba5061f699b1cd96c55dbf88470a8728f55b785c9f4d5f4270762e905a0881e5603036665be2afc20ca1865a2e97b3589fe017164aaffead843001f98593494d29e8d5293643c88e6cdc38b2c829076c55e097c1f0c9f952ca716e0d27fdd7bf133952bbbe677b22e20e83a68207b777ef1263fd4d6e2aaed6753f3f7fc9166b1bc47398fb68b271b035a8ca14474966f55409bf738309bb2649ad85ca4d33621dd14deb0d99f6a3f47ac0d97159e00a6f6a8841fd0c632cdc0daaa7f4dc9a7f93ba172dfa21a2faeedb4c662ed8d25748e304b852f3ccead9861687eac68c1cf5fedd3d0913bb55ae323cf877125f36f71453ed494275b305604530e8ed0daba7378adb2fae628913fea9cdefbe8dc7d1a575a0da21cd9a832de8c9599d6b785247c95a3d907df9737233d7da1a75c5c8baeab2d3e6f71f06fb6270c199aa68643eec02a961aea1f620425ec847d26215d162162fbde55fa8a6d95132587e22ee12d54fe9556be69453c2b6981142f346349443fb8da97ff51a13d64959e2697a35c441db5a99485ea9e4cd98f48d99909d449bbf6948b17bd417e7dabb65e9390638ced60adc7e55bc39a111febda4c2a6a5020f6a53d40684b64dc5da80d0d98379900a4fd6908820f12554773ae59154286c8608c3844c22b577583e700b582a894abb524ba325433a3079e9ed985a837238e90e48d94c9884888c58404e6085323fcc438bbc63d2e3bee22977cdf742ace99d2c2d12bddd7d2dc2f2f395acd561d60fc0e0baf5249586f9a13269341f60f8c66dd5ac381ec4413a5510b36ee237e51e1b6802ef52ce702bc65b71bbe5630240befce22bc56032de93110abaa5741a9bf19b0fc1a1980912b8e42a06ba9521227f46f263e990b195281791e1d1b8fbaf848fb9820bc517f38155d5dbf9cfa77fe0181247da6fa9f408fca1667917ca69f843986271491ce09fa867a2af5b963ec850aeeeb140bd6aaa2f1ac91d18fc7ceb15c4bce2d13db49618b5f64c26ca71988ad8000ffe42bb00ca96e9285f4b9e28f85ec1c48ef09ffeca4cf8b0cb691fbfef1462e0c54c2dd9170cdd5ee8d90b6a1b5df1dd52a26fc2e45925d4e318dff429b96fa7297c15d0d9c1428239df3743e503345c9d0c0fa73f9e7c6796f4b2cff88d8f058d5ea6b739e0238e791b348c35194827c7214ef4e131361647918725bdbfcf870e0d2d40bb98eff7d419014c8be1dde32770d56d38f5f85a272aab655a8937ae3a599ea5b494acc710ea4a541b29f1bd0d96e8c8637e595b4d26ec851f3e91c4f44fe24b888ca149b3b1647fb2b67c66dca8eee5cb259dcf1e542babcc7650f416276608b1c2911ffeb56bb8a881446e80b84b742e6ae389cd1fa4ffc6334d670db771dfc76ea5b035d59257d38a275599e6e424d4e50f03c77d572b7f2f37e7307e240319744613a3eb2c5248ae38758e3366d69adc1959c65e5a7e879d670fa8a1807ae01a6fe4ded90cc13af2d6f69d7466e5c3494a7f45bcc8344dfc3d8b6692bbf645594fb62c690866f8b885212f164a8d98f5513b79d973ec9993abb7c94fdaf9ca21312854cf721b7f5e48750ae91fad502ea59d4f83428d696d765518131c49d4f927958a4dbe72ec58e036214ac92e43951d8238ec5df8a5e25027b0fac7b163a102a9bfcb14b7a56e8721b04ad4751ad9cc77b2b7854fcee918f9ac3a92a1bdf8423f9bd3167671091952e56da1e9754d0ed2aab5faf391fc7f5c613173edf002f445a5c58fd2552d6816dc52fa15544fe2455b2a2d8cb974aaff42e4b49c9248b9681b93c07f128b498bc7c49cd647450b6445e691fccf01eba36881c9f0bbbf864b33b5a4445e6881e3c113e997e808e6ac3fc0a860806e4e4efd8a07773dcb0a8f91120c8925564394aae50cce58cbe80627ee31f71e42c3eb9689c4ea89a022b8e3c2c1e00fd01ac5cb41be86e54e12f1ed50226dac53c12473aa56354427a9cced212e11d518eb153dbd9e0ad76f6cdb6042140670b750c76773fe42610458f1415754b66913e332acba4c0b5e9ad0dc3cfcb8590c95c8eca25ecf34105d8920e954119595ae4318cc663d808a34780f43aa9dfd0c2621e6bc8d99ea630b476e0a15009122108e53508e6ef9ba8605e6b45d205ae62960d727c11606dc47f598de6b568614e980d2dd896447e2feedef07ed7346133636e94a88b1a0850371c91898af95d0348b7a3238b94d9aa2c5e4e8362b5af8ddb9d10382fd806dd66a77b4c9c06054c36a1f5b677368be9d28a512dce742357cb6ea9e20c862af660b1722f45d637a9f887a182de9d78092f60ed51804ad59003e6af5ac39615d92054abb44df9e35984e56e53a74e06c4253bfda8612854b134ed610ff7c6b275f1697b572549f91ce35c325825d1dc9ebe47c394ea3562b86eda24151a004270f4364eb5685b31ccf4c45a4c223e2eb998c42e2242cd8c11fedc47596804e48da5ff929863140c288d184c68d9bdb3c0ceca5d8dae77e54d71486bca234392e426a6d8f28d1b1d8e5644550ba8355da436113d648212f3b784f5fdab8429f9492097b0e7dc411304ae778931be3ff67c6a2248333f9c20409b9bb5413799f443b383518b5b34f2deaea19da9dc6b0e8b3558f70f1ae09eb6035a327301674a0a6d9923929c152e53dc390d2b1d79061308fe3a0d0bf520ca66cc723657dd3825ba987bdcc2ece41872c3609174d97d762bfab07efe1c513c67c526829012dc2e21d5904318c19acb3053591eed6e78c4d460b4adfe160385127321d69ef9c6227d67345465bebe93e6872ef32d5cc40ef88e5d3990f9317f967e82f6d13f3b06c7ce176dfda9d35b968fedd06a1e236e345903303f7da1df53090f9969e940d0c304567ab9b6683ec7e222e99f2a040abdafa2d9c970435f763d8014d7ceabd6987fffe20933056e7817310531abd75fae49467a28ae16dc905fa173ef03072334114a261a90e757a879b11bc1239169c01a021c581ca2e78fea6393e3e40aca00dcba76f5c960793f173dcc40ba4682073ab7a7af8425ea61a51d4737152a743b1ee10b480ce9d60a80c43d06a5a772c76f81021acd1d6d4763d0aa8415dd53edc2746f1aba5f0add4b42b43aca6ab5bcb9e36e9be197d1f703f6efa01ebba7972b2cb8020fef65a18ffe9992be35b9f4692c090a5f261128ec184557896216ddb5c3d7f2cc3d93e4b01f1460f6352a4a61730aac905ce4ec834417b30eb33531a51c3bbd67a254ace052188314b7129289b1db5aa9b2e4a3b77573910e87a802c85a044e6f51eaead3de82dd9f0d53e889413887d061ad97e84448e2dd45dcf048bd3c98e197d8e1fd6e6613e2d9586e20ada3748480b518d2a6d727b9d8d43aa66c72b5a8a04089d9fdda80d6afbf0c6475847648d21b81c6e3ef1dce06db338ffaa21e322fd9698c314ac4913941f2b320f11427b11a356a3828409c58ac6befb2292469761e0205627254dfa773f5b9ccf5c1f52f369058a66607bfd8f3a7253158cf7f6e3edfc2e05b9ebc18ba4f9126c7ee2d3cc7603ac513fdad25f37a2afd415090306ba1c07f25792adb6a3545fcd77bdb63c456aa7a79c4485a92a4e39ce35c35e216c8b48fc68437b980d5489590bf6e584bf52c6dd65b251babb88943873fc43aa98b0f66bef6689dfe5574288097213a129af930f09531dcf7e020beef7ba2d74d05430e70163522516bc30878db581aeb990d820f3c01c541b2c6d85ccc32dfc5e79229609ff67dc4bf8ab8b1029af9ba64ad7d10b76822735a28e30476a38776e6465fd44aff94c9d991d3890d85de9ad5df7436f9c42be60db2c13d9aa13ac15bba28566f181649df7fd2233e2f2d53d94b6a2516bf16def4f4c42ab0e14c99ae691c489939a5c93c6407baf357feeeffe70a3d671471b60cfd1bb73e6063374b934d06a8ca6649726bd6719d0e3c579f565c01dcfe868857f5188125c0dbdc1bcee8d44102c5e4148470f44798d74d0ea7896886d033caf255c83379c0b206fc6cff1e7b8a0e2e4823024eb1dcf5d3e82db8862fa0a5fba82f715aa37dcc7c84b1a8b1392d1d7d6bb789eb8940d3626d76369e0f1017bcf5ba151ca44fcbc7f21ab23e327279ce4c80ba9df1a7d314d791bb1818c6b992f2d581365a3d5c870e1e8983d24c706e9e07ef1730bee9833d65bbf99ddbb1ccf9fd9dcad62feefbfc916ad0e15e9c1d7dc95ff89c1b1299ddb2e2b3d040cf42662657b6fffac9f478b0205d023f9c96013faced01ee97630adc981e6976c3669032c683d986e2cc8148dad624c234c6c1fdab40060d12a1529cf20a5cc03d647b34b4a7dee65992da11c8b92b9a1906bd2b130e61fc3b918632bcb89c2b04291fdaa32f47841deed3c168b1a1f0e3011902480d30fd1fb3d2ec948a93502cdb41d395855b445173d2b032ace00eb584786abe91af2a8ef48bd5b96493d0050609f776329e430d6664cccc54788df40fed064bd6ee8467a9b3a4b3c588fce9b76ff9dd3842b157a47f478b245bdc7ff6360056b800382d3dbcbf9b2e7858b8db93dae0fab3086b376c661362f355b24495bc5d60d13fd70d902f74bde011e8d7333ef206a6a9e8797e33a241dca76f1ebfbc76e8cd254402129e8019fa7f28fb35b0bd30a420b3ac386f87a5e0955be2827ab29cbb14033b7e20aa490aa19ce6205003cb3ed6015118eecc7a5392cdc712e9bcbb1b05fcf17566e77a0c2a1f8513f4e7a99d63d98cd2b0708c866213b1fe65d8df0a200f44a478ea7004d4ae6a3f44739dc6cd3070aee2ccb5a3cc94cf08ca33d4a0d252ccc04784dbbfed3e471e45e17291fdf868086d3ec5ba9417c6164c155a5402ad4472f2f676486b10c9406ef1b7fadcb50c25390d704eace48d2afc98f1d1a0e023cf388997b180a58fde2da3f7fdb8cfcf0225d77e5bdc3afd3abd419dbadd33f30bc355097e0050f0ce7d9661a0f57ab09ac681a3e85aab9238dfadf2dd1133e3edd02c9cd33eb617cce3f4c4bcbccf2e50ebff40a0a1c560f2d5f868b56f0d4a8161d76b6136abff05c7c944b09214e1a2b61c892d75171bfb8e55c868870944eeb3d635c4ce67f01595197ff4afe11769c0639ee1ab96bbab8e19e4ee72e28992889537fb8e55b612d954eb3eda33640abe2fdcf4edcd184d5c57f91a01757787a796c7a0b70167de84bd6c287203f1bb6aeb16c9f1579640888a7adafa57bdfab3a84c0860580656a4adfe9bb37f343a9d53c003ec1350c46a261fcdfc778db6013ab3f0925a100484cfd13787775b57dfae15191c91339f03a3176614da0e27939bebc7a7f61632776a25b6f18e7c5bb5c8f24cd56d8c76559e1bdb2540d8b9f728ab8269ebfdc47fc9f6ef527af556413e3442dab394b10ff4230dea5c06eb4710ca8828ede1980dfee5d5700bc8fbfd2c53610c685668942768c1be8b80b13fb18ecd0110646feb45e44fecdfb9f0f46a1a916e142908e2583e5ba4d686abff98f115e2839560e9affe107fce3978d6aa715a98a823a8b0a5b69142057a44bf5ea1e79116957ad492f6963bfb445418c55ff18b508d2bc1eef8803873a26d9f0b245bdfdd6ac61e3c6fbc1231312d56bf1c3a67803457cc703b101ce3a0b5f5c20ce642bb772558a22e7993a3b95cb1b4ccd5ff32576433dbb928951819f15090d3cac5cd11b5b4d42c3a4603decaa59ac408e6e4942b43ab9ec7ab4389a8ce5bcff9eb90d5e57f78b36d6eec18194e3662dec5860f897e5e3900c0f1564ee5a4993d26a15fa8290ea1c9a05742994f5be17b70f81c4e0e31113587b38f245bf8915c5395c89161c74387b6da0d0fb72617a81817fc838448fb9d153efc237fa3ab6664786aa7b0618011013493497dfb111d91c726ba0b43db7ec8c082046851a93a91c1fecf734300e12009d03b78438197bfd3c90b4f598b149fbadaa85d2f1fcfb885a84bad1fda5774db0f557b361aaec19481d7be851984b7705d7d72b3d73f9b3c5498ea95b2d4a6d2a72227bd5ea2f020dfab231807989031b5b7b2cf3d1ca1e4efc608d757069cb26b6709c80b4114e262df4fcd66df4b79164a155b8286fef1fe92ffeebc1b973739f43b3d033ac022b1a2cad65319b9f64d37ff9cd21988d4f1e5700412089a90c1ecd7c14a3c23c88ce394f147af47f485b1ce3c3d5779ebab1ccbfeee825088a07b82f5f96ec9b17289f7ff9fec9238f5171736fe4db8fe03832b1711a17c5cb09764e0e2868eb81bf1ad3c83ffb1db1100d0ed016cc3424a31f920bc221a1e0170eab894f9dbaeb5b1051f2064fa6dc9ad61a476778fbbce6abdea6d861fb3ef6c1d9fd62603fdcd841a9b76e911d8390fa07f714523147a5a0586c78cd9b5b3a64d9491acfebda3b9563a3d9f196983c686a4687549ed44f7d369902f23db4ebf96cb42c5fdd248ab78df2429c06c42055337f3d6aa4dc13e996a95bb78ae15fb33f40e8a014b9b5f03a25bb5fd7e57ea34dfccd626ed789c862d848236ae64f8c6a0e3592065ba40b5fe1af024bd0e0e5cbb2e55636b25d3445bc8c51733b4c7ba85fd42be4b102fb9c2b6adbc3bb6d7d55078149a2056e278583740755a8dd129f95184af42b02e099c3a31e7c92ffa463ef9ce218bf379301fa2add9d0d214d9979b25b15ac498b8c211a6f6f577bfdcd3c8b5732f77ff8778e800a341dfeed96df117600050eee71e776dc3d35cc8f823d616e32148880a08220be69160d49a65fea480bca66e506c5ce8731b686d77267699064e70275e4e480ec12be64b138428fe7a41c51cc8577bcd70a2c0160adfedca1583e788c594a7614451167d93dfcc73a81891cfe90c874563c3e495b448e565117f030d4bd18a6ed0a357c6cf452b7502c8dbf0219c8b04b2a0131b8c1f018ae04478d32f91a993d64c421594f1a044ac55c3482092959c9e9fa836ef8c9f827700b03fa9f0fa3e3922dceb93c7176c306b35398fc72494ef739b62ba148911159fef089def282427a68008009724a08e29b2ef51b82cb9c89b29fe7e4bfd954e5a2aeb929c8767a92a13a04994bcc9245a5f5bd9744d7ecd155ba36d628f69b036b654be95050041f61c497342cd902317f6f5e3e92987f458f0b3a21c0b0085ee1f6a0d20c820c77e3e0f1da451077c5db61b505a8fe584d3529fe6b145fe4c73c68b86c08fad5a6d3d83c9f194d40d2c1d0275699b18728ae52034c98b82d9be4ac7127675c4caf253a7d2625d22ee7a0adff7b03babbb634ae5649a0b5867caad16adc4305fd7943e73cde58b94c1835a561afde09aa75122eebade7131ee652c1887393868e21c0924bf0c5f382b65c895d4341ea398800b9dcff430987eebf933c09edd71f77de9ae466819745ede5af43e9c1b5552a590ec3247c98963d60b75d4ade54d4e39bc4a3e808cfbdfe59cd04d82a9f0ecf644fe7e66f38b227381ffcad6e8d687c8f0132ed3908b31703a0dd34391a785a18f0555125786420bea2486e86e9b271e424e597f879ba8fd0fc88e645dc2bc29cc814edf187007fcb2e837e3d2623b9185cb5a3b3449c894c0eb074db23c2c66a0400c1fd6175311209bf6dcdb1dcb08fd4529338f9e40650ef2b462919db3f9b25c19038ad98fe51cf22a01c70547cf43bfd1f39fabd70edb5b542257ab0186bde77b3ad881a9022d3cee3dae4b3c5613dcd5861344931ab6050e3be1afa3c570e854d5a20e8c7fd7498106690ca77c86f0aeb558057b71a1f566d6a54130569376c86fff4a49a84b4b42f5cba1c613bf27d80a484c341d0c7e6e18d5a384bf06764f65b3c500b56eb916a2eb038abb8cd2f5317a03af08c68c2037abf8420669ed9d36ee78a5d07da35659fd34ef0f05a0457a1ae60ab75b14f5f2fe6923f670684bc42e65f8a513245d5f28412816cc38fdff21381b155a4eec72bb64791ffc2de17b833db95c3a28724e2e799321dfc8f4d0f858ba848467e99ae7f48f797da72cc7198b17499405e25b1e933e4951c20c3f7ddbc5e9992aac3e127c28afce4a0b4989cf89453a17697b78703a3955878967edab2441a5e7c166e5677a86edbbf44ebbee79eef6ee77a599fea1a175d26b6b0acb8038abdc137cbbf9185010eb73a90506533363886b89dfa54e196ad4976a965ca005bc13721cdc16289c16bfe98639d1efeb9b5a0e427c46474bdaae4436a0d8e0a83a436a526b55ee7e24cf92c99a31b20cff2e76505a20b09ac7d35ea16d1c96d4e6426b4404d06ae5df23bec952b5c48593a96f6bf87b7b0dd31af1878e4bf4c765533112f45930f23831a2e30f29a5303f90b8e68b1b853f9a19df243f79eb32ca61da8f527c4ef871eb4897ebda2fe0687eaf010578c9c2676307709e9fe95a8961f621488970b19e1acf5b037b2a96585ae9f11ff17481be104a2f0222e6e5aabba01b710259910d6b6ea43ac5f224d2d27c3a9ed46a99d54f98bbfbb4cb36a21d0955c58de1c4ee9f8bd90a4a4991607fb325f5a6e7313b51a77b93bb5d2d52847ae21f5139912a88dd4a4e878cde6bb5f16d7b8e7b9baa434cf6f8f8f5cb79c5e37e5279b95fd016ed72913aa564496f2f16858cf1a5e3bb67275ba7a3cff2f47d27199cb5fd82ab63ee4a71b6cd1f12b0cd937b1cfaf5075c36fb3405a49dd0bfe27492e47698bb40f3e132f56b12e2cadca756617753b3d72844b21644c4c134d22ee2da631becbacca6ffbd2b09447cfc3e368b68bd49f767f84bc793f847b658316cf5b18a00c0a2af4a1ddd677b996f99206015e732970a532df9d4ca7db8a8c2d9f807ba484bfb94d37b10a38a2883c1fede4422607474b7c55f576c19fc2c5f2e3b9a80a00b155d38b8a0b51ad164ff11f081d78eef3056fe85071794487afeaa38806d08758495ddcd3e72ed5c9e840e6572158b8e9ae5e08e1721691bfd20dfed3b5593478893138f043cb57a3ac628cd79760f738b049ede8867f938f37e433f4ed27409649654a77847e2a53cd6dd2178dd758f8ed1beb9c0837f191fa2ca3684013b1888f018234565a94fd58fbdc8c06af51801c9989ad6e7666a1e6061966eea299b6a4b51a837657db6e0ca06e9152a3e5bfd2ca03485a1f0fdfdb19711e8d106b63b22896ba5e74912d379bd15cde2bdec564dea5c3c3d42a220d14adb0377088899c766d9aeb8b60a33a68cfaad7abaf863283e3cd16baca9dcb8ee3c22e7b268442069025f6dbd05d38c89f86a24af2bb6fd892546c4c977f21812a6994c59311163b450fc14dd669efa6f18e73a999537486c6dea9574b03d9adc6b0f37a51d974cd33b2cc1a366cd209ae85571aeca9c2c7e4c4aa76e98288fcca43e68c610b6293d8b2b6c6fce3caa4b6c2481437664a8e8ae42cd4e9e5dd4bb520eb306aed53419cb2e36dbd70b7eff9f592f4b28d569b443dc25e6b2d38a71d6f38ce0d54eff2560b8bc6e0fa5392f175025a63155a94dd35844bc4ff2bbb52beaef870d9b884d915f18e0cfae5091e6975729daa140df119528bb6b14e5ad7754396141947cef27da1fc2ae6fa660c3be8bb1d466530e039f521ecd48eca5852cc06594012f1083665877b5bca47866b2f51add15ae2e1243e8220aae87e3db77d40545892126c72cc34e95122f0aa4ed30fe8b66b720a4c587ef7afba5dc31890fd50dd5c8e9bed1e02b692fd375031cc08f5e3942821faabbfd53d6a44111941b135d32249295981700965945330bce8b7e176a98c8bf60c848e73c58c373fb317ced9959a591472bb009e434a70ff41608b32b5b94bb455b6ae983ee04c841335b30121f3282d73e2b1aa1d98b13f4adaf5b68ca4e3a34805f12f955bb44b2b49568056fe7c455abfcb51582167b520adab08e6c9ed579501f2e9d2d6ab967a877d89e7b8e02ed96c2cd4212468589cf1d056194fb90a077502d444356cb5a94838e285dde915ff6d3e7b9c26045a02674695bccb9ee16e2b0ee3f73597f8c95bf21ec52dd625e639e4cf53d457917c1af3e688e9fcb541deaa12230e73a0c224a0e84fac0bdf7e6c2d9f8e63f3cfd0b017a83ca552b5b6d5cd64cabc4d31eb4c31e80a7b29ea7f3d07f55b78fe370b71a775886db2dcf2ba4275c13b633189b77dc6f9c14c2eb7ba07efc04bb9019496a8e63bf047e2955bcf95896c127bdc99a6aaca008f35ddb12d9cf8893b738a6012816e27aa2626e4fed4e00ac6cfda67e8db9562069096334c62bcf97ea7fc3e1ff0c7d16ea272844186867619dd921be2d7681517047d2abe76577eb75eec9715e428572a7c0aee074415d37839c06d0efd63d52c6d6e2aa712c693f6d2c863cd6397b5fe936bf6b3159e3da1f27783aa998ba943c482dea5f1c5f29ac92b72c77b48d1ddfb4abf405806b56239ff79055dc2634a791fa06f27643444a80df8b5435a62b0cacc734578e8cac059aad550a8f0222c2f3644a2677353e3240d7c168bd0c3184e2eecced6ee2f7358b3ef55adf2c06392f23b8492bda34f5b198fd50ad53e593aaa2883231525fa7bbc803202da9849da8489107a882b0d1b558beb4a0ea56c067c8dddf78246d874cd28353c1a2a650a67883e6ef00638a5127b0153f3b2fb288e8828928e54d103d8ac48eafcd1383db8ed2950c352255f6f886af894036300413edff404159b317903a22b77dc7e129e921f0d20f96baac7bee81ffdddb5f85d14053e2c3c53f3c21c6ab5bbaf3470e573c59b7348901748daadfc628814201cac35ec82fac78a98e6dcf2e6884b8ebd7b3d196e5f1e7d16c94958ff85e3903eed09f6f762a6ad49aa9440bdb2bf3e51d32e715466c34d8cf279f602d05c6887416eafc6c8cbb66a0eb428158943a7d53a898f9e789c3b08c3f98614092f0a8ab28a56bb74baa3c0368d204295ff308c1c7124401711858aabf25649102da346e0d305d64119d0aff890af896d0352c0b2b4c459d60741de133cf8de76646e98b994a0e586d198759cf786140f4f4f2b39964c59e3b69b29d02d05d7ad5ebc294e58e60fddb46325e9bd8b83f4407ed2935bd3c3a7a0b699d4059ffd8dcc121a3220644c243d2af4b7fa9fa6b3d953f88765b66fbdab398acec6b354f6fe1ae8be575fb192f22d3d44ba716a6bdfe0508596ddc70134a1cc529f67c7b38c7779141130e76609b89c8f6db3fcbc6d5ed6f5854c2ef025daa05465881d9e0450241d69e71189cac7f5f95196d1249af1da12afc2677edc392809a60ee2687486ddd10cd356cad6739ab7387b5cc5971e4fca1eec789a1ce2f7b2bbe111b729d9496bb2e4951cc46777ec21e73394d5fa1a680baa4e883bce5a321b561e2f88183ac250b2a50a90639b96fd9eb7e0c3be982785724188fbf5c5b9f513c76ede60dac5dfefb2c478b535744cfb8ccd6299ef218160035fb998139534adf6585480afca7269178c56ee3317c346650457c0fe80ffc363f1c4aade66e1e2ed919c2739ff03d9ac891362b55b3e3548a575cc7ce0c4100f0176b9b3ae08da4208d0cf6c2d081d38a50a820a5f2b0a0997a22a592a2aa49fdafb97448070952edd7ab80c15de6ab32327cfb260a162a31f89c0b94f70dec96b0a73ae243ffb39b12284c060754d6ba7e1fdb2d59bc548853b84331628c03e643301ddc60f09fbeb32bdd7ff041fc3a85db710f1b0c9eae392740bfd1971e9f0529a7f520f0fb7bb059066dfd7c160dc4ccae6a924a15b2a59c5d5d7d608ac8aebf25a01091acfa6fcc71e75dc7d49324e3dbd11f5a10ce3d20a0cdeac316cdafa3180ca846ae80ab0c1543b1b4541178dd496d616ef210dfd53c74c75f228ce044fbe42910fce4d2b1dd5ffcffe360a8373d8fbb49d79397c6445a0b418dd0bbc3a2ad7487c74de7bfa06060ed199eba307fac857542f33852fd9daeb467a7e2d0f9e22ce2510b44e0917be2f6cd7c7b0b229499631478a2cdb8a2b9f57c5d60024f50776c76da29a88a206f08309ce2ee77be551151c68924faed00e4a11e62b42c5662dbcdf27d15356e8782b302ea6ec76cea600fe09c3b0cacfd75849378f4350d1f065edde48ed32440b1140bdd9b8ca18094afc653aa90dab5b96829b082c5631ebd4b42991f57cc86306d023401ab2d828ede23d81ec3ee8591256caccf89a114dfd3b0bdfc1840718b9da3911d941e41498370b599b40088edd69940830921fede3a6709bcaca12e0bbf4080a30c04e5831c61ab69b8329cd21e9c718330a01ac45187b1a4e31adce98ffa01ae59993e6819ec2a810485a5c21075725487853ca3dbc29113eb1c085bbdd6afbc6109513f50b88bcb75a8d5b8606377077c8d1052e7fb9d5af0f25b709db58d30ef6fcb8dd9fa29c99bfb9e8f90dfa9bafbc9fef0b4125d8635fab44007ea6b061d840ed311ecf5f4eb4af7a51062f2b893dd9197bf71e13a161cee370f711b49cf2cbbd8b41db3a77cee32d5ab20119c8069d646475daae37a76fa29ce7764f26bf37bafa78bfa2d67ab20d38ae18aa760b6620f2ddfc8b6b9faeb517c0a93ec54cfb5b785f34bbfca60da75d061b50bd30be8d9b9bb4287b0e2e6dabad385b6f79a62cc5d164ca632075bfa40db07a16c8c6e7d71fd3631275e3183ef4232032cf47a2a60dfce47a7183d192ece028dfb5b7b63f753c937bc8ffd40766a5d721731d1d8c0920f0ee1950abd870f68a878ac9e8233f77a215a3c6f6c05576faa69300727fd0fe31744024ea8cfba9d9da271ce1a3212f41fbcc1c903a0ae9e627dcd1a72b80f8b978e7eea8d927abd88f3a611e7d1071e3dd89b3bcd79e14a2312d91b9d1360196a7de014d28ae0dd0b3ec5c8660053156fb2be57f317fec6c55b930f2d22dcbf94a0f5cd0d9922f39da44120768d1bb9f55e42cdc56b517313b23339db2f4fc08f42d6b53887d37ab64b0c82876cdbaca8fcc42574bad9880f082a0b06d4577a48ec5988db634b7a664bd539b534f20525c01f0ce239732bb6013011bd153eb2576da3ecac9e28c92a421916c7e042ede063128d5ac2ee3fccbd864d72dd05fb5737d95ee44c025957272ba9303dc53ed38fb58f814c6ed8cb221baa8b3288f5daf8faf7835bfee64403ee35c3a475ff8455355229dbd80fc7c4cad943fc16b4600dcf2493017609d593b44e240cc5a9de79c74531619809e48eb681d602a90788b1689e753ae6c589c4f0f7fbbed700d25ada349966db71e39e4e72dc4fa2d2720840077013d960fc5aa97f692c957666e4c39898c2873378568e7533b8aa27b7948937c19056dadda70b158155c765a9de8b6028d08fad53f036f85c65a1014446739267ce005324f6c5d71b5ef972a5c0cb23224c284703cb8c871f7400cbd586911382522b0245dbb972122b2b6dfc51a3fb7fa7ddbbb9d4098b236bc27b66c090775fbbe8facd65d02d3bd869c8d8030f844e3ec0d2cfc3c63592e6e02ff62ee523b30db41d24644e35f700af9943176d0132149080cb38d52dc91a34f51d913826dda52f455b7f5fd6ced71bbff176e1519d89966b6e1dabcca93a2609976dfddb2fbba99544baaf9a3379b046bef440c8a2c5e2d26c0c07de531180e39af03b2a4271afb269ecbf931985a54eedb42496386b62a4bc28b052ecec0f8c40ef51f2652ae8cc98c8f3234e54cfb88d0b79b7d9f799d9f48cd25593460bb8a6286565d373afbdf7674852a47b9c7bed6a332cc5c2344c8a9dc362a250a9f14eba7a6d946a61b4fd7082f05d2f5acc3222107584cfd49e0d9aefc979d82db58940c2a32b9443e2f9686a3194c0e270ada2270e4d2a7b3d2cb7e3ff5f104ea1bce62d7ecb9d193c2ea8d10c8b86db1e9abee8333458f85562e5aab6297780e5eaa269409469cbacc6fd1b71184047222ee39efdbb0eadaca508693812097d757b34dc434c10cbe3b4d497b7fcebe36a9197d5a6064863307119a786cb3bb649c38316b799cd2f4db77d66dfa229592752f8ec3190f621f60eb88bd0a980981f0436954b4d25619524cab4a453440c17a6736e51505604f96cdf82d7fae200af04a62c3192ba85c2091c36d7b036d0cb8407c3fdb43f9f2b5d5c76a8e1d3931b72586c6ccb6c9ddc06342e95dcda05b2b2b3164bb0fba7457daba59c84c12d9ecda1615f83b0f5a90ed1cf552fdf1e8a2e17d37a11056cccbbd878e3ee5ee33cbe0fc66aa5e5d49318ae963c4ca2a8484eff3e2e584415a8383576f730535696899fe268c644d3bb5c482504083fd3669578d818104b4cedcce6d8ebd40208dbbb3d482b3f3986fde81b4f4ca207d167de27de5a51420bf22029c0b168a04ef41e20495342c1743997ae27e1ca0f796cc348b825c7d9db51640e6eb11590e6000a2ff4d5e8229da6e1bdc802dea46f204fc662585325b14d78b6ee10ac95fe669bd2d0c36d3d1248c2388f4c76d6c0672064d0179dbb7e23378b7cc278d6c4fd79ce047d57e0da8d8f498336b11b388c151bb9e060b82fa2532964aa521a665ff861f19123515a98a14eac9010e8846bf49cbda3f319b96478ec197a22b0bab5ea5a70a26c26da28e103fcced3ce3f02634ca0586e2ee23dbffea7922a29e92a585bdd0ddc246b0d0627b79224596ad81cbe112463627371f14e3f65fedbe386a66e4255688b52f3d3f8d56eb8f3cc70b824cde9d0b1dd6f8629b7c6610bcda464d6082807688f39c7ed568371b56f11658143efeccf6779cde9fefe1a4cea3c0f04b18c071e6cd0a680419758d521bc1d6d1a6f5c53bc16e1706ff041631603c92d74e3ed955844339cc27cf4626b8db6b2296f1ee22e7db6fb65619e81e7cff7e0824ed796a27ae844518d69d255f760a8ca7f05dccdd068405dd098be976f41c2458d5e44137eddcc734abd362e915ff954315b9b849c329beac6a4f74dfd9827cfdc2180f503f5defe82558ee0983a8d8757ba58e54df73aafeb3abdf824d9495783f9f11e31bda4a7e964d2bad324bac1e956a080ff54b2fd4066a770cb7d47d46ef78be4939066ca79dca0b08086ab9e270d0221c6e0a6454c7d1d2f2d360ca865a8d9c8d63c887c96a26ffa1cfb4cf11c9f8e8f97fe551852262f34d8733c677466436c72ebe2cce24a6ff811f93c978de498cdbfc03e93dc72b95489ca11a25192a9dc1f41e208670196e0ea8687d9516f077d1cf171aabf01d6d6a8b8f72344bedf389dd97d78e8757ddc2340a24afcd068c647f91949d35193e145e64cedbe6430025b73e8a4a5cc5366b534dc1470f07cfcb02d1bdd82e0d95c9cfff103858695a3b216d5b78c68e53c8c630970bbfcd0249541fe1e054e941b26d6036fef950f483707fd198147c1daf626005343c0003cdab050d706daab361b5f4a1d8a7eb272a0d9dfca6c5463fddcdda554bcd6b6750580f883bd1cdcf9d01cc0397e67277a24dc311d0c667d1a6996daf581ac5f45c7d1fe7ff1ebf8546ae6e32af973b581660dd9e2280f8bbc50238a5b0b4d095ea9454917798ce297896618fda33e0340fbff605ff649c6dd5e5f401e1612d5211e73fea978bc3aacfe61f5a3725dd52b8e7185e8e7bf35566cacbd6b955de5d5d78f63006acad3ab1221b543d028577f583408a7c7dd99cd56d01ebdedcb16b78a2ad34efc66a9d3631f8408d979c990dd96174cec16e55b3788012d4c7c23ff9b1b04fa591e494016d851475a9d96fe1b896a696e193f1952845c771b7ef483b55186a2a8b7261c9e936112bd51e4611afdea1e99537a5684dc3f2a9fcf761723fa49f9d522ea4d85de0649f3779726f110b97d54316efad7a1277cbe438023118e7d704736a4d09cb1455fb8a5e2bb62fe13b0e4999104d749c984099bc612bcde484cc49d20b4250141b1ee00d46f1675b0a77221497a5c366371c68af7ab0baefa9d4148dd41a84f7e41db90ec202eda1e5b88929392453431c88717457b4e172a785d6e883e405d538a4a7f5e1172a95e79ff7db8f0c10949ad2f5d20bdddd330808ee5b0001d8e2be67cd8a8960dbbba9951b176ff5ccc34ef5243c202766975971b1b6553b70ed0b4f6f47e885de39f53480c36bba6d5acbf9ef30532f1027196495f95b385e3ce323d018840915caba2bf31bbbfd546df436cc55c8a53f88aa28c673f9f6162551081c9b5675c8e3de82a7f92f9063a13803839b2ad6520a0c64fc0a6baab4d503ed5142a96db50aa855d74018a19f96e72ba232dcbc7760272f048de9dae59833ace06b47c113402a233504d2f2d59422904e9ee7fcfc8813677aabc272b6edfc5a887324133f3442795e0d9ecd19cff459dba68ca0518a7eceb29c3218708879b413b58bba32363a41575716fa563c4839ba81b5c173907df3c5a6f7e42722508ab9675e816e577c25088e4a65f8dcccc8f995d388ad8083df3d1da8be095298e2185e48c14ad622825fcf345302027e841e88fd71c1736da7f065de111bf4b28e38bcec8402aacfeb9a8e07a4149933a656861cdb2a9ca41c3b4662d1e4f6035b3e5da860e61b01fa09c72179491051543d5fd656fdbd7115b411277511ce8463faa6f91a71ea0b16f162a6d315cf3d683ba7c29eb039945dc18ed190ed52c721f9a55cf86aa937f8f91eda4f1202fbb71c1db068935e3ecbffdee1a9f27fadcea762c6cce88d824774e42f2f046afc84575a5221ab9651d13701ee1da1de84c72d8e8feb97f75ea8978d5000630b1c990900d10ec3cb74d437a0a8933010dbbbdd50a31a663c0feb21441b58e0249bd4dadd18cfc7c53d813263b3bb2933e3fb3a7db5f607e30f977cf48b0307177fa2736904ae8ee9d4c00c0be74ad667fa73fbdd97510db8e3e11d5e0694dc4e03a9903f2140a76e059c20d909a177e01dbea3b69ba66894bb402463aaec7cdc22d23769a30a887c25a6697893f42b7b24a0fc152b0a7c4d98d31713c58a7e94ca00d191452fe9c59c6d53295ea93e444066310351f053055189b78187e821e588daa233724fa5da4f6ecde6bdf7b40ff1b982dfcba101d267926cd6fbe47ba4f90e7f5475c69c552d6e15a952fc574928cb9018953f7d4017f30c57b17fa5841ee1b540c23a46bbd8d61c2a54596121b7caede735b0015390752f85d5e2c8c3aec7df8007bbfc6ad684db388058dcfd79df3c4c0feea6f7d2439b438bfa627ed97644e6ed2527bb475e6513d3cc5657852046b0484daabd2235cbaf09a14c13194c4e6babb2d1455d30991b8f73bb099daa4d51b4c2edfbe8590f17cd7654985f015e969a401863683232c552b5cf751c08cb93854a0fb0d21f271551a30a6d24141edb16fccdf011200aa553614bf2a80f431fb12105c50436813dfedada3f4e9d721e7cae79ad8d1b25372ed686a39d08a1caf7fe37bd39f1141dda3ed717321ae509a485430ed007075b3e800e42d2b896ca19a45ff22579aa00f3ea14691136260bffd18de583d0b39c90c026981dd302f1001c9d744e6f215a7a4508b02c12654c6bdb31880b577e41af3b7764b0893e69dcc119af8e76388773d8bf2733f227dff58a11e542bf3e6013ffcf2b841110ba39f3902f64cc0862b6a134f92731a38f62ae15e7b09b67be3fac12cee33cc1949863eb8b15cc430da65b02a42d99e7609b9493fed1d901cf5f58dbc50238a806689eb8d662ac025aaf34a983692c2f952e214106ff0ec0d35ae42bd7fd49f979f1ec34f680655c92e4aa47eb954275411c6d8b2352562b2cba6b16ca6c93ee9ce132e360408b4ef41be89170d9e5d94a04cc6bc19afe34cf056b27adc9e0c78fcefffe71c1e28f6a100eff623de0aae94db94f3743803b72b03f6705c19c5188ac25e21a4df768b1421ce4358e25af3006fbaac8025aa2bde5532ac6be5745716e731e442154ecb7b13968fa952f04aca6ab2c17082d4ddd20e88a6888814899e89bb1a402a323079dae27e26d9961defc54304df350c2318000ac23e7f1559eb47c5cdf0c3245c7ac75153eedaebc953b7a8a040e24a6d0c7743c4c520dc23ace4eb8a46f8d8a4e744e5d7f89ceb1ca009ec885b43ca1881b1e13a9f0c89511dcd26f961685169300ba56b1f5ddb9e79a2c5c8e3462e9b508a3cd737768ee1cd2a6407d0c34f20be5e7b3ceef4eed1115de83499e593b2a7c9ddfb9002e46d525840d4e90d8d582511288e99eee31296d79b05e050aa9d9c4f7a4c5844500f74014354817bc630d9042fd93afdb8fc84f93162a8415d4c35df38345a7c41d927ef7d5f77e274882059d806f89953dfe2cad5ce4142ed55942d4cd5ffe51b4b31fda09d3b05dbccd2946648cae93c681b88f1d5f6804e9a75170eb39d4b2dc19b6f2fea9465915796a06e9948198b1fbc4bb204b6ef7a7838b7d2af191c424b059ca849aad3b9daf52b962bd9997e40571a64c8bea9bb21377c25b29eef66f6a016a397ebc0818770a262a24b917f53f56434477a6f7c079b8f8c38f5abfc294ca011f40c90aecd7311714c3ab45cb93c5af8c31325ad30ea59241b7af9188aa488377be7c6691bc305005d9875b3f6c612514b456e2cc1ed59dbe0d9e720b7be22ddbf494b70247a367cb111e0e9fa6b70c3f462f491ff967c02ae26e57601131b1d8f5e08ba35a492e1f046a8e406526288c10e0d54ea833322ca4edac0884951fbc651c991d7129fb8b79622a22f78808497c6b37e99e1ff111adbfccfcadd9b713c96a702d40a78691fa58bfb05abfc8548e62b59fbc7dc3b8d8bbe6d9d60a32fabe7746a607b347d8b9e099feabdbb8e98217bb97dbac2a1322f40912d180e4a5be80fe2d2ef68142ce567266db238085825a9efe4006f66e59a9dce37a62e7caf0b661e31f4218ddd5566b052b063bc7e59829ced5ed38565750846ecccfb8623c2938a18d85c7014658d84031df17830ea43f7414bcd68fb8ca3af999f0de2e272cc7ac351710b29432abe2efec7202eb97cc176911408468b4ac045bae2948f83174d49a34a3bac5c0f4b453e959d5b6b2aabbbeb0274a255caacc5b4c60410cc2ea9eae08c12f3e4012a0f1f7c077636ca643a519fc75866a55325ca6f0793123f0de5fe23bdfc3577234e71b301f6ea177208335c85291a0d0b5d7b2f4b94be596a6c3f39c4fd005f8aea9d9cddb87be2aef12957f1cc52b17e79400027a02e4e8d1ce02ae3abf83812fb51ece892500852dc2c20d7701557501bca86663ea335f3aaf8ca0a4f4cdcc7a5b0fdf1d3fe59044926704e62ab5e3beadec4908cd752468a286c3f4c854a9f9e50897df2d901a3a61d805e78bd01f6d337476d17a053e5a72c9416ad127f1994159b9a4636787e00608cf3557a0e07870d34dcb93067afd4d008069045a8d0599a3a428cf654468cc0548b26803927f777aec2e70e3e3557d85da889dfabefdb9cf81b2291b4d0be636300936d00573382c593123a53062433323c7e263865ac0b10136a569c7ca851dda6b8f6c34eec2e9f1e34b17aea920f498655404ff06e9447e53cae13572259d06b9a96646fd2987d2929f78d808ca582c3f4c4f088b0fb63a88b0ddb395de5c84858107cb27cddf324b365fd4f90e07a704b4e1794624f271594bac06f2ebf9196a84b50cb397a5516710661e76c69baf18a12091e479fc46884fdcf1aeec05a162cabdf8a8ce52d940e69cb2d055eb7e19c9e7c9a9f76b9be3f4265c1394d889ac11f86d2159fb8b36232a3adaa7959288acb21cc8a3be4482bacbbe336f80b882885042ca9614d9feaf1253c0c0fad4c5ef2d420ef89ac72f62633c8eb1d7faa4d4a5f506f01c8c2aa820338f6227e1d68e086795a5f9fa47632d0b4bb22002b36ffc9a62b3748374189fc091296aeebcbd90f080f6fb0764d12a5be742bd570fc39aaf41a5c2af6716d678971802f430804699a8a4c5752f84c7981615de235ae49ec0035bb794734a37a22fe86839480c2310f299bdab24a40e75184af589cc4ba5129a177eaf772afafc73612480e756b12153395b7621bdcc0a710b3e058bc22625354c90173eba9bd31d97467c18468c37261254feaa996ba79945d506c4e6787361a689a0c94c123f6867b3d35b1c791401e36c90bd12eb481e8bef7f57c4c7c6a5291412218ffb68c8fbcb85400fe5b58aae5ebc28f98d846f9532722987c24f69fd3fc43a055369ae6f6a4faf8be2f4b8af28468a9c2ecc4287ed2946a0c0467c0c62cea53a1bc2a4b32217ced6ae0221810fd711596f4bf1adc9867457c1ad24eb82f68a180e135f25e4d7c86662c0c09a6a2fb28218494d101c09b766dea0fa3d7349a02bed4eafb80273f8cf3dca315411f6ad3273d663feabf95142be836279fa399af960b247968ceea4e30db95fcc0f2ea4b31b8fa283720cce4e1e1a58cbda971166cb5e701bf5799c813e07a85bfdad0e4fd3d9acf820ba745f61b69fb7a25172230e6191131de38c9c1b45b3f1214682fb869f21dd4aa620ff1e8ba8a1cf1381491cb534c022b89dfa22e875a159150dd09beeb49d60947150317ec925deb45d3718cd823e039343cb4ccfaf966bcca065394cf7fc8ed839c0159e7fb701e9fb37384d4ab7ec8221204d612bc196064f02853b9024316c710e1c5946949c14e919a6e8865a6e5825af0850127184d8bb9a9fd8b3e71519375a040965807ba503d7d627dbb2cc29d63f2ae559f12b22141b20513fa87ed3e75a6f5f3d26ede652092e14ff2e316256e1274c748eb9b4f3ae0a8b66d40fa3c17bbea69f573ad333b8740e5220f75ac21321bdc0aab3c1fa2711cad372e06648a77193848816fcc027c15c11a15f809f58d699e5884dd4fd75c578b4adc548f437a7447e2d0db36ea51109bbba827d230e77812e7745527888007ac9d0b8d45df9e538705de8cdc4912acade2455dc85a63eaa351d0d26ccc4dc7b1aab1239c8307be028d778eee6e5a7d3bee539567e2d514f02ced502228f048ffc9f1c1b4f7d3618b044c4bf87956aafe593ddbd397922b6ef3f1ea677327bcf56b88bb97edb65c73960db45d7177418192f68944459e423238a8e44e3bf0b3f2516b4a324d73e188092629bb976b45c499bde83597063a5c3bb4ac8a7f5b6044c99f0623028c6f7ac21ffe9a8e77b4762b0ea1ee1682f78aa870e0afb684d81f0e721b3fed18e0e564c5a66266de00d56e3e441a042d9a25288ae2f7dbe642b566a9f84290479c92e57fad00f655dda1dda0e397228eaea26cecc13f59589bc42302395c4b9375f68b85e1939ade03a06c46ae47fb3251c019a701385a2b7f1eebefaa3849d2f99d6d8991831548d87d384fb8a7eaa7d7a04397c64e95bcb171266f5f24bbbfce104095a637bfd652f32617631a30810c80bddbbdab1f8d6260f958693f33d784f03ce47eaf5e82205c56509001077a0939c2f0f13005413b6c3e13eb64704db44634e3705457503d958138296cac24642d372c62220c19d0e48113791956d058852e0bdd932d61cbfdb63ce93ca2022d77e4b5efe1ba76b317e27cf2581fe0699915a0676e02b7c8836711fbbce3bb6ee16395a0420ffc338d6befe68eac6349fbf2b87618e320ecfbf452017b2845bbe6200f825aa42183401f259c2c04358bcac3c00c347a8007cf213c74c3e79d61505a44e85e201f2700e5c4a30443846b578b9d0c840cfb0dc8b9dc1de42cafab1bced125b8d46ee40f6092c7a827c337920392913c6e5f828a196860dbf6d467110bd3012d6fb017e12d0da982e77ba190a6e83b39b7757758609806a48759b91aaeb9753a65a047523c4bc33f8434da81bfbc89afb36dc873263fc3b9b227125d1ed3f5eaa451d273d642f5937f9edc1a324bc9f1ce2ea2bed25eab7210eeb28a912b904b052d492d1f648484e68935681c7524a8e98ea407662bb16c744d1a9146a50adbfb18607f254dab470fee05471669071ce6c3394219e4e6c059691752f91bf544f2b338ed16053e7ec94408cdd271fdea14080b6c926f33eece4bccb85ed0b7f988c644f4e498f9b28320b86342a795bd5bf1705fb0a65ba2df093c83243d7d0ab5b4529bb8b02813f2fae2ca3943afd603b6bfaa86b5db9b10d15bfbce27e962a5dee4048641690fd47132c90faf5c399dbde848f15890ceb37ff5afe2d7127392e6e98524e14fb5da27d10112e6b61bc0a3f4a4bf2d7976a5e5a48a4bceaa57c8136014aa760174bbc3a467c909eac618c5c53f2ca18fbd83c9cc6b21655912a93550926609e0174874fa1d274263cd918f8939ada99876d104d49879a144b018c0e95bf8c9194f41b37520ce700f9f5df664f697c3b205af247538e4d0530aef6c897c0f57fc74b53922da833d4259b5a7bf04975f951e7cbb66770c3ac6c644bb6dd9c594217ea1ba83c07567f74d9dfe93efca4047906c4d28a86303179f31502c6ea21939b5f473673a8c2a8982aa3231c3cdc9afceab31486b58b7d04c2e8dfdb33702c80d071107c5f6adab5016cd93184e30ffb3e57822c5bc78c15f33287b2ff0f969cb99e3733c6bc2353c03fb71977f9af9c0d0290bf6af9d6f576ab56ef2723872a3a8fa36be4af3a2be1cd41d104e8041b4a303cda24e3ebb3c7dd389738dd37a12ea8052d33fc389f91afa680267894da596a8af88a836a3dc1f5a9443edbef394f8925cafd19963a12e1e8b2cc2ce80bb9e96d6f505195c85bedc86d5a5b90b26102826b411fc89a3d8c461ad00c55a4c56d7ed2ad8a1f8e66ba000a41f68c2ca0d8d26396439cbb0c32da046d78d34b1e1bf0c939ce38be5221a4fac2dc5caff06368c7f7cd53a0353294afc0392e017177bb4c67b9ed9b95e328595fc80f3cae5ddaa751e9130ee4e36f403b8d68aaf37eba2f4ae179c8c2b07d36ebc569130d729530fd71a0ca1e986ce36495ab79c3d7cab3842ca456b730f2b439121bba7ab3276c3e95d5b2994f996436e442e7ee3c53f6b572e10209be3b808741ddda54361d18be446f7f69ced583867faf1c77c6180e46aeaa00347ed49dac858d1144e2353af56c2e2765034ff43211739c96248affc13726bdd7d565378605b765e4f25fea4aaecafbbb64c7109c0c7b45340e7802eef91ac82cc7d36bb510b8424e729166ea84f94ca68122d66a012ccf51133eeb6a286889d0bd152b07543b3ef1d7cf5b164b008703866320e253c340b21bc3d0b6c697ae91af7db47805fab3ce484f92f03416573d9389d10dc4efc2e8e447bb9b80929d90d2d88b67828f21db2605fbc01d54ca76f76a0d667fc4a2ef6b16c5f8bca356224abc95d232b5779975fd8d679c61c064c6d2e69dae1bd2536ac37a41362a6d9a158a7b7e4a3dcb218fdaa4eacd53c24aeb176f170f03edd563d89c67ee9bbf4c690935bfe1e6a53b3f1d742725e873ad0e8245214f9fde0e952fb5b06179bacbd5c7f0947838745d64ec57a2c6281e941a5c816d790cbc33e7802631948f050407a0016f2ee3f9596ff33c43d96a8cd10ed02beed4070a7ad24b7bba53bd0b56266aabf03044f0c418cffb43751563a0a54d58b05cd25bdca8642e923c0f68bf53070b4428cbd8b6d289a366b6a6e5db362eadae34587452b31a6b0c077bd6ac60fe7499e20a8b59fc4097cd6cb7abe52c96620fff48d6c745b45f6789df70cad39ed17790b69275c5d87c2d61e95c9c2d362a5b59b315d2f54801822a96dff86445d0ddd5a1c0fe80a36a1de1272fe8b93d47d1890193cdf26fe2b3ac9fac0bd42cae3ead8b5ead11a484463870d2a7d249dc324cb976296bbec02c6211707d3292b94ba64d8aa212d5808244fb852df881479411bbd4248db6ce7ba9357186dc27ff5fb973ff18dd5b7ac2f4a16b49beb385930c9c6d2773500e42dbafda1f01ce4ed78ccd852f9b381c4be1364df5a754c5020c89d00099e0fa529c143bf08b3aca67ff6f67b92c7372c4c5864c0a96949dbd9617cadf7b1b9329b7325b993a587d805adbffa859a8c69f277f6c50ceb07241ecb6cc1238ff045a04e6a9717186019f24736caa20ab93d10e0c5094bce94cae59590baaeadfe5e10437a927c7c59b25e1c62cc88cd4535e7cc390f2c48fe6a66c5f473ad0077e25e97ca5ea8de37505fee343fa2efdc6f32ce9820fa37f6bdae52a4ce66c08e6cda146775204868dbce6d74d0908c8ccb2e80ff31aad911ba2aff3236d029dedb28084c60578214a8a3dd2386c43c0833bbfb81adb22098ae361d36cda9b48a2bc866504f5c3dfccce8517a6a1edbd57a5dcc5239ce80c9254e6560c64e8bb9b8e31cd0554d3cfb46aa5551317ed4a62f1a679b1b7b3a4b70164cef7c28aabeb0b03b9fceefdaf5946baf06f8440605ac80ec77300ce1fc8a9b07109c0f35104969f1874153ca8d9a973c0072770080580aef5bec747136db3364efd27891d25df38e348fe9284f79897b51201c7c3189a31888bfd861f8835b98ee5ec7c8c96085c02018095a64b2ea330a988dfca7a96e544b7c86f6d82381d2b3eff13e6ded32e63c6672d3e7c1c4cb68d99e39f902b105409903e01d3f53ec96b471e649f9ea43d7b953439697633bb4582b29e7c5954519b37a9b9d0812baba098e75909fe11a6c3e3a109f589d28da2b3656797c38502ebe31b0aecc306ece752905153320f80ba9f8c90b4bf9b381b9be6a88d3bf530021d6ab95b7dab3e916a2c8a340abea9c368c9b099cc63258f441a4b9d8817b11928c0c0bd03acc2bde5388666e2f8af4cb8044d4aafab73713846be15bdf1bca2871daedf629b38475553d70d7db6b47748733f784558a1b8648eeb6323d24b74f59d9b71a69c820b2b1c5ebd5cea419a78f74e8dfc797b5ff912f15eb706b80512562ae6da759d31a40883531cabcf1e42a08b63a9091ce9ac4729358ac84feae3c29a47fa93917a7f5b099486735086fce41cf98e3ddbfc33e5a5338a29aa7e3acab053dd44c0bfa874c49831b794550fead4349fc59d717e3a8d6b1bf7ac1901f9a55df86ee2ce8eb78e3ac6503cb99567b635ee32457261d5b6255912936c7b6a3f3ee42a4e151a542e1e63123eeea0b0ef4a1f22898b9e466407dc1e002dd78940d710fc37f19075c6b90d366a3d88b80d54c059921b1d7a24f3f398b7026c0348684948ad315c67ea562f7fec8b169e2829d13d1bfe7d7cb527f5dd8e00b066866a33dd7977ab290ffab966df3c246f02d3057491386ad24e02367fb420079e215eaf0127638512e6877bf1eb664090eb78b1f84e6e94fcaa7e895441365768c99c452ab213cb9d1f22f6382ba18d5774e197c770777a058a2ffec7494c283494939fd005e98e7f2006307c178bab5fd0243635c275ec2aae40b199572e905f0da74834ee24efe59530f0296c3e57cc3b3056d389e09644ffd8fb5a657524109ac4a8fe115d61f638d2c9ab2df9c1a8b8038801be64918c6f70b18717cb4f2232205d3ddbf14a670f51c6d8d64411ffa5223be9d73ff24eaaee6c462aeb44038aff0b1cc4aa93791a385538ab776efe89f0c15eb167f2ff7254374161ddc1d9ac3a8bf0135a452503ca5972d06b34c830079e997356cb40576fcbca774cf5c4dcafd825cdf9b20953e06845cf59aebbcd2d0621df7a6b9cd7ab1c8af75bc912113cf963bd617862a697d943ebf0b2c198f9269eafe7f2feb678533c8464ca7644d35150c80587831c4e3c2c634044bc5534e3b63d78984f8091724ba3a1c735a8d5bc5518adbba38cfb2fb1e9dbc0bd700391143b0bdac3569a6259b7d9bdee4330775e79104bc2683acf38136e24b8e085e5b149f97dbc21cf47bab903d6777d8eb7da59927cfcab173e6df4c2f18291ddeb93b745de78b843aa269b57469d70ead05c78e83a1257f8769dc68752aff1f64a47c075a063f3bdc0ebfb229ce9b782b71c894f23a4f5ca199067b09ec29185460491409b89dddacfdd9588e19d8a059566cf1cdbef873b89cfe0f9718636ffa1959057a6a3f5bcaff55e181c7616d85942b4624217715308a81a0028a7179a98fb6eb78dbc454b879461241fdd53221c0a498bad8bf3ae74a4ebdb18eb28d996c7a7ba9196e384d3a4fa203540265ab18119c5b4af659cb8a2b3e0176aab66076c63e81c908d886409de4194577f509ce5d37bbe2e2ea93cd18030699d9cc270ebc5e576e9052a1276905f464227a25cb5912543fb62fc4b280d94e64a9de7d12ffd75c66fbda0d3b7b23489576ef5e30e29a679889f91f71b75ba290b9739cd41c4d6da9c560987ba66131a3eb7de5aed04434eb138025ab955342e292e63d5a538d91c2d1eeff0abd0ffebd6a43754464c79c1bc04adbdf9b3b2bc45b9c4b4a2b4c0b8eb1462be2e822bb7af775635c137d7934011396c7b41bdedeb8ccebaeada83de3ac24e87757d2b58f3ff78df8430c5ef3aed4a40d7e4e7532b1dc36986234ce7200a079ac3c7658c7313f84ffcd134c332f86e04f602861684a30bec41ed0f6fac18f30dc7ecaca67228814d2af2341827a38e5275bbdaba259c3b4a5821d7002268f50a102ac853e992fd9e62c4c52abd93a8685e8294f935f713f563b71b0118d7576a79406ce8ed193229078afa0b88be736db9f832618e6e10cb9f4eaa684f37d0152e060fa0c670b9563af0fe80bd2744b3b77bab082dc4751ce2a5438e9d3cb7b91301b40d9560050381ab5e41b911a14e9b828190258e777e0e8b7a354b756ed98bc374598306e4d572f81f4967c626dd156381dc28ce9302616da8453ca934af10115d57c2213b09f15a0643e39858aed421f99b585d4a7780a381087dd59682ba05e614e28734b461fb14598cb67b41b0370c262b047577074ffff94a430bbfbee36ed5b22f53d65b632d0c1b67a52a6a496f4e3b644b4da5f5650d741973d0613c8df9dad98eca20a78a67a8fa12d103e83ed387fafc34faf41be4e11fa721507c7c420a10bdc4730cc44a7e44b2ac118af616a37711f179e359b989b3dc91d5f5561780d82b93adea265b22b8dfb32994bff39b59542319c75d7ee3c42c8c11fa9fb2a6a309c3280b09f60f5726c85248fe6352730d10eed1758aec826830e9b29dfff836ea2b4bfee1856265fee7536f58a309df4f3a07a58009476f69033f43bb8cfb972bc611c7adbb42fe5b66f45f34113a03c74a48785b8f5f408e1f0b29299c515f801b34e17597af9fdccbf29b985c7af332ec0e2afe00cbf9e71857da573a7b5553316f0f9c3263f1568925b7916033207552f1b1ab9d50a8221e3c9325c2f61f73729a1825a8bc5c9d9e90dec804ab9bbdb2c7ed09255aee07ec98ca5130ac0ca1e4bd333f9464538bf5d93d7da0d91b222659b166e884000e4bae991f6924c0cb68dc936e44d5355e461f60fff83536d9a4040c8c58bcfa7dfe92d69be4ef4b1b79c99372201904ee68bbbaee56491f58c517d38d7d799b6c1f7c56cb63b4a6e75265657e94d2c13a2bdf4c573ee8da038661b0a3624a241b074da2d2b62408c8db9a92a54697d4ef801c01b74e0f54057528b368ecb15245ffd1de3c5e9928d7e115a9a1d4c9eef2c82515b951c356891a6b794e264cb1926a2af17f3a4f0d036f4c2f926a8189baf970eeb249ad4271ef1256cccb082f6259da4547446e636f030740c5c32ad1a2ce17917ff25dbfeb2d0749714813542f27280cbb6639ce13517d0fd0e93f2fbbb8e43d674f37a53fe4f799dd430282ce699df60d4d9622bcba3f0e1479b50aacfe1a72a5a1f021b5d1a29eced9ec98806e8c848f6083b489af1028fb167e257ef2ea68f7e671c21a9f3a69abc2b7c9356f3518222482e0b5f32e799994bc230439e7e3a9e57e58aeaaa1b13982f6f22d178e880efc0438558e5ed9cc373bba71191263e2edaf1ffbf80c75ed31d88f7f6e1725878369aea607c837e838659c62f0f2d11f5ab365e547ba8bde3f816b3a3fda999fc6b14f13e38678707911c99e2b31e0e3a146e846ef8e337f7d4395858b8205e2da5e695583954eecd744945761ada64d9222c9e1f80dfdc14df8b079442c8a67fd038ccee4bf19762b0ca8988d7ccbc21ccc08ac37babd9befe0f630569ba45d4c134cba3ac30c75ad85b1fab5466bab3182f8319c436460ba7d3eb4fdf029926754a6d56e7aaaa4876fa3e414afa7979f64448c8570d677bf1b355c38687c4bab24215e1e4e19f09018293d96f3e431b9fca10652139e7192f6c990a2077e585f7bfa8ea5382297da19136832a76181dc10c734630db6b78ed208f721d97e42745de17afeea6d0817efb1f7d4d109504d7d9015e3abe3ba2eb055e411d36070bc8b890215fc7e0ad191386ff68ec10b3edf50fa713840e7b7d6da6151512e94c5e40ecc91406cd9bb1952822dcf117e53ea655568001fac684b4d3d91f26c2a406853aae8b9cf5b62fcec5ed4ea689d6b14df881c88fd5a92197e32fad3432706cc9495d810119b55e15574c9f931fa3cb8889379141099d79ad2ab5d3e09418821994fc24dc8f625df67f92ba87ebc31771ff7414788107c2cf41b0c64776aa404e26f685560e7aba9b160c26e4265ce69eaa5a76155c8a1ab27b2395b19e6296be10a7cac7107cc2b336ae028109c3ae15108586df776fefb05eb1cbc0dd268014fea7708e0b832fc1d3a0c413298f3bae0de11552064361c0a34f3d7b55e7e6832c2f43ce76f56fad2c88cc4a27123a3b6daf2c30f3ccf8f7203dac514f77119ebd9694b7a513a9355c308f920acb34a2afa48cb935964b3a78a238a571d94e2ed25039bef8f1e5da0bdb8370143db3d33175510a33fe7e18564db67b4e053fd6e44bcb895e97d6f90719a61324390cf9997ebe46ee3775a157fda680ad9b6414770ccf337cf0576b031a7f134f9f2a13fb9d6b47a88ddb92c025574dcee0d390cf3261c552291ca87b2d8c51cfce364bdb871856dac02da72b150406009091846dd1dea3bb5358a1dcd827250a96000f49a654868956777f5625d88d71559b6c5aa11ff54b55aab1c3fd88bebdbdec055613659cc1fdcf7e71ef7301d08e547bbf17a4b46048d78f05f25d4719e1d659409d2448d34acd2dec4af943a304ba2f5da9ce12081a7c2b41ca06f8dab802a071a2bec74543ffef84d4d741fbef7bd260222ee4671fa91cd4389dbbcfd42a1fd87ba95ccd768a4e6b1500b9536f5456bb1bd758930b51316195259b654f5b00e3248c767a30515d54744ead5c12ef4100c77ccb6f415a1ae1f2bfef50968562534481018a73fa82f4b235f35d00342a2beeb8ddb7cfb704486f653ab76d84e5835c8b7c37778890706c2cffbb25d586a71901986ce5661ab98ceb520d16cb09723c4d0bffafbaa49b4fe7b9c63475aa475bee6c3361cea83f10e421d445feb907ea757ffc3cf720d0859d727a9a554de56351d1426e20588b3652d3a325380a0cdd1db7c364f09ec1c04f14ce4b1b7236389db35ff63d24651479b078e9254f415fc4bd21a9dc5176bb9182a18c3e90f9a5f84ca4214fffbd318f333cbed9f18fe62728c4ab69213d8c8f20f637d89691e4b997739d8eafd9232b212c8f524cbc4be4faa0e5436b131f8b6ab794e66f758f775b8db0e9d0c68b9bb75598fcec7a8d1027ceabde5a798c734260de3fbc22aa7b168281942c108467b2577c9cf2b9a42301253bab9a56e9764eddc851cfc61d670fb1030351ad675d5e5037f4d8a4cddb129e2168e253d20db29674f0ecf091abca3cc031b33ad95f622252235924352eb1d5e6825e39d8277193613b3dbcc2038dcaaf117f7ff3af58719cc4c91ab06412af38cb3080b24617c4506bc04286e62d483cb67e5f6c9343527eabf19e5957f5e9bd0002306a4f0130f215a54bdc7e77a20396b94b51996d8d494d409703abfbc16bf232d99d18951367bc4e91e857252c631497e9bed95713eb0fd78122161ecd13b3bc79e549bd36b7df5642dacae29b34ac0eb4c7a961b119272004a9bbb63d741369540a161cf13b706c255c5552d20e932d4fcfc1a1afc550d6ba1f82c4769493fd2a105f96391d6e0d84b29fe72e25b55865a335d0300971a08caaeea0e51916a0f2984aa19e2076ddd6030d8a23476ac36e8ff8ecd26c284e9be7d706bfb40cacb59db5d9aed6a8f61a319b86f3e1191e3cab61731380a760aacebeea02a440a4b0621ca48664f2e9cf1706df0e361bdc5620f311cfd34c73567c1ce69dd8d7b21b6cad1438cd96f0e95c2118b036c93e43be59d01e9313a1f105ce0c24dddcd3868e538fa39347fc1084be5b7fd871112fda4a1e0b6d256f02bf8dd1f79e66b8ae522cad65dffedc0348f3a9f5c2fc82d296671e3f6547fe650fe770dea7aab365485b271a12f489120559394b8589ba6532b12158f1f638069ca3a48c8f3460a8fa372ad0b8600c69e692645b2479e3aca6c71033f4f92d2fdf09fe43d9aca9fba86e2141a09caccba5b621c6a09df51d05a73cc138ed36549b13051fc1d5537b9a4df522eb00572579e8f1d6d5dd610cab0d644093292083620ab3e263a8bc8f11dc2babebb2cc03948fe7fb10c1aa780a01b73e0d1763519753ea78e85f7905ae8c51cda7377745f521b47dc5f744bfc43b3cabf8a11860a550427da8209dbefa40b71af861bda087bdb5e775fd41b8343f939ba8f5f4224ab6c0f8ef93efbd9f29c12bcb6414570be2f8b6739e5cddd0a3cc51b40fd1d4c02500493b5d87d3a16e18e4a5580058faa8572edaba0e538b4524141bcfde7f57e090372d4ff5c1eb37c016281ccdbd57054e90d73eefcdd39f827fb7aeaff581326f9fd9a8186f1da75501cc9904fe9aa3ed01cabc87cc9580550fa9897c51e44d90c4357e3590a641e7f270cb7543a881ebdb9f5e6652ad9fd42f1f947f7cb8507a4f6711860290516247055a4400f53e4b938388673731d7cfa55f1584c8f7a2f839ca9a4070d3b21aa1fcfbdd23a86e3d62edd8491310cfe3d40c7972e8201587975c15da21f3131fbabd361be3ea7ef1b89fbcbf74d34995825671f435841d45763e5999dc7dc63b339a2d1fea389e977d11d664539c07a0f6cb902e91687ccb531d9626715e36b3756c65af1acfc2705b2a1baccdc3976eb8e787891b2eb9a621ce924c2de86ec5011ea6e2123eedd47fe90c790ca9f62b35e0d8f3ce9aa318d953bb98496305f351262dd7e7813fab7a05c0fc096433297bda6767137c1388d9dbf1c2d95120b9e911d2659d9ddad2d0c720884026c2629432a8dbc601ef2260d1a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">密码：我初三的班级号</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/Eternity/lib/hbe.js"></script><link href="/Eternity/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Until The End </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>平衡树</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/bst-treap-splay/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/bst-treap-splay/</url>
      
        <content type="html"><![CDATA[<p>“平衡的旋转，亦是世上最美的舞蹈”</p><span id="more"></span><h2 id="二叉搜索树-Binary-Search-Tree"><a href="#二叉搜索树-Binary-Search-Tree" class="headerlink" title="二叉搜索树(Binary Search Tree)"></a>二叉搜索树(Binary Search Tree)</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>顾名思义，一棵二叉树，满足左子点的值小于父节点，右子点的值大于父节点。所有节点都满足该性质。当然，空节点不算。</p><h3 id="性质-特点"><a href="#性质-特点" class="headerlink" title="性质/特点"></a>性质/特点</h3><p>能够高效地完成：</p><ul><li>插入</li><li>查询</li><li>删除</li></ul><p>若 $x$ 是其中节点，而 $y$ 和 $z$ 分别是其左子点与右子点。那么它们满足：</p><blockquote><p>$y.key \leq x.key \leq z.key$</p></blockquote><h3 id="复杂度-代码实现"><a href="#复杂度-代码实现" class="headerlink" title="复杂度/代码实现"></a>复杂度/代码实现</h3><p>均摊 $O(\log n)$</p><h4 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h4><p>从根节点开始，按性质向下查找即可</p><h4 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h4><p>根据性质查找直到空节点，并新建节点。</p><h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><h5 id="叶节点"><a href="#叶节点" class="headerlink" title="叶节点"></a>叶节点</h5><p>直接删除</p><h5 id="仅有一个子节点的父节点"><a href="#仅有一个子节点的父节点" class="headerlink" title="仅有一个子节点的父节点"></a>仅有一个子节点的父节点</h5><p>上移其子节点，删除其本身</p><h5 id="双子节点的父节点"><a href="#双子节点的父节点" class="headerlink" title="双子节点的父节点"></a>双子节点的父节点</h5><p>找到需要删除的节点 $p$ 的直接前驱（或后驱） $s$ ，用 $s$ 代替 $p$ ，并删除 $s$</p><h3 id="另话"><a href="#另话" class="headerlink" title="另话"></a>另话</h3><p>然而，二叉查找树虽然均摊 $O(\log n)$ ，但实际上，当树作为一条链时，其任何操作都是 $O(n)$ ，<del>那做个P啊</del>，所以就会有了<strong>平衡树</strong>这种东西</p><h2 id="Treap"><a href="#Treap" class="headerlink" title="Treap"></a>Treap</h2><p>有两位巨佬告诉我， $Treap$ 这东西不需要学。所以我也就简单提提。</p><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>$Treap$ 实际上是一个合成词，$Tree+Heap$ 的合成。也顾名思义，给每一个节点加入一个随机值 $rand()$ 使其基本达到平衡。从而保证树的深度在 $\log n$ 左右。当这棵树的深度达到平衡极限时，进行<strong>左旋</strong>和<strong>右旋</strong>操作使深度降低。</p><h4 id="旋转-rotate"><a href="#旋转-rotate" class="headerlink" title="旋转(rotate)"></a>旋转(rotate)</h4><p>旋转分为<strong>左旋(zig)</strong>和<strong>右旋(zag)</strong>。其目的是使子节点转到根节点处。因为平衡树的操作众多，所以这里重点讲旋转，其他的因题而异即可。</p><p>$rotate(\&amp;p,d)$ 中，以 $p$ 为初始根节点旋转，$d=0$ 时左旋，$d=1$ 时右旋。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRotate</span><span class="params">(<span class="type">int</span> &amp;p,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k=Tree.son[p][d^<span class="number">1</span>];</span><br><span class="line">Tree.son[p][d^<span class="number">1</span>]=Tree.son[k][d];</span><br><span class="line">Tree.son[k][d]=p;</span><br><span class="line"><span class="built_in">underPushUp</span>(p);</span><br><span class="line"><span class="built_in">underPushUp</span>(k);</span><br><span class="line">p=k;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以左旋为例：</p><p>将右子点保存为 $k$ ，将 $p$ 的右子点变成 $k$ 的左子点。再将 $k$ 的左子点变成 $p$ 。然后将 $p$ 和 $k$ 都进行 $pushup$ 。（如果你不知道 $pushup$ 是啥请看<a href="">线段树学习笔记</a>）</p><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><p>建立一个极小点($-\inf$)和一个极大点($\inf$)防止越界</p><h3 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> M,Idx,Rt,op,x;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Treap</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> son[<span class="number">2</span>],val,rd,cnt,size;</span><br><span class="line">&#125;Tree[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underNew</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[++Idx].val=val;</span><br><span class="line">    Tree[Idx].rd=<span class="built_in">rand</span>();</span><br><span class="line">    Tree[Idx].cnt=Tree[Idx].size=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> Idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p].size=Tree[Tree[p].son[<span class="number">0</span>]].size+Tree[Tree[p].son[<span class="number">1</span>]].size+Tree[p].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underBuild</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">underNew</span>(-INF),<span class="built_in">underNew</span>(INF);</span><br><span class="line">    Rt=<span class="number">1</span>,Tree[<span class="number">1</span>].son[<span class="number">1</span>]=<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">underPushUp</span>(Rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRotate</span><span class="params">(<span class="type">int</span> &amp;p,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> k=Tree[p].son[d^<span class="number">1</span>];</span><br><span class="line">    Tree[p].son[d^<span class="number">1</span>]=Tree[k].son[d];</span><br><span class="line">    Tree[k].son[d]=p;</span><br><span class="line">    p=k;</span><br><span class="line">    <span class="built_in">underPushUp</span>(Tree[p].son[d]);</span><br><span class="line">    <span class="built_in">underPushUp</span>(p);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;   <span class="comment">//d=0 -&gt; zag</span></span><br><span class="line">    <span class="comment">//d=1 -&gt; zig</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInsert</span><span class="params">(<span class="type">int</span> &amp;p,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p=<span class="built_in">underNew</span>(val);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(val==Tree[p].val)</span><br><span class="line">    &#123;</span><br><span class="line">        ++Tree[p].cnt,<span class="built_in">underPushUp</span>(p);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(val&lt;Tree[p].val)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underInsert</span>(Tree[p].son[<span class="number">0</span>],val);</span><br><span class="line">        <span class="keyword">if</span>(Tree[p].rd&lt;Tree[Tree[p].son[<span class="number">0</span>]].rd) <span class="built_in">underRotate</span>(p,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underInsert</span>(Tree[p].son[<span class="number">1</span>],val);</span><br><span class="line">        <span class="keyword">if</span>(Tree[p].rd&lt;Tree[Tree[p].son[<span class="number">1</span>]].rd) <span class="built_in">underRotate</span>(p,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underPushUp</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetRankByVal</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(val==Tree[p].val) <span class="keyword">return</span> Tree[Tree[p].son[<span class="number">0</span>]].size+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(val&lt;Tree[p].val) <span class="keyword">return</span> <span class="built_in">underGetRankByVal</span>(Tree[p].son[<span class="number">0</span>],val);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">underGetRankByVal</span>(Tree[p].son[<span class="number">1</span>],val)+Tree[Tree[p].son[<span class="number">0</span>]].size+Tree[p].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetValByRank</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> rank)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="keyword">if</span>(Tree[Tree[p].son[<span class="number">0</span>]].size&gt;=rank) <span class="keyword">return</span> <span class="built_in">underGetValByRank</span>(Tree[p].son[<span class="number">0</span>],rank);</span><br><span class="line">    <span class="keyword">if</span>(Tree[Tree[p].son[<span class="number">0</span>]].size+Tree[p].cnt&gt;=rank) <span class="keyword">return</span> Tree[p].val;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">underGetValByRank</span>(Tree[p].son[<span class="number">1</span>],rank-Tree[Tree[p].son[<span class="number">0</span>]].size-Tree[p].cnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetPre</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">1</span>,p=Rt;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(val==Tree[p].val)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(Tree[p].son[<span class="number">0</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                p=Tree[p].son[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">while</span>(Tree[p].son[<span class="number">1</span>]) p=Tree[p].son[<span class="number">1</span>];</span><br><span class="line">                ans=p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Tree[p].val&lt;val&amp;&amp;Tree[p].val&gt;Tree[ans].val) ans=p;</span><br><span class="line">        p=(val&lt;Tree[p].val?Tree[p].son[<span class="number">0</span>]:Tree[p].son[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Tree[ans].val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetNxt</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">2</span>,p=Rt;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(val==Tree[p].val)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(Tree[p].son[<span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                p=Tree[p].son[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">while</span>(Tree[p].son[<span class="number">0</span>]) p=Tree[p].son[<span class="number">0</span>];</span><br><span class="line">                ans=p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Tree[p].val&gt;val&amp;&amp;Tree[p].val&lt;Tree[ans].val) ans=p;</span><br><span class="line">        p=(val&lt;Tree[p].val?Tree[p].son[<span class="number">0</span>]:Tree[p].son[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Tree[ans].val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underErase</span><span class="params">(<span class="type">int</span> &amp;p,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span>(val==Tree[p].val)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Tree[p].cnt&gt;<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            --Tree[p].cnt,<span class="built_in">underPushUp</span>(p);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Tree[p].son[<span class="number">0</span>]||Tree[p].son[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!Tree[p].son[<span class="number">1</span>]||Tree[Tree[p].son[<span class="number">0</span>]].rd&gt;Tree[Tree[p].son[<span class="number">1</span>]].rd) <span class="built_in">underRotate</span>(p,<span class="number">1</span>),<span class="built_in">underErase</span>(Tree[p].son[<span class="number">1</span>],val);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">underRotate</span>(p,<span class="number">0</span>),<span class="built_in">underErase</span>(Tree[p].son[<span class="number">0</span>],val);</span><br><span class="line">            <span class="built_in">underPushUp</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> p=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    val&lt;Tree[p].val?<span class="built_in">underErase</span>(Tree[p].son[<span class="number">0</span>],val):<span class="built_in">underErase</span>(Tree[p].son[<span class="number">1</span>],val);</span><br><span class="line">    <span class="built_in">underPushUp</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;splay.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;splay.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underBuild</span>();</span><br><span class="line">    <span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">while</span>(M--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(op),<span class="built_in">underRead</span>(x);</span><br><span class="line">        <span class="keyword">switch</span>(op)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">underInsert</span>(Rt,x);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">underErase</span>(Rt,x);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underGetRankByVal</span>(Rt,x)<span class="number">-1</span>);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underGetValByRank</span>(Rt,x+<span class="number">1</span>));<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underGetPre</span>(x));<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underGetNxt</span>(x));<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">1 106465</span></span><br><span class="line"><span class="comment">4 1</span></span><br><span class="line"><span class="comment">1 317721</span></span><br><span class="line"><span class="comment">1 460929</span></span><br><span class="line"><span class="comment">1 644985</span></span><br><span class="line"><span class="comment">1 84185</span></span><br><span class="line"><span class="comment">1 89851</span></span><br><span class="line"><span class="comment">6 81968</span></span><br><span class="line"><span class="comment">1 492737</span></span><br><span class="line"><span class="comment">5 493598</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="Splay"><a href="#Splay" class="headerlink" title="Splay"></a>Splay</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>俗称<strong>伸展树</strong>。也是一种二叉排序树，为了使整个查找时间变小，将被查频率高的那些节点转到靠近根节点的位置。每次查找节点之后对树进行重构，把被查找的节点搬移到树根。</p><p>为了将当前被访问节点旋转到树根，我们通常将节点自底向上旋转，直至该节点成为树根为止。“旋转”的巧妙之处就是在不打乱数列中数据大小关系（指中序遍历结果是全序的）情况下，所有基本操作的平摊复杂度仍为 $O(\log n)$。</p><p>一般来说， $Splay$ 的节点维护信息为：</p><div class="table-container"><table><thead><tr><th style="text-align:center">$fa$</th><th style="text-align:center">$chi[0/1]$</th><th style="text-align:center">$dat$</th><th style="text-align:center">$cnt$</th><th style="text-align:center">$size$</th></tr></thead><tbody><tr><td style="text-align:center">父节点编号</td><td style="text-align:center">子节点编号（一般 $0$ 为左子点，$1$ 为右子点）</td><td style="text-align:center">节点权值</td><td style="text-align:center">该节点权值出现的个数</td><td style="text-align:center">子树大小</td></tr></tbody></table></div><h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><h4 id="旋转操作"><a href="#旋转操作" class="headerlink" title="旋转操作"></a>旋转操作</h4><p>与 $Treap$ 的旋转类似。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">    <span class="type">int</span> k=Tree[y].chi[<span class="number">1</span>]==x;</span><br><span class="line">    Tree[z].chi[Tree[z].chi[<span class="number">1</span>]==y]=x;</span><br><span class="line">    Tree[x].fa=z;</span><br><span class="line">    Tree[y].chi[k]=Tree[x].chi[k^<span class="number">1</span>];</span><br><span class="line">    Tree[Tree[x].chi[k^<span class="number">1</span>]].fa=y;</span><br><span class="line">    Tree[x].chi[k^<span class="number">1</span>]=y;</span><br><span class="line">    Tree[y].fa=x;</span><br><span class="line">    <span class="built_in">underPushUp</span>(y);</span><br><span class="line">    <span class="built_in">underPushUp</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Splay操作"><a href="#Splay操作" class="headerlink" title="Splay操作"></a>Splay操作</h4><p>传递两个参数 $x$ 和 $k$ 表示将编号为 $x$ 的节点旋转到 $k$ 处，当 $k=0$ 时旋转到根节点。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Splay</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(Tree[x].fa!=k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">        <span class="keyword">if</span>(z!=k)</span><br><span class="line">            <span class="keyword">if</span>((Tree[y].chi[<span class="number">1</span>]==x)^(Tree[z].chi[<span class="number">1</span>]==y))</span><br><span class="line">                <span class="built_in">underRotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">underRotate</span>(y);</span><br><span class="line">        <span class="built_in">underRotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!k) Root=x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>总的说其实就上面两句，但实际上还是要讨论很多情况的。<del>背板子就完事儿了</del>。</p><p>其他的就根据题目而定了。这里给出一些比较常用的操作：</p><h4 id="插入操作"><a href="#插入操作" class="headerlink" title="插入操作"></a>插入操作</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInsert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,p;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat==x)</span><br><span class="line">        &#123;</span><br><span class="line">            ++Tree[u].cnt;</span><br><span class="line">            ++Tree[u].size;</span><br><span class="line">            <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        p=u;</span><br><span class="line">        u=Tree[u].chi[x&gt;Tree[u].dat];</span><br><span class="line">    &#125;</span><br><span class="line">    u=++Idx;</span><br><span class="line">    <span class="keyword">if</span>(p) Tree[p].chi[x&gt;Tree[p].dat]=u;</span><br><span class="line">    Tree[u].dat=x;</span><br><span class="line">    Tree[u].size=<span class="number">1</span>;</span><br><span class="line">    Tree[u].fa=p;</span><br><span class="line">    Tree[u].cnt=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underErase</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> l=<span class="built_in">underGetPre</span>(x),r=<span class="built_in">underGetNxt</span>(x);</span><br><span class="line">    <span class="built_in">Splay</span>(l,<span class="number">0</span>),<span class="built_in">Splay</span>(r,l);</span><br><span class="line">    Tree[Tree[r].chi[<span class="number">0</span>]].cnt--;</span><br><span class="line">    Tree[Tree[r].chi[<span class="number">0</span>]].size--;</span><br><span class="line">    <span class="keyword">if</span>(!Tree[Tree[r].chi[<span class="number">0</span>]].cnt)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[Tree[r].chi[<span class="number">0</span>]].fa=<span class="number">0</span>;</span><br><span class="line">        Tree[r].chi[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(r,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="查找前驱操作"><a href="#查找前驱操作" class="headerlink" title="查找前驱操作"></a>查找前驱操作</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetPre</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,res,v=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        v=u;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat&lt;x)</span><br><span class="line">        &#123;</span><br><span class="line">            res=u;</span><br><span class="line">            u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(v,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="查找后驱操作"><a href="#查找后驱操作" class="headerlink" title="查找后驱操作"></a>查找后驱操作</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetNxt</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,res,v=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        v=u;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat&gt;x)</span><br><span class="line">        &#123;</span><br><span class="line">            res=u;</span><br><span class="line">            u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(v,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="查找排名操作"><a href="#查找排名操作" class="headerlink" title="查找排名操作"></a>查找排名操作</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underNum</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Tree[Tree[u].chi[<span class="number">0</span>]].size&gt;=x) u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(x&lt;=Tree[Tree[u].chi[<span class="number">0</span>]].size+Tree[u].cnt&amp;&amp;x&gt;=Tree[Tree[u].chi[<span class="number">0</span>]].size+<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            x-=Tree[Tree[u].chi[<span class="number">0</span>]].size+Tree[u].cnt;</span><br><span class="line">            u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AC-Code-1"><a href="#AC-Code-1" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> M,Idx;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Splay</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> chi[<span class="number">2</span>],fa;</span><br><span class="line">    <span class="type">int</span> cnt,size,dat;</span><br><span class="line">&#125;Tree[MAXN];</span><br><span class="line"><span class="type">int</span> Root;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[x].size=Tree[Tree[x].chi[<span class="number">0</span>]].size+Tree[Tree[x].chi[<span class="number">1</span>]].size+Tree[x].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">    <span class="type">int</span> k=Tree[y].chi[<span class="number">1</span>]==x;</span><br><span class="line">    Tree[z].chi[Tree[z].chi[<span class="number">1</span>]==y]=x;</span><br><span class="line">    Tree[x].fa=z;</span><br><span class="line">    Tree[y].chi[k]=Tree[x].chi[k^<span class="number">1</span>];</span><br><span class="line">    Tree[Tree[x].chi[k^<span class="number">1</span>]].fa=y;</span><br><span class="line">    Tree[x].chi[k^<span class="number">1</span>]=y;</span><br><span class="line">    Tree[y].fa=x;</span><br><span class="line">    <span class="built_in">underPushUp</span>(y);</span><br><span class="line">    <span class="built_in">underPushUp</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Splay</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(Tree[x].fa!=k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">        <span class="keyword">if</span>(z!=k)</span><br><span class="line">            <span class="keyword">if</span>((Tree[y].chi[<span class="number">1</span>]==x)^(Tree[z].chi[<span class="number">1</span>]==y))</span><br><span class="line">                <span class="built_in">underRotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">underRotate</span>(y);</span><br><span class="line">        <span class="built_in">underRotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!k) Root=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInsert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,p;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat==x)</span><br><span class="line">        &#123;</span><br><span class="line">            ++Tree[u].cnt;</span><br><span class="line">            ++Tree[u].size;</span><br><span class="line">            <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        p=u;</span><br><span class="line">        u=Tree[u].chi[x&gt;Tree[u].dat];</span><br><span class="line">    &#125;</span><br><span class="line">    u=++Idx;</span><br><span class="line">    <span class="keyword">if</span>(p) Tree[p].chi[x&gt;Tree[p].dat]=u;</span><br><span class="line">    Tree[u].dat=x;</span><br><span class="line">    Tree[u].size=<span class="number">1</span>;</span><br><span class="line">    Tree[u].fa=p;</span><br><span class="line">    Tree[u].cnt=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Root=++Idx;</span><br><span class="line">    Tree[Root].fa=<span class="number">0</span>;</span><br><span class="line">    Tree[Root].cnt=<span class="number">1</span>;</span><br><span class="line">    Tree[Root].size=<span class="number">1</span>;</span><br><span class="line">    Tree[Root].dat=INF;</span><br><span class="line">    <span class="built_in">underInsert</span>(-INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetPre</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,res,v=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        v=u;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat&lt;x)</span><br><span class="line">        &#123;</span><br><span class="line">            res=u;</span><br><span class="line">            u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(v,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underGetNxt</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,res,v=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        v=u;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat&gt;x)</span><br><span class="line">        &#123;</span><br><span class="line">            res=u;</span><br><span class="line">            u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(v,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underErase</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> l=<span class="built_in">underGetPre</span>(x),r=<span class="built_in">underGetNxt</span>(x);</span><br><span class="line">    <span class="built_in">Splay</span>(l,<span class="number">0</span>),<span class="built_in">Splay</span>(r,l);</span><br><span class="line">    Tree[Tree[r].chi[<span class="number">0</span>]].cnt--;</span><br><span class="line">    Tree[Tree[r].chi[<span class="number">0</span>]].size--;</span><br><span class="line">    <span class="keyword">if</span>(!Tree[Tree[r].chi[<span class="number">0</span>]].cnt)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[Tree[r].chi[<span class="number">0</span>]].fa=<span class="number">0</span>;</span><br><span class="line">        Tree[r].chi[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Splay</span>(r,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underNum</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Tree[Tree[u].chi[<span class="number">0</span>]].size&gt;=x) u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(x&lt;=Tree[Tree[u].chi[<span class="number">0</span>]].size+Tree[u].cnt&amp;&amp;x&gt;=Tree[Tree[u].chi[<span class="number">0</span>]].size+<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            x-=Tree[Tree[u].chi[<span class="number">0</span>]].size+Tree[u].cnt;</span><br><span class="line">            u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;splay.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;splay.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underInit</span>();</span><br><span class="line">    <span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op,x;</span><br><span class="line">        <span class="built_in">underRead</span>(op),<span class="built_in">underRead</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">underInsert</span>(x);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>) <span class="built_in">underErase</span>(x);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Splay</span>(<span class="built_in">underGetPre</span>(x),<span class="number">0</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Tree[Tree[Root].chi[<span class="number">0</span>]].size+Tree[Root].cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">4</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Tree[<span class="built_in">underNum</span>(x+<span class="number">1</span>)].dat);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Tree[<span class="built_in">underGetPre</span>(x)].dat);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">6</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Tree[<span class="built_in">underGetNxt</span>(x)].dat);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">1 106465</span></span><br><span class="line"><span class="comment">4 1</span></span><br><span class="line"><span class="comment">1 317721</span></span><br><span class="line"><span class="comment">1 460929</span></span><br><span class="line"><span class="comment">1 644985</span></span><br><span class="line"><span class="comment">1 84185</span></span><br><span class="line"><span class="comment">1 89851</span></span><br><span class="line"><span class="comment">6 81968</span></span><br><span class="line"><span class="comment">1 492737</span></span><br><span class="line"><span class="comment">5 493598</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h3 id="文艺平衡树"><a href="#文艺平衡树" class="headerlink" title="文艺平衡树"></a>文艺平衡树</h3><p><a href="https://www.luogu.com.cn/problem/P3391">例题</a></p><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>我们已知，平衡树的中序遍历永远满足全序。我们又会发现（<del>其实要推一下</del>），当我们把区间 $[l,r]$ 反转时，就是将其两个子节点指针交换。将 $l$ 转到根节点，将 $r$ 转为 $l$ 的子节点。然后交换其子树编号即可。</p><h4 id="AC-Code-2"><a href="#AC-Code-2" class="headerlink" title="AC Code"></a>AC Code</h4><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,Idx;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Splay</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> chi[<span class="number">2</span>],fa,tag;</span><br><span class="line">    <span class="type">int</span> cnt,size,dat;</span><br><span class="line">&#125;Tree[MAXN];</span><br><span class="line"><span class="type">int</span> Root;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[x].size=Tree[Tree[x].chi[<span class="number">0</span>]].size+Tree[Tree[x].chi[<span class="number">1</span>]].size+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushDown</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(Tree[x].tag)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(Tree[x].chi[<span class="number">0</span>],Tree[x].chi[<span class="number">1</span>]);</span><br><span class="line">Tree[Tree[x].chi[<span class="number">0</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">Tree[Tree[x].chi[<span class="number">1</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">Tree[x].tag^=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">    <span class="type">int</span> k=Tree[y].chi[<span class="number">1</span>]==x;</span><br><span class="line">    Tree[z].chi[Tree[z].chi[<span class="number">1</span>]==y]=x;</span><br><span class="line">    Tree[x].fa=z;</span><br><span class="line">    Tree[y].chi[k]=Tree[x].chi[k^<span class="number">1</span>];</span><br><span class="line">    Tree[Tree[x].chi[k^<span class="number">1</span>]].fa=y;</span><br><span class="line">    Tree[x].chi[k^<span class="number">1</span>]=y;</span><br><span class="line">    Tree[y].fa=x;</span><br><span class="line">    <span class="built_in">underPushUp</span>(y);</span><br><span class="line">    <span class="built_in">underPushUp</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Splay</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(Tree[x].fa!=k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> y=Tree[x].fa,z=Tree[y].fa;</span><br><span class="line">        <span class="keyword">if</span>(z!=k)</span><br><span class="line">            <span class="keyword">if</span>((Tree[y].chi[<span class="number">1</span>]==x)^(Tree[z].chi[<span class="number">1</span>]==y)) <span class="built_in">underRotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">underRotate</span>(y);</span><br><span class="line">        <span class="built_in">underRotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!k) Root=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInsert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=Root,p=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Tree[u].dat==x)</span><br><span class="line">        &#123;</span><br><span class="line">            ++Tree[u].cnt;</span><br><span class="line">            ++Tree[u].size;</span><br><span class="line">            <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        p=u;</span><br><span class="line">        u=Tree[u].chi[x&gt;Tree[u].dat];</span><br><span class="line">    &#125;</span><br><span class="line">    u=++Idx;</span><br><span class="line">    <span class="keyword">if</span>(p) Tree[p].chi[x&gt;Tree[p].dat]=u;</span><br><span class="line">    Tree[u].dat=x;</span><br><span class="line">    Tree[u].size=<span class="number">1</span>;</span><br><span class="line">    Tree[u].fa=p;</span><br><span class="line">    Tree[u].cnt=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">Splay</span>(u,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underWrite</span><span class="params">(<span class="type">int</span> rt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">underPushDown</span>(rt);</span><br><span class="line"><span class="keyword">if</span>(Tree[rt].chi[<span class="number">0</span>]) <span class="built_in">underWrite</span>(Tree[rt].chi[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">if</span>(Tree[rt].dat&gt;<span class="number">1</span>&amp;&amp;Tree[rt].dat&lt;N+<span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,Tree[rt].dat<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">if</span>(Tree[rt].chi[<span class="number">1</span>]) <span class="built_in">underWrite</span>(Tree[rt].chi[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underKth</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> u=Root;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">underPushDown</span>(u);</span><br><span class="line"><span class="keyword">if</span>(Tree[Tree[u].chi[<span class="number">0</span>]].size&gt;=k) u=Tree[u].chi[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(Tree[Tree[u].chi[<span class="number">0</span>]].size+<span class="number">1</span>==k) <span class="keyword">return</span> u;</span><br><span class="line"><span class="keyword">else</span> k-=Tree[Tree[u].chi[<span class="number">0</span>]].size+<span class="number">1</span>,u=Tree[u].chi[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underSwap</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">l=<span class="built_in">underKth</span>(l);</span><br><span class="line">r=<span class="built_in">underKth</span>(r+<span class="number">2</span>);</span><br><span class="line"><span class="built_in">Splay</span>(l,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">Splay</span>(r,l);</span><br><span class="line">Tree[Tree[Tree[Root].chi[<span class="number">1</span>]].chi[<span class="number">0</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Root=++Idx;</span><br><span class="line">    Tree[Root].fa=<span class="number">0</span>;</span><br><span class="line">    Tree[Root].cnt=<span class="number">1</span>;</span><br><span class="line">    Tree[Root].size=<span class="number">1</span>;</span><br><span class="line">    Tree[Root].dat=INF;</span><br><span class="line">    <span class="built_in">underInsert</span>(-INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;splay.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;splay.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N+<span class="number">2</span>;++i) <span class="built_in">underInsert</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="type">int</span> Ql,Qr;</span><br><span class="line">        <span class="built_in">underRead</span>(Ql),<span class="built_in">underRead</span>(Qr);</span><br><span class="line">        <span class="built_in">underSwap</span>(Ql,Qr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underWrite</span>(Root);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 3</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">1 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h2 id="Fhq-Treap"><a href="#Fhq-Treap" class="headerlink" title="Fhq-Treap"></a>Fhq-Treap</h2><p>暂代补充</p><h2 id="AVL数"><a href="#AVL数" class="headerlink" title="AVL数"></a>AVL数</h2><p>暂代补充</p><h2 id="红黑树"><a href="#红黑树" class="headerlink" title="红黑树"></a>红黑树</h2><p>估计不会有了</p><hr><p>没有更多了</p><p>首次更新：$date\ 2022.3.14$</p><p>最后更新：$date\ 2022.3.19$</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> Splay </tag>
            
            <tag> 二叉搜索树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>可持久化线段树(主席树)</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/persistent-segment-tree/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/persistent-segment-tree/</url>
      
        <content type="html"><![CDATA[<p>”即使离开了多远，我的心中依然是最初的你“</p><span id="more"></span><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><strong>主席树</strong>全称<strong>可持久化权值线段树</strong>，用于维护区间最值与一些奇奇怪怪的东西。支持历史询问与修改（目前不会），似乎与普通线段树的时间复杂度是一样的，但空间会减少很多消耗。</p><p>在算法执行的过程中，会发现在更新一个动态集合时，需要维护其过去的版本。这样的集合称为是<strong>可持久</strong>的。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="建树-build"><a href="#建树-build" class="headerlink" title="建树(build)"></a>建树(build)</h3><p>首先，建立起<strong>亘古树</strong>，即一开始的整棵线段树。但是根本不需要。对于主席树而言，改掉了我的一个习惯：即线段树的左区间与右区间是存于 $Tree$ 内的。这样可能会消耗一些空间。但对于主席树而言，其儿子节点并不满足 <code>Tree[p].l=p&lt;&lt;1</code> 与 <code>Tree[p].r=p&lt;&lt;1|1</code> 的关系，所以对于建树而言，每一个节点的 $l$ 和 $r$ 存储的是其左右儿子的点编号。每输入一个数，就动态修改即可，根本不需要进行 $build$ 操作。<del>一般不建</del></p><h3 id="修改-插入-modify"><a href="#修改-插入-modify" class="headerlink" title="修改/插入(modify)"></a>修改/插入(modify)</h3><p>每输入一个值……其实这句话是不对的。对于部分主席树的题而言，是需要<strong>离散化</strong>的。所以插入（修改）操作都是在输入完并离散化之后才一次性完成的。</p><p>以洛谷的<a href="https://www.luogu.com.cn/problem/P3834">模板题</a>为例，我们需要求区间 $[l,r]$ 的第 $k$ 小值。则对于这道题的历史版本 $v_i$ ，处理的其实是<strong>前缀和</strong>的信息。即我们建的第 $i$ 个树存储的是区间 $[1,i]$ 的 $Val$ 信息。而叶节点存储的则是第 $i$ 个数的个数。</p><p>对于每一次的插入操作，我们就在原来基础上插入一条链直达叶节点，表示我们在该位置插入了一个数。然后自下而上更新区间值 $dat$ ，这与线段树是一样的。而不同的是，在插入过程中，其节点编号 $p$ 是动态的。因为当一个地方没有被修改时，我们会指向其历史编号，只有当修改时才会新建编号，而我们新建了编号后，其父节点所指的子节点也是会更改的。所以就会有 <code>int &amp;x</code> 的情况。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[++Idx]=Tree[x];</span><br><span class="line">    x=Idx;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        ++Tree[x].dat;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;=mid) <span class="built_in">underModify</span>(Tree[x].l,l,mid,d);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">underModify</span>(Tree[x].r,mid+<span class="number">1</span>,r,d);</span><br><span class="line">    <span class="built_in">underPushUp</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="查询-query"><a href="#查询-query" class="headerlink" title="查询(query)"></a>查询(query)</h3><p>其意义并非真正的线段树查询。因为用了二分的思想又与线段树相似而称之为查询。对于查询第 $k$ 小数而言，因为我们已经离散化排了序的，则：</p><ol><li>当该节点的左儿子存储的数的个数大于 $k$ ，则查询左儿子；</li><li>当该节点的左儿子存储的数的个数小于 $k$ ，则查询右儿子的第 $k-ls$ 小值。</li></ol><p>这就因题而异了，只是提一句。</p><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><h4 id="离散化"><a href="#离散化" class="headerlink" title="离散化"></a>离散化</h4><p>因题而异。可以有，也可以没有。</p><h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h4><p>因题而异。可以有，也可以没有。</p><h4 id="修改根节点-root"><a href="#修改根节点-root" class="headerlink" title="修改根节点(root)"></a>修改根节点(root)</h4><p>每一个历史线段树的根节点在一开始的时候都是空的，其会在插入操作里不断更新。这也是为什么 <code>int &amp;x</code> 的原因（<del>二次重提</del>）</p><h2 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h2><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,Val[MAXN&lt;&lt;<span class="number">1</span>],Root[MAXN&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PersistentSegmentTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> dat,l,r;</span><br><span class="line">&#125;Tree[MAXN&lt;&lt;<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> Idx;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p].dat=Tree[Tree[p].l].dat+Tree[Tree[p].r].dat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[++Idx]=Tree[x];</span><br><span class="line">    x=Idx;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        ++Tree[x].dat;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;=mid) <span class="built_in">underModify</span>(Tree[x].l,l,mid,d);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">underModify</span>(Tree[x].r,mid+<span class="number">1</span>,r,d);</span><br><span class="line">    <span class="built_in">underPushUp</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQuery</span><span class="params">(<span class="type">int</span> x1,<span class="type">int</span> x2,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ls=Tree[Tree[x2].l].dat-Tree[Tree[x1].l].dat;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=ls) <span class="keyword">return</span> <span class="built_in">underQuery</span>(Tree[x1].l,Tree[x2].l,l,mid,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">underQuery</span>(Tree[x1].r,Tree[x2].r,mid+<span class="number">1</span>,r,k-ls);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;PST.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;PST.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;V;</span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(Val[i]);</span><br><span class="line">        V.<span class="built_in">push_back</span>(Val[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> len=V.<span class="built_in">erase</span>(<span class="built_in">unique</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>()),V.<span class="built_in">end</span>())-V.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        Root[i]=Root[i<span class="number">-1</span>];</span><br><span class="line">        <span class="built_in">underModify</span>(Root[i],<span class="number">1</span>,len,<span class="built_in">lower_bound</span>(V.<span class="built_in">begin</span>(),V.<span class="built_in">end</span>(),Val[i])-V.<span class="built_in">begin</span>()+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> Ql,Qr,Qk;M;M--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(Ql),<span class="built_in">underRead</span>(Qr),<span class="built_in">underRead</span>(Qk);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,V[<span class="built_in">underQuery</span>(Root[Ql<span class="number">-1</span>],Root[Qr],<span class="number">1</span>,len,Qk)<span class="number">-1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 5</span></span><br><span class="line"><span class="comment">25957 6405 15770 26287 26465 </span></span><br><span class="line"><span class="comment">2 2 1</span></span><br><span class="line"><span class="comment">3 4 1</span></span><br><span class="line"><span class="comment">4 5 1</span></span><br><span class="line"><span class="comment">1 2 2</span></span><br><span class="line"><span class="comment">4 4 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="可持久化数组"><a href="#可持久化数组" class="headerlink" title="可持久化数组"></a>可持久化数组</h2><p>其实差不多，只是多了一个建树操作。因为它有一个初始数列，这道题真的就是字面意思的<strong>可持久化</strong>了。</p><p><a href="https://www.luogu.com.cn/problem/P3919">P3919 【模板】可持久化线段树 1（可持久化数组）</a></p><h3 id="AC-Code-1"><a href="#AC-Code-1" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,Idx,Root[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l,r,dat;</span><br><span class="line">&#125;Tree[MAXN*<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> Val[MAXN],op,Ql,Qv,Qk;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underBuild</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=++Idx;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[x].dat=Val[l];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">underBuild</span>(Tree[x].l,l,mid),<span class="built_in">underBuild</span>(Tree[x].r,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[++Idx]=Tree[x];</span><br><span class="line">    x=Idx;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[x].dat=k;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;=mid) <span class="built_in">underModify</span>(Tree[x].l,l,mid,d,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">underModify</span>(Tree[x].r,mid+<span class="number">1</span>,r,d,k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQuery</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> Tree[x].dat;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(d&lt;=mid) <span class="keyword">return</span> <span class="built_in">underQuery</span>(Tree[x].l,l,mid,d);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">underQuery</span>(Tree[x].r,mid+<span class="number">1</span>,r,d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;PST-fake.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;PST-fake.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N),<span class="built_in">underRead</span>(M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">underRead</span>(Val[i]);</span><br><span class="line">    <span class="built_in">underBuild</span>(Root[<span class="number">0</span>],<span class="number">1</span>,N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(Qv),<span class="built_in">underRead</span>(op);</span><br><span class="line">        Root[i]=Root[Qv];</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">underRead</span>(Ql),<span class="built_in">underRead</span>(Qk);</span><br><span class="line">            <span class="built_in">underModify</span>(Root[i],<span class="number">1</span>,N,Ql,Qk);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">underRead</span>(Ql);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underQuery</span>(Root[i],<span class="number">1</span>,N,Ql));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 10</span></span><br><span class="line"><span class="comment">59 46 14 87 41</span></span><br><span class="line"><span class="comment">0 2 1</span></span><br><span class="line"><span class="comment">0 1 1 14</span></span><br><span class="line"><span class="comment">0 1 1 57</span></span><br><span class="line"><span class="comment">0 1 1 88</span></span><br><span class="line"><span class="comment">4 2 4</span></span><br><span class="line"><span class="comment">0 2 5</span></span><br><span class="line"><span class="comment">0 2 4</span></span><br><span class="line"><span class="comment">4 2 1</span></span><br><span class="line"><span class="comment">2 2 2</span></span><br><span class="line"><span class="comment">1 1 5 91</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 主席树 </tag>
            
            <tag> 可持久化数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>欧拉函数</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/euler-function/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/euler-function/</url>
      
        <content type="html"><![CDATA[<p>“下一个就是你了，承太郎“</p><span id="more"></span><h2 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h2><blockquote><p>指的是满足小于等于$N$且与$N$互质的数目和。</p></blockquote><h2 id="欧拉公式求解公式："><a href="#欧拉公式求解公式：" class="headerlink" title="欧拉公式求解公式："></a>欧拉公式求解公式：</h2><p>对于一个正整数$N$满足：</p><blockquote><p>$\varphi(x)=\sum_{k}[(k, n)=1][k \in N][k&lt;n]$</p></blockquote><p>则有</p><blockquote><p>$\varphi(n)=n\left(1-\frac{1}{p_{1}}\right)\left(1-\frac{1}{p_{2}}\right)\left(1-\frac{1}{p_{3}}\right) \cdots\left(1-\frac{1}{p_{k}}\right)$</p></blockquote><h2 id="欧拉函数的性质："><a href="#欧拉函数的性质：" class="headerlink" title="欧拉函数的性质："></a>欧拉函数的性质：</h2><h3 id="当-N-0-时："><a href="#当-N-0-时：" class="headerlink" title="当$N=0$时："></a>当$N=0$时：</h3><blockquote><p>$\varphi(0)=0$.</p></blockquote><h3 id="当-N-1-时："><a href="#当-N-1-时：" class="headerlink" title="当$N=1$时："></a>当$N=1$时：</h3><blockquote><p>$\varphi(1)=1$.因为1与自身互质。</p></blockquote><h3 id="当-N-为质数时："><a href="#当-N-为质数时：" class="headerlink" title="当$N$为质数时："></a>当$N$为质数时：</h3><blockquote><p>$\varphi(N)=N-1$.</p></blockquote><h3 id="如果-P-是质数，而-N-是-P-的正整数次方："><a href="#如果-P-是质数，而-N-是-P-的正整数次方：" class="headerlink" title="如果$P$是质数，而$N$是$P$的正整数次方："></a>如果$P$是质数，而$N$是$P$的正整数次方：</h3><blockquote><p>$\varphi(P^N)=P^N(1-\frac{1}{p})$</p></blockquote><h2 id="欧拉定理："><a href="#欧拉定理：" class="headerlink" title="欧拉定理："></a>欧拉定理：</h2><p>设$a,m \in N^+$，且$(a,m)=1$，那么则有</p><blockquote><p>$a^{\varphi(m)} \equiv 1 \pmod m$</p><p>且$a$对模$m$的阶$\delta_m(a)$必须整除$\varphi(a)$.</p></blockquote><p>证明：</p><blockquote><p>取模$m$的缩系，$a_1,a_2,a_3……a_{\varphi(m)}$，</p><p>则$aa_1,aa_2,aa_3……aa_{\varphi(m)}$也是$m$的缩系.</p><p>故有$\prod_{i=1}^{\varphi(m)}a_i \equiv \prod_{i=1}^{\varphi(m)}aa_i \equiv a^{\varphi(m)}\prod_{i=1}^{\varphi(m)}a_i \pmod m$</p><p>则可以推出$a^{\varphi(m)} \equiv 1 \pmod m$. </p></blockquote><p>证毕</p><p>欧拉定理可以推出<strong>费马小定理</strong>：</p><blockquote><p>如果p是一个质数，而整数$a$不是$p$的倍数，</p><p>则有$a^{(p-1)} \equiv 1 \pmod p$。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 函数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>同余</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/congruence/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/congruence/</url>
      
        <content type="html"><![CDATA[<p>“虽然我们相差甚远，但至少初心是一致的”</p><span id="more"></span><h2 id="同余："><a href="#同余：" class="headerlink" title="同余："></a>同余：</h2><h3 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h3><p>$a$ 与 $b$ 同余，当且仅当 $a$ 与 $b$ 除以 $p$ 的余数相同，记作 $a$ 与 $b$ 模 $p$ 同余，写作 $a \equiv b \pmod p$。</p><h3 id="同余的性质："><a href="#同余的性质：" class="headerlink" title="同余的性质："></a>同余的性质：</h3><ul><li><p>若 $a \equiv b \pmod p$ ，则有 $a+c \equiv b+c \pmod p$</p></li><li><p>若 $a \equiv b \pmod p$ ，则有 $ac \equiv bc \pmod p$</p></li><li><p>若 $a \equiv b \pmod p$ ，且 $c \equiv d \pmod p$ ，则有 $a \pm c \equiv b \pm d \pmod p$</p></li><li><p>若 $ac \equiv bc \pmod p$ ，且 $(c,m)=1$ ，那么 $a \equiv b \pmod p$</p></li><li><p>若 $a \equiv b \pmod p$ ，且 $c \equiv d \pmod p$ ，则有 $ac \equiv bd \pmod p$</p></li><li><p>若 $a \equiv b \pmod p$ ，则有 $ac \equiv bc \pmod {pc}$</p></li><li><p>若 $a$ 和 $b$ 都是整数，且 $d$ 和 $m$ 都是正整数， $d$ 是 $a,b,m$ 中任一公因数，则如果 $a \equiv b \pmod m$ 成立时，则有 $\frac{a}{d} \equiv \frac{b}{d} \pmod {\frac{p}{d}}$</p></li><li><p>若 $a$ 和 $b$ 都是整数，且 $d$ 和 $m$ 都是正整数，且 $d|m$，则如果 $a \equiv b \pmod m$ 成立时，则有 $a \equiv b \pmod d$ 。</p></li><li><p>若 $a$ 和 $b$ 都是整数，且 $d$ 和 $m$ 都是正整数，如果 $a \equiv b \pmod m$ 成立时，则有 $(a,m)=(b,m)$ ，且若如果 $d$ 能够整除 $a,b,m$ 中的任意一个， $d$ 也就能整除 $a,b$ 中的另一个。</p></li></ul><h2 id="扩展欧几里得算法："><a href="#扩展欧几里得算法：" class="headerlink" title="扩展欧几里得算法："></a>扩展欧几里得算法：</h2><p>若 $(a,b)=d$ ，那么对于方程 $ax+by=d$ 的解有一组特殊解为 $x=x_0,y=y_0$ ，那么该方程的通解为 $x=x_0+\frac{b}{d}<em>t,y=y_0-\frac{a}{d}</em>t$ ，而我们用这个通解来逆向推出 $gcd$ ，因为我们有<strong>欧几里得定理</strong>：</p><blockquote><p>$(a,b)=d$ ，则有 $(b,a \bmod b)=d$</p></blockquote><p>那么就会推出： $d=a<em>y_1+b</em>(x_1-y_1*\frac{a}{b})$ </p><p>在这个算式中满足： $x=y_1,y=x_1-\frac{a}{b}*y_1$</p><h3 id="扩欧解同余方程："><a href="#扩欧解同余方程：" class="headerlink" title="扩欧解同余方程："></a>扩欧解同余方程：</h3><p>对于方程 $ax \equiv 1 \pmod b$ ，已知 $a$ 与 $b$ ，求出最小的 $x$ 。</p><p><a href="https://www.luogu.com.cn/problem/P1082">LuoguP1082</a></p><p>妥妥的扩欧模板题：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">LL a,b,x,y;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underExgcd</span><span class="params">(LL a,LL b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        x=<span class="number">1</span>,y=<span class="number">7</span>;            <span class="comment">//一对特殊解</span></span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underExgcd</span>(b,a%b);</span><br><span class="line">    LL tx=x;</span><br><span class="line">    x=y;</span><br><span class="line">    y=tx-a/b*y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;exgcd.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;exgcd.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(a),<span class="built_in">underRead</span>(b);</span><br><span class="line">    <span class="built_in">underExgcd</span>(a,b);</span><br><span class="line">    x=(x%b+b)%b;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,x);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 10</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="中国剩余定理："><a href="#中国剩余定理：" class="headerlink" title="中国剩余定理："></a>中国剩余定理：</h2><p><a href="https://www.luogu.com.cn/problem/P1495">LuoguP1495曹冲养猪</a></p><p>有一个同余方程组满足 </p><script type="math/tex; mode=display">\left\{\begin{matrix}x \equiv a_1 \pmod {m_1} \\x \equiv a_2 \pmod {m_2} \\x \equiv a_3 \pmod {m_3} \\x \equiv a_4 \pmod {m_4} \\x \equiv a_5 \pmod {m_5} \\...... \\x \equiv a_k \pmod {m_k}\end{matrix}\right.</script><p> ，求出最小的 $x$ 。</p><h3 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h3><p>设 $M=m_1m_2m_3…m_k$ ，令 $M_i=\frac{M}{m_i}$ ，$t_i$ 是 $M_i$  的逆元，有 $M_it_i \equiv 1 \pmod m_i$</p><p>则 $x=\sum_{i=1}^{k}{a_iM_it_i}$</p><p>则可构造特殊解 $x_0=x+k*M$</p><p>最小正整数解即为 $x_{min}=x_0 \bmod M$</p><h3 id="P3868-AC-Code"><a href="#P3868-AC-Code" class="headerlink" title="P3868 AC Code:"></a>P3868 AC Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    LL type,mod;</span><br><span class="line">&#125;Num[MAXN];</span><br><span class="line">LL M[MAXN],Mul=<span class="number">1</span>,Mi[MAXN],X;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underExgcd</span><span class="params">(LL a,LL b,LL &amp;x,LL &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underExgcd</span>(b,a%b,x,y);</span><br><span class="line">    LL z=x;x=y;y=z-y*(a/b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;china.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;china.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(Num[i].type),<span class="built_in">underRead</span>(Num[i].mod);</span><br><span class="line">        Mul*=Num[i].type;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> t=<span class="number">1</span>;t&lt;=N;++t)</span><br><span class="line">    &#123;</span><br><span class="line">        Mi[t]=Mul/Num[t].type;</span><br><span class="line">        LL x=<span class="number">0</span>,y=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">underExgcd</span>(Mi[t],Num[t].type,x,y);</span><br><span class="line">        X+=Num[t].mod*Mi[t]*(x&lt;<span class="number">0</span>?x+Num[t].type:x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,X%Mul);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3 1</span></span><br><span class="line"><span class="comment">5 1</span></span><br><span class="line"><span class="comment">7 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 同余 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数列与极限 #2</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Math/analytical-mathematics-series-limits-2/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Math/analytical-mathematics-series-limits-2/</url>
      
        <content type="html"><![CDATA[<p>“当我趋近于你，我们之间的感情便成为了确值”</p><span id="more"></span><h2 id="实数的完备性定理（部分）"><a href="#实数的完备性定理（部分）" class="headerlink" title="实数的完备性定理（部分）"></a>实数的完备性定理（部分）</h2><h3 id="单调有界定理"><a href="#单调有界定理" class="headerlink" title="单调有界定理"></a>单调有界定理</h3><ol><li><p>若数列 $\{ x_n \}$ 递增且有上界，则</p><script type="math/tex; mode=display">\lim \limits_{n \to +\infty} x_n = \sup \{ x_n | n \in N \}</script></li><li><p>若数列 $\{ x_n \}$ 递减且有下界，则</p><script type="math/tex; mode=display">\lim \limits_{n \to +\infty} x_n = \inf \{ x_n | n \in N\}</script></li></ol><h3 id="柯西收敛原理"><a href="#柯西收敛原理" class="headerlink" title="柯西收敛原理"></a>柯西收敛原理</h3><p>设 $ \{ x_n \} $ 是一个数列，如果对于任意一个 $\epsilon &gt; 0$ ，存在 $N \in \mathbb{Z^<em>}$ ，只要 $n$ 满足 $n &gt; N$ ，则对于任意正整数 $p$ 而言，都有 $| x_{n+p}-x_n | &lt; \epsilon$ ，这样的数列 $\{ x_n \}$ 便称为<em>*柯西数列</em></em>。</p><p>这样的<strong>渐进稳定性</strong>和<strong>收敛性</strong>是等价的，即为<strong>充分必要条件</strong>。</p><p>简单来说：</p><script type="math/tex; mode=display">数列 \{ x_n \} 收敛的充要条件是 \forall \epsilon \in \mathbb{R^+} , \exists N \in \mathbb{Z^+} , \forall n,m > N ( | x_m - x_n | < \epsilon )</script><h3 id="戴德金原理"><a href="#戴德金原理" class="headerlink" title="戴德金原理"></a>戴德金原理</h3><p>如果 $\mathbb{R}$ 的两个子集 $A$ 和 $B$ 满足：</p><script type="math/tex; mode=display">\begin{aligned}&1. A \neq \emptyset \wedge B \neq \emptyset \\&2. A \cup B = \mathbb{R}\\&3. \forall x \in A , \forall y \in B ( x < y ) \\\end{aligned}</script><p>那么， $\exists c \in \mathbb{R} ( \forall a \in A , \forall b \in B ( a  \leq c \leq b) )$ 。</p><h3 id="闭区间套定理"><a href="#闭区间套定理" class="headerlink" title="闭区间套定理"></a>闭区间套定理</h3><p>如果数列 $\{ a_n \}$ 和 $\{ b_n \}$ 满足：</p><script type="math/tex; mode=display">\begin{aligned}&1. \forall n \in \mathbb{Z^+} ( a_n \leq a_{n+1} < b_{n+1} \leq b_n ) \\&2. \lim \limits_{n \to +\infty} ( b_n - a_n ) = 0 \\\end{aligned}</script><p>那么以下结论成立：</p><script type="math/tex; mode=display">\begin{aligned}&1. \lim \limits_{n \to +\infty} a_n = \lim \limits =_{n \to +\infty} b_n (该极限值记为 c )\\&2. 上述 c 是满足 \forall n \in \mathbb{Z^+} ( a_n \leq c \leq b_n ) 的唯一实数\end{aligned}</script><h3 id="确界存在原理"><a href="#确界存在原理" class="headerlink" title="确界存在原理"></a>确界存在原理</h3><p>对于 $\mathbb{R}$ 的任何非空子集 $S$ ，若 $S$ 在 $\mathbb{R}$ 内有上界，则 $S$ 在 $\mathbb{R}$ 内有上确界。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> Math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 微积分 </tag>
            
            <tag> 分析数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数列与极限</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Math/analytical-mathematics-series-limits/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Math/analytical-mathematics-series-limits/</url>
      
        <content type="html"><![CDATA[<blockquote><p>数学不能凭 $sense$ ，必须要追求<strong>严谨</strong>。—— $Zq$</p></blockquote><span id="more"></span><h2 id="数列定义"><a href="#数列定义" class="headerlink" title="数列定义"></a>数列定义</h2><p>一种从自然数（或正整数）到实数（或其它域）的映射 $f : \mathbb{N} \to \mathbb{R}$ ，这便是一个<strong>数列</strong>。一般来说，设 $a_n=f(n)$ ，则该数列记作 $\{ a_n \}_{n=0}^{+ \infty}$</p><p>定义一个数列 $f : \mathbb{N} \to \mathbb{R}$ 的子数列为一个数列 $g : L \to \mathbb{R}$ 满足 $L \subseteq \mathbb{N} \wedge \forall n \in L , g(n) = f(n) \wedge \mid L \mid = + \infty$ 。</p><h2 id="极限"><a href="#极限" class="headerlink" title="极限"></a>极限</h2><p>对于一个数列 ${a_n\}_{n = 1}^{+ \infty }$ ，若 $\exists \delta \in R, s.t. \forall \epsilon &gt; 0, \exists N &gt; 0 \wedge N \in \mathbb{N}^+, s.t. \forall n &gt; N , \mid a_n - \delta \mid &lt; \epsilon$ ，我们就称 $\delta$ 为数列的极限，记作 $\lim\limits _{n \to + \infty} a_n = \delta$ ，或者 $a_n \to \delta(n \to + \infty)$ ，有时候括号内的可以省略。（上面的 $s.t$ 指 “使得”）</p><p>对于一个数列，如果它存在极限，我们就称这个数列<strong>收敛</strong>，否则就称其<strong>发散</strong>。</p><h2 id="数列极限的几何意义"><a href="#数列极限的几何意义" class="headerlink" title="数列极限的几何意义"></a>数列极限的几何意义</h2><p>对于一个数列满足：</p><script type="math/tex; mode=display">\begin{aligned}当 n > N 时，均有不等式 | x_n - a | < \epsilon\end{aligned}</script><p>即表示：</p><script type="math/tex; mode=display">\begin{aligned}\\所有下标大于 N 的 x_n 都落在 ( a - \epsilon , a + \epsilon ) 内，\\且落在 ( a - \epsilon , a + \epsilon ) 之外的点至多有 N 个（有限）\end{aligned}</script><p>如果存在某个值 $\epsilon_0$ 使得数列 ${x_n}$ 中有无穷个项落在 $( a - \epsilon_0 , a+ \epsilon_0)$ 之外，则 ${x_n}$ 一定不以 $a$ 为极限。</p><h2 id="数列极限的性质："><a href="#数列极限的性质：" class="headerlink" title="数列极限的性质："></a>数列极限的性质：</h2><h3 id="唯一性"><a href="#唯一性" class="headerlink" title="唯一性"></a>唯一性</h3><p>若一个数列的极限存在，则极限值是唯一的，且它的任何子列的极限与原数列相等。</p><p>证明，即：若 $a_n \to b, a_n \to c$ 则 $b = c$</p><p>有：</p><script type="math/tex; mode=display">\begin{aligned}\forall \epsilon > 0, \exists N_b > 0, s.t. \forall n > N_b, \mid a_n - b \mid < \epsilon \\\forall \epsilon > 0, \exists N_c > 0, s.t. \forall n > N_c, \mid a_n - c \mid < \epsilon \\\end{aligned}</script><p>记 $N = \max(N_b, N_c)$ 有：</p><script type="math/tex; mode=display">\forall n > N, \mid a_n - c \mid + \mid a_n - b \mid < 2 \epsilon</script><p>由三角不等式 $\mid a \mid - \mid b \mid \le \mid a \pm b \mid \le \mid a \mid + \mid b \mid$ 得：</p><script type="math/tex; mode=display">\mid b - c \mid < 2 \epsilon</script><p>由于 $\epsilon$ 可以无限小，故有 $b = c$</p><p>QED</p><h3 id="有界性"><a href="#有界性" class="headerlink" title="有界性"></a>有界性</h3><p>如果一个数列收敛，则这个数列一定有界。</p><p><strong>但如果一个数列有界，它不一定收敛</strong> $e.g. {x_n}=(-1)^n$</p><h3 id="保号性"><a href="#保号性" class="headerlink" title="保号性"></a>保号性</h3><p>若 $\lim \limits_{n \to +\infty} x_n = a &gt; 0$ （或 $<0$ ） ，则对任何 $m \in ( 0 , a )( a < 0$ 时则是 $m \in ( a , 0 )$ ，存在 $N > 0$ ，使 $n &gt; N$ 时有 $x_n &gt; M$ （相应的是 $x_n&lt;m$ ）</p><h3 id="基本运算法则"><a href="#基本运算法则" class="headerlink" title="基本运算法则"></a>基本运算法则</h3><ul><li>若 $C$ 为常数，则 $\lim \limits_{n \to + \infty} C = C$</li><li>若 $C$ 为常数，则 $\lim \limits_{n \to + \infty} \frac{C}{n} = 0$</li><li>若 $| a | &lt; 1$ ，则 $\lim \limits_{n \to +\infty} a^n = 0$</li><li>如果 $\lim \limits_{n \to +\infty} a_n = A , \lim \limits_{n \to + \infty} b_n =B$ 且 $C$ 为常数。则：</li></ul><script type="math/tex; mode=display">\begin{aligned}\\ \lim \limits_{n \to +\infty} (a_n \pm b_n) = A \pm B\\ \lim \limits_{n \to +\infty} (a_n · b_n) = A · B\end{aligned}</script><h2 id="子数列的极限"><a href="#子数列的极限" class="headerlink" title="子数列的极限"></a>子数列的极限</h2><p>对于一个数列 $\{a_n\}{n = 1}^{+ \infty}$ 的子数列 $\{a{n_k}\}{k = 1}^{+ \infty}$ ，若 $a_n \to \delta$ ，则 $a{n_k} \to \delta$</p><p>证明：</p><p>对于所有 $k$ ，有 $n_k \ge k$ ，又因为 $\forall \epsilon &gt; 0, \exists N &gt; 0, s.t. \forall n &gt; N, \mid a_n - b \mid &lt; \epsilon$</p><p>故 $\forall \epsilon &gt; 0$ ，取 $K = N$ ，有 $\forall k &gt; K, n_k \ge k &gt; K = N$ ，故 $\mid a_{n_k} - b \mid &lt; \epsilon$ ，即 $a_{n_k} \to \delta$</p><p>QED</p><h2 id="级数"><a href="#级数" class="headerlink" title="级数"></a>级数</h2><p>级数是指将数列的项依次用加号连接起来的函数，用 $OIer$ 的话来说就是数列的前缀和，即对于数列 $\{s _n\} _{n = 1}^{+ \infty}$ ，有 $s _n = \sum _{i = 1}^n a _i$ </p><h2 id="数列的和"><a href="#数列的和" class="headerlink" title="数列的和"></a>数列的和</h2><p>对于数列 $\{a _n\} _{n = 1}^{+ \infty}$ ，它的和 $\sum _{n = 1}^{+ \infty} a _n$ 有意义，当且仅当它的级数数列 $\{s _n\} _{n = 1}^{+ \infty}$ 收敛</p><p>正确性显然</p><p>这里补充一个等比数列求和公式（设公比为 $q$ ）： $(1 - q)(1 + q + q^2 + … + q^n) = 1 - q^{n + 1}$</p><h2 id="极限的线性可加性"><a href="#极限的线性可加性" class="headerlink" title="极限的线性可加性"></a>极限的线性可加性</h2><p>设 $a_n \to a, b_m \to b$ ，则 $\lim \limits _{n \to + \infty} (\alpha a_n + \beta b_n) = \alpha a + \beta b$</p><p>证明：</p><script type="math/tex; mode=display">\begin{aligned}& \mid \alpha a _n + \beta b _n - (\alpha a + \beta b) \mid \\\le & \mid \alpha \mid \mid a _n - a \mid + \mid \beta \mid \mid b _n - b \mid \\& = \mid \alpha \mid \epsilon ‘ + \mid \beta \mid \epsilon ‘\end{aligned}</script><h2 id="夹逼定理"><a href="#夹逼定理" class="headerlink" title="夹逼定理"></a>夹逼定理</h2><p>设 $a_n \le b_n \le c_n$ ，且 $\lim \limits _{n \to + \infty} a_n = \lim \limits _{n \to + \infty} c_n$ ，则 $\lim \limits _{n \to + \infty} a_n = \lim \limits _{n \to + \infty} b_n$ </p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> Math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 微积分 </tag>
            
            <tag> 分析数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数与极限</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Math/analytical-mathematics-limits-of-functions/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Math/analytical-mathematics-limits-of-functions/</url>
      
        <content type="html"><![CDATA[<p>“一步一步向前，直到终点”</p><span id="more"></span><p>在了解函数极限之前，我们需要知道一些概念。</p><p><a href="https://dyd-true.github.io/2022/02/12/%E5%87%BD%E6%95%B0%E7%9A%84%E6%9E%81%E9%99%90/#more">资料参考：Dyd巨佬</a></p><h2 id="拓扑空间"><a href="#拓扑空间" class="headerlink" title="拓扑空间"></a>拓扑空间</h2><h3 id="拓扑空间的邻域定义"><a href="#拓扑空间的邻域定义" class="headerlink" title="拓扑空间的邻域定义"></a>拓扑空间的邻域定义</h3><p>设 $X$ 是一个集合， $\mathfrak{U}_x$ 为其子集族，其元称为 $x$ 的<strong>邻域</strong>，令 $\mathfrak{U} = \{ \mathfrak{U}_x \}_{x \in X}$ ，则 $( X , \mathfrak{U})$ 被称为一个<strong>拓扑空间</strong>。</p><h2 id="邻域"><a href="#邻域" class="headerlink" title="邻域"></a>邻域</h2><p>邻域，是指集合上的一种基础的拓扑结构。</p><p>对于实数 $\alpha , \delta$  ：</p><p>定义数集 $\{x \in R \mid a - \delta &lt; x &lt; a + \delta\}$ 为 $a$ 以 $\delta$ 为半径的<strong>邻域</strong>，记做 $U(a, \delta)$ </p><p>定义数集 $\{x \in R \mid a - \delta &lt; x &lt; a 或 a &lt; x &lt; a + \delta\}$ 为 $a$ 以 $\delta$ 为半径的<strong>去心邻域</strong>，记做 $\mathring{U}(a, \delta)$ </p><p> 定义数集 $\{x \in R \mid a - \delta &lt; x &lt; a\}$ 为 $a$ 以 $\delta$ 为半径的<strong>去心左邻域</strong>，记做 $\mathring{U} _- (a, \delta)$ </p><p> 定义数集 $\{x \in R \mid a &lt; x &lt; a + \delta\}$ 为 $a$ 以 $\delta$ 为半径的<strong>去心右邻域</strong>，记做 $\mathring{U} _+ (a, \delta)$ </p><p>函数的左极限和右极限统称为<strong>侧边极限</strong></p><p>明显， $\lim \limits _{x \to {x _0} _+} f(x) = a$ 且 $\lim \limits _{x  \to {x _0} _-} f(x) = a$ 与 $\lim \limits _{x \to x _0} f(x) = a$ 互为充要条件</p><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><h3 id="唯一性"><a href="#唯一性" class="headerlink" title="唯一性"></a>唯一性</h3><p>若 $f(x) \to a(x \to r)$ 且 $f(x) \to b (x \to r)$ ，则 $a = b$</p><h3 id="局部有界"><a href="#局部有界" class="headerlink" title="局部有界"></a>局部有界</h3><p>若在某一个过程时 $f(x)$ 有极限，则存在一个时刻以后 $f(x)$ 有界。</p><p>即若极限 $\lim \limits_{x \to x_0} f(x)$ 存在，则函数 $f(x)$ 在 $x_0$ 的某一空心邻域上有界。</p><h3 id="局部保号性"><a href="#局部保号性" class="headerlink" title="局部保号性"></a>局部保号性</h3><p>若 $\lim \limits_{x \to x_0} f(x) = A$ ，且 $A &gt; 0$ ，则 $\exists \delta &gt; 0$ ，当 $x \in U^0 ( x_0 , \delta )$ 时， $ f(x)&gt;0 $ 。</p><h3 id="迫敛性"><a href="#迫敛性" class="headerlink" title="迫敛性"></a>迫敛性</h3><p>如果函数 $f(x),g(x),h(x)$ 满足：</p><ol><li>$g(x) \leq f(x) \leq h(x)$ </li><li>$\lim g(x) = A , \lim h(x) = A$ </li></ol><p>那么 $\lim f(x)$ 存在且为 $A$ 。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> Math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 微积分 </tag>
            
            <tag> 分析数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OIP2022.03.05模拟赛</title>
      <link href="/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220305/"/>
      <url>/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220305/</url>
      
        <content type="html"><![CDATA[<p>“<del>提高模拟能考出省选题来</del>“</p><span id="more"></span><h2 id="题目I——最短路径-path"><a href="#题目I——最短路径-path" class="headerlink" title="题目I——最短路径(path)"></a>题目I——最短路径(path)</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>一个 $N$ 个点，$M$ 条边的有向权值图，求全源最短路中每条边被经过的次数。</p><p><strong>最短路径</strong>：从 $a$ 到 $b$ 的最短路径是指一条路径当且仅当不存在另一条从 $a -&gt; b$ 的路径比该路径更短。</p><blockquote><p>意思是<strong>两点之间的最短路径不止一条</strong></p></blockquote><p>求每条边通过的最短路径的个数。取模 $10^9+7$。</p><h3 id="思路I"><a href="#思路I" class="headerlink" title="思路I"></a>思路I</h3><p>用 $Spfa$ 跑 $n$ 遍最短路，跑完之后枚举每条边，记录所有满足 $val_i+c_{i,j}=val_j$ 的边。再以此对于每一遍 $Spfa$ 跑一遍 $Topo$ 排序。</p><h3 id="思路II"><a href="#思路II" class="headerlink" title="思路II"></a>思路II</h3><p>依然是跑 $n$ 遍最短路，求出<strong>最短路径图</strong>，即只含最短路的边。用 $f_i$ 表示从 $1$ 点至 $i$ 点有多少条路径， $g_i$ 表示从 $i$ 号点往后走有多少条路径。则以 $i$ 为起点的所有最短路中，经过 $c_j(u,v)$ 边的路径条数为 $f_u*g_v$</p><h3 id="另话"><a href="#另话" class="headerlink" title="另话"></a>另话</h3><p>这道题在洛谷上是双倍经验。一道紫一道灰。<del>这样做 $NOIp$ 模拟的第一题真的好吗</del></p><h3 id="Task-One-Ac-Code"><a href="#Task-One-Ac-Code" class="headerlink" title="Task One Ac Code"></a>Task One Ac Code</h3><details>    <summary>思路I</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1501</span>,MAXM=<span class="number">5001</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> Mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=x*<span class="number">10</span>+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,u,v,w;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from,to,next,val;</span><br><span class="line">&#125;Edge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> First[MAXN],Total,Dist[MAXN],Que[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">bool</span> Vis[MAXN],Is[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAdd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(Node)&#123;x,y,First[x],z&#125;;First[x]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underSPFA</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(Dist,<span class="number">0x7f7f7f7f</span>,<span class="built_in">sizeof</span>(Dist));</span><br><span class="line">    <span class="built_in">memset</span>(Is,<span class="number">0</span>,<span class="built_in">sizeof</span>(Is));</span><br><span class="line">    <span class="keyword">register</span> <span class="type">int</span> len;</span><br><span class="line">    Dist[Que[len=<span class="number">1</span>]=x]=<span class="number">0</span>,Vis[x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=len;++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> u=Que[i];Vis[u]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=First[u],v;e;e=Edge[e].next)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(Dist[u]+Edge[e].val&lt;Dist[v=Edge[e].to])</span><br><span class="line">&#123;</span><br><span class="line">    Dist[v]=Dist[u]+Edge[e].val;</span><br><span class="line">    <span class="keyword">if</span>(!Vis[v]) Vis[Que[++len]=v]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(Dist[Edge[i].from]+Edge[i].val==Dist[Edge[i].to])</span><br><span class="line">&#123;</span><br><span class="line">    Is[i]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> Deg[MAXN],Cnt[<span class="number">3</span>][MAXN],Ord[MAXN],len,Ans[MAXM];</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;Q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underTopo</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>()) Q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="built_in">memset</span>(Deg,<span class="number">0</span>,<span class="built_in">sizeof</span>(Deg));</span><br><span class="line">    <span class="built_in">memset</span>(Cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(Cnt));</span><br><span class="line">    len=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i) <span class="keyword">if</span>(Is[i]) ++Deg[Edge[i].to];</span><br><span class="line">    Q.<span class="built_in">push</span>(s); Cnt[<span class="number">1</span>][s]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> u=Q.<span class="built_in">front</span>();Q.<span class="built_in">pop</span>();</span><br><span class="line">    Ord[++len]=u;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=First[u];e;e=Edge[e].next)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!Is[e]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="type">int</span> v=Edge[e].to;</span><br><span class="line">    Cnt[<span class="number">1</span>][v]=(Cnt[<span class="number">1</span>][v]+Cnt[<span class="number">1</span>][u])%Mod;</span><br><span class="line">    <span class="keyword">if</span>(--Deg[v]==<span class="number">0</span>) Q.<span class="built_in">push</span>(v);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=len;j&gt;=<span class="number">1</span>;--j)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x=Ord[j];++Cnt[<span class="number">2</span>][x];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=First[x];e;e=Edge[e].next)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!Is[e]) <span class="keyword">continue</span>;</span><br><span class="line">    Cnt[<span class="number">2</span>][x]=(Cnt[<span class="number">2</span>][x]+Cnt[<span class="number">2</span>][Edge[e].to])%Mod;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;path.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;path.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;N,&amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;u,&amp;v,&amp;w);</span><br><span class="line">    <span class="built_in">underAdd</span>(u,v,w);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">underSPFA</span>(i);<span class="built_in">underTopo</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(Is[j]) Ans[j]=(Ans[j]+<span class="number">1ll</span>*Cnt[<span class="number">1</span>][Edge[j].from]*Cnt[<span class="number">2</span>][Edge[j].to]%Mod)%Mod;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,Ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 4</span></span><br><span class="line"><span class="comment">1 2 5</span></span><br><span class="line"><span class="comment">2 3 5</span></span><br><span class="line"><span class="comment">3 4 5</span></span><br><span class="line"><span class="comment">1 4 8</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></details><details>    <summary>思路II</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> P = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> x, y, w, next, ans;</span><br><span class="line">    <span class="type">bool</span> flag;</span><br><span class="line">&#125; map[<span class="number">5101</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m, st, ed;</span><br><span class="line"><span class="type">int</span> d[<span class="number">1510</span>], r[<span class="number">1510</span>], dis[<span class="number">1510</span>], f[<span class="number">1510</span>], g[<span class="number">1510</span>], head[<span class="number">1510</span>];</span><br><span class="line"><span class="type">bool</span> flag[<span class="number">1510</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dis[a] &lt; dis[b];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">    map[c].x = x;</span><br><span class="line">    map[c].y = y;</span><br><span class="line">    map[c].w = w;</span><br><span class="line">    map[c].ans = <span class="number">0</span>;</span><br><span class="line">    map[c].next = head[x];</span><br><span class="line">    head[x] = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;path.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;path.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">        head[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> x, y, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;w);</span><br><span class="line">        x --; y --;</span><br><span class="line">        <span class="built_in">add_edge</span>(x, y, w, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) r[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> start=<span class="number">0</span>; start&lt;n; start++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) dis[i] = <span class="number">99999999</span>;</span><br><span class="line">        dis[start] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) flag[i] = <span class="literal">true</span>;</span><br><span class="line">        flag[start] = <span class="literal">false</span>;</span><br><span class="line">        st = ed = <span class="number">0</span>;</span><br><span class="line">        d[ed++] = start;</span><br><span class="line">        <span class="keyword">while</span> (st &lt; ed) &#123;</span><br><span class="line">            <span class="type">int</span> i = d[(st++) % n];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=head[i]; j&gt;<span class="number">-1</span>; j=map[j].next)</span><br><span class="line">                <span class="keyword">if</span> (dis[i] + map[j].w &lt; dis[map[j].y]) &#123;</span><br><span class="line">                    dis[map[j].y] = dis[i] + map[j].w;</span><br><span class="line">                    <span class="keyword">if</span> (flag[map[j].y]) &#123;</span><br><span class="line">                        flag[map[j].y] = <span class="literal">false</span>;</span><br><span class="line">                        d[(ed++) % n] = map[j].y;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            flag[i] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//for (int i=0; i&lt;n; i++)</span></span><br><span class="line">        <span class="comment">//    printf(&quot;%d--&gt;%d: %d\n&quot;, start, i, dis[i]);</span></span><br><span class="line">        <span class="comment">//printf(&quot;start: %d\n&quot;, start);</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;m; i++)</span><br><span class="line">            <span class="keyword">if</span> (dis[map[i].x] + map[i].w == dis[map[i].y]) &#123;</span><br><span class="line">                map[i].flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//        printf(&quot;%d--&gt;%d(%d)  &quot;, map[i].x, map[i].y, map[i].w);</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                map[i].flag = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">        <span class="built_in">sort</span>(r, r+n, cmp);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) f[i] = <span class="number">0</span>;</span><br><span class="line">        f[start] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=head[r[i]]; j&gt;<span class="number">-1</span>; j=map[j].next)</span><br><span class="line">                <span class="keyword">if</span> (map[j].flag)</span><br><span class="line">                    f[map[j].y] = (f[map[j].y] + f[r[i]]) % P;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//for (int i=0; i&lt;n; i++)</span></span><br><span class="line">        <span class="comment">//    printf(&quot;f[%d]=%d  &quot;, i, f[i]);</span></span><br><span class="line">        <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;<span class="number">0</span>; i--) &#123;</span><br><span class="line">            g[r[i]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=head[r[i]]; j&gt;<span class="number">-1</span>; j=map[j].next)</span><br><span class="line">                <span class="keyword">if</span> (map[j].flag)</span><br><span class="line">                    g[r[i]] = (g[r[i]] + g[map[j].y]) % P;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//for (int i=0; i&lt;n; i++)</span></span><br><span class="line">        <span class="comment">//    printf(&quot;g[%d]=%d  &quot;, i, g[i]);</span></span><br><span class="line">        <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;m; i++)</span><br><span class="line">            <span class="keyword">if</span> (map[i].flag) &#123;</span><br><span class="line">                <span class="comment">//printf(&quot;%d--&gt;%d  &quot;, map[i].x, map[i].y);</span></span><br><span class="line">                map[i].ans = (map[i].ans + g[map[i].y] * (<span class="type">long</span> <span class="type">long</span>)(f[map[i].x])) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;m; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, map[i].ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h2 id="题目II——数列-seq"><a href="#题目II——数列-seq" class="headerlink" title="题目II——数列(seq)"></a>题目II——数列(seq)</h2><h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p>对于一个长度为 $n$ 的数列，有 $m$ 个询问：</p><ol><li>$C\ i\ x$ 表示将下标为 $i$ 的数改为 $x$</li><li>$Q\ i$ 求满足 $\forall i \leq k \leq j,A_k \leq \max\{A_i,A_j\}$ 中 $j$ 的个数</li></ol><p>复杂度不大于 $O(n \log n)$</p><h3 id="题意思路"><a href="#题意思路" class="headerlink" title="题意思路"></a>题意思路</h3><p>根据其查询，我们需要找到所有的“谷段”，即如果我们将整个数列看作一个波峰图，如下图所示：</p><p><img src="https://violeteternal.github.io/blog/post-images/1646537618216.png" alt=""></p><p>那么我们就需要找到所有类似于开口向上的二次函数的个数。不难发现：当我们第一次找到 $A_p \leq A_j$ 时，$p$ 到 $j$ 之间的任意位置都是满足要求的。</p><p>然而，当第一次：</p><blockquote><p>当 $A_p = A_j$ 时，对于 $j$ 之后下一个满足要求的位置 $k$ 时，$j$ 与 $k$ 之间的任意位置也是可以取的。</p><p>而当 $A_p &lt; A_j$ 时，对于 $j$ 之后下一个满足要求的位置 $k$ 时，就仅仅只能取 $k$ 位置了。</p></blockquote><p>其缘由读者可自行思考。</p><h3 id="算法思路"><a href="#算法思路" class="headerlink" title="算法思路"></a>算法思路</h3><p><del>又是线段树打爆的一天</del></p><p>使用一种类似分块但胜似分块的神奇思路。</p><p>将整个数列分成 $\sqrt n$ 段：</p><ol><li>对于每一段，维护其向左向右的递增序列；</li><li>对于相邻的段，维护其向左向右的递增序列。</li></ol><p><del>虽然我觉得这题解类似没写又胜似没写</del></p><p>用 $L_i$ 存储第 $i$ 段的左坐标，$R_i$ 存储第 $i$ 段的右坐标。数组 $Bel_i$ 存储 $i$ 位置所属的段编号。</p><h4 id="初始化-修改操作"><a href="#初始化-修改操作" class="headerlink" title="初始化/修改操作"></a>初始化/修改操作</h4><p>对于每一段都有一个数 $top$ 和一个数组 $st_i$ 。$st$ 数组存储的是该区间内的最长不下降子序列，而 $top$ 则是 $st$ 数组的长度。然后求就完事儿了，复杂度 $O(\sqrt n)$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> st[],<span class="type">int</span> &amp;top)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">top=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=r;i&gt;=l;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(top&amp;&amp;Num[st[top]]&lt;Num[i]) --top;</span><br><span class="line">st[++top]=i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="查询操作"><a href="#查询操作" class="headerlink" title="查询操作"></a>查询操作</h4><p>暴力求本区间，复杂度 $O(\sqrt n )$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> bl=Bel[p],Max=Num[p];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>;i&lt;=R[bl];++i)</span><br><span class="line">&#123;</span><br><span class="line">    Max=<span class="built_in">underMax</span>(Max,Num[i]);</span><br><span class="line">    <span class="keyword">if</span>(Max&lt;=<span class="built_in">underMax</span>(Num[p],Num[i])) ++ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>记查询点为 $p$ ,则对于 $Bel_p+1$ 到 $Bel_n$ 的区间操作为：</p><p>二分该区间的 $st$ 数组，找到第一个 $l$ 位置满足 $A_p \leq A_l$ ，如果当前 $Max$ 与 $A_p$ 是相等的，则可以计算该区间 $l$ 之前的任意位置；反之，计算 $l$ 之后的个数和（不比 $A_p$ 小的个数），当然，$Max=A_p$ 时也要计算该区间。</p><p>然后更改 $Max$ 值，查找下一区间。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl+<span class="number">1</span>;i&lt;=num;++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l=<span class="number">0</span>,r=Top[i];</span><br><span class="line">    <span class="keyword">if</span>(Max==Num[p])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(Num[St[i][mid]]&gt;Max) l=mid;</span><br><span class="line">            <span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l==<span class="number">0</span>) ans+=R[i]-L[i]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ans+=St[i][l]<span class="number">-1</span>-L[i]+<span class="number">1</span>;</span><br><span class="line">            ans+=l<span class="number">-1</span>+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(Num[St[i][mid]]&gt;=Max) l=mid;</span><br><span class="line">            <span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans+=l<span class="number">-1</span>+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Max=<span class="built_in">underMax</span>(Max,Num[St[i][<span class="number">1</span>]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br></pre></td></tr></table></figure><h3 id="另话-1"><a href="#另话-1" class="headerlink" title="另话"></a>另话</h3><p>这道题题意很简单，主要原因还是时间复杂度的问题。我使用线段树二分查找的复杂度不稳定，<del>所以很氢凇被卡了</del></p><h3 id="Task-Two-Ac-Code"><a href="#Task-Two-Ac-Code" class="headerlink" title="Task Two Ac Code"></a>Task Two Ac Code</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">50001</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">101</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXB=<span class="number">1001</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,Num[MAXN],Qi,Qx;</span><br><span class="line"><span class="type">char</span> op;</span><br><span class="line"><span class="type">int</span> Bel[MAXN],L[MAXM],R[MAXM],St[MAXM][MAXB],Top[MAXM];</span><br><span class="line"><span class="comment">/*struct SegmentTree</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">int l,r,dat;</span></span><br><span class="line"><span class="comment">&#125;Tree[MAXN&lt;&lt;2];*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underMax</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (a&gt;b?a:b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underMin</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (a&lt;b?a:b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*inline void underPushUp(int p)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">Tree[p].dat=underMax(Tree[p&lt;&lt;1].dat,Tree[p&lt;&lt;1|1].dat);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline bool underCheck(int p)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(Tree[p].dat==Num[Tree[p].l]||Tree[p].dat==Num[Tree[p].r]) return 1;</span></span><br><span class="line"><span class="comment">return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underBuild(int p,int l,int r)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">Tree[p].l=l,Tree[p].r=r;</span></span><br><span class="line"><span class="comment">if(l==r)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">Tree[p].dat=Num[l];</span></span><br><span class="line"><span class="comment">return ;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">int mid=(l+r)&gt;&gt;1;</span></span><br><span class="line"><span class="comment">underBuild(p&lt;&lt;1,l,mid),underBuild(p&lt;&lt;1|1,mid+1,r);</span></span><br><span class="line"><span class="comment">underPushUp(p);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underModify(int p,int d,int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(Tree[p].l==d&amp;&amp;Tree[p].r==d)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">Tree[p].dat=x;</span></span><br><span class="line"><span class="comment">return ;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">int mid=(Tree[p].l+Tree[p].r)&gt;&gt;1;</span></span><br><span class="line"><span class="comment">if(d&lt;=mid) underModify(p&lt;&lt;1,d,x);</span></span><br><span class="line"><span class="comment">if(mid&lt;d) underModify(p&lt;&lt;1|1,d,x);</span></span><br><span class="line"><span class="comment">underPushUp(p);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline int underQueryMax(int p,int l,int r)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(l&lt;=Tree[p].l&amp;&amp;Tree[p].r&lt;=r) return Tree[p].dat;</span></span><br><span class="line"><span class="comment">int mid=(Tree[p].l+Tree[p].r)&gt;&gt;1;</span></span><br><span class="line"><span class="comment">int val=-INF;</span></span><br><span class="line"><span class="comment">if(l&lt;=mid) val=underMax(val,underQueryMax(p&lt;&lt;1,l,r));</span></span><br><span class="line"><span class="comment">if(mid&lt;r) val=underMax(val,underQueryMax(p&lt;&lt;1|1,l,r));</span></span><br><span class="line"><span class="comment">return val;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underNeverGonnaGiveYouUp()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">for(int i=1;i&lt;=M;++i)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">scanf(&quot;%c&quot;,&amp;op);</span></span><br><span class="line"><span class="comment">if(op==&#x27;Q&#x27;)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">underRead(Qi);</span></span><br><span class="line"><span class="comment">int Ans=0,Maxn=Num[Qi];</span></span><br><span class="line"><span class="comment">for(int j=Qi+1;j&lt;=N;++j)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">Maxn=underMax(Maxn,Num[j]);</span></span><br><span class="line"><span class="comment">if(Maxn&lt;=Num[Qi]||Maxn&lt;=Num[j]) ++Ans;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">printf(&quot;%d\n&quot;,Ans);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">else</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">underRead(Qi),underRead(Qx);</span></span><br><span class="line"><span class="comment">Num[Qi]=Qx;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">exit(0);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline int underExpr(int p,int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(x==N) return 0;</span></span><br><span class="line"><span class="comment">if(underQueryMax(1,x+1,N)&lt;Num[x])</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(p&gt;1) return 0;</span></span><br><span class="line"><span class="comment">else return N-x;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">int l=x+1,r=N;</span></span><br><span class="line"><span class="comment">while(l&lt;r)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">int mid=(l+r)&gt;&gt;1;</span></span><br><span class="line"><span class="comment">int val=underQueryMax(1,x+1,mid);</span></span><br><span class="line"><span class="comment">if(val&lt;Num[x]) l=mid+1;</span></span><br><span class="line"><span class="comment">else r=mid;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">//printf(&quot;[%d,%d] &quot;,x,l);</span></span><br><span class="line"><span class="comment">if(p&gt;1) return 1+underExpr(p,l);</span></span><br><span class="line"><span class="comment">else if(Num[l]==Num[x]) return l-x+underExpr(p,l);</span></span><br><span class="line"><span class="comment">else return l-x+underExpr(p+1,l);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> st[],<span class="type">int</span> &amp;top)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">top=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=r;i&gt;=l;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(top&amp;&amp;Num[st[top]]&lt;Num[i]) --top;</span><br><span class="line">st[++top]=i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQuery</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> bl=Bel[p],Max=Num[p];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>;i&lt;=R[bl];++i)</span><br><span class="line">&#123;</span><br><span class="line">Max=<span class="built_in">underMax</span>(Max,Num[i]);</span><br><span class="line"><span class="keyword">if</span>(Max&lt;=<span class="built_in">underMax</span>(Num[p],Num[i])) ++ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl+<span class="number">1</span>;i&lt;=num;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l=<span class="number">0</span>,r=Top[i];</span><br><span class="line"><span class="keyword">if</span>(Max==Num[p])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(Num[St[i][mid]]&gt;Max) l=mid;</span><br><span class="line"><span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(l==<span class="number">0</span>) ans+=R[i]-L[i]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ans+=St[i][l]<span class="number">-1</span>-L[i]+<span class="number">1</span>;</span><br><span class="line">ans+=l<span class="number">-1</span>+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(Num[St[i][mid]]&gt;=Max) l=mid;</span><br><span class="line"><span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">ans+=l<span class="number">-1</span>+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">Max=<span class="built_in">underMax</span>(Max,Num[St[i][<span class="number">1</span>]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;seq.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;seq.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;N,&amp;M);</span><br><span class="line"><span class="type">int</span> siz=<span class="built_in">sqrt</span>(N*<span class="built_in">log2</span>(N)),num=(N+siz<span class="number">-1</span>)/siz;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;Num[i]),Bel[i]=(i+siz<span class="number">-1</span>)/siz;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i)</span><br><span class="line">&#123;</span><br><span class="line">L[i]=R[i<span class="number">-1</span>]+<span class="number">1</span>,R[i]=<span class="built_in">underMin</span>(i*siz,N);</span><br><span class="line"><span class="built_in">underModify</span>(L[i],R[i],St[i],Top[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//if(N&lt;=5000) underNeverGonnaGiveYouUp();</span></span><br><span class="line">    <span class="comment">/*underBuild(1,1,N);*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> T=<span class="number">1</span>;T&lt;=M;++T)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;op;</span><br><span class="line"><span class="keyword">if</span>(op==<span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;Qi);</span><br><span class="line"><span class="comment">/*if(underQueryMax(1,Qi,N)==Num[Qi]) printf(&quot;%d\n&quot;,N-Qi);</span></span><br><span class="line"><span class="comment">else if(Tree[1].dat==Num[Qi])printf(&quot;%d\n&quot;,N-Qi);</span></span><br><span class="line"><span class="comment">else printf(&quot;%d\n&quot;,underExpr(1,Qi));</span></span><br><span class="line"><span class="comment">printf(&quot;%d\n&quot;,underQuery(1,Qi-1,Qi+1));*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underQuery</span>(Qi,num));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;Qi,&amp;Qx);</span><br><span class="line">Num[Qi]=Qx;</span><br><span class="line"><span class="type">int</span> bl=Bel[Qi];</span><br><span class="line"><span class="built_in">underModify</span>(L[bl],R[bl],St[bl],Top[bl]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 3</span></span><br><span class="line"><span class="comment">1 3 2 3 2</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment">C 1 3</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">10 12</span></span><br><span class="line"><span class="comment">1 2 3 4 5 6 7 8 9 10</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment">C 1 10</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment">C 2 11</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment">C 3 11</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment">C 4 10</span></span><br><span class="line"><span class="comment">C 5 11</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment">C 1 11</span></span><br><span class="line"><span class="comment">Q 1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1 5 3 6 3 3 6</span></span><br><span class="line"><span class="comment">st[1]=6 top=1 i=7</span></span><br><span class="line"><span class="comment">st[2]=6,3 top=2 i=6</span></span><br><span class="line"><span class="comment">st[3]=6,3,3 top=3 i=5</span></span><br><span class="line"><span class="comment">st[2]=6,6 top=2 i=4</span></span><br><span class="line"><span class="comment">st[3]=6,6,3 top=3 i=3</span></span><br><span class="line"><span class="comment">st[3]=6,6,5 top=3 i=2</span></span><br><span class="line"><span class="comment">st[4]=6,6,5,1 top=4 i=1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 模拟赛/比赛 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 优化 </tag>
            
            <tag> RMQ </tag>
            
            <tag> 数论 </tag>
            
            <tag> 最短路 </tag>
            
            <tag> 图论 </tag>
            
            <tag> SPFA </tag>
            
            <tag> 二分 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 面积并 </tag>
            
            <tag> 几何 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF19B Checkout Assistant</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/cf19b/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/cf19b/</url>
      
        <content type="html"><![CDATA[<p>$01$背包变形<br><span id="more"></span><br><a href="https://www.luogu.com.cn/problem/CF19B">题目传送门</a></p><p><del>虽然我也不知道为什么被卡了反正就是听取WA声一片</del></p><p>扫描第$i$件物品能够得到$t_i+1$件物品，则将题目转化为：</p><p>一共有$n$件物品，第$i$件物品的体积为$t_i+1$，价值为$c_i$。</p><p>$AC\ Code$：</p><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M=<span class="number">2005</span>,N=<span class="number">4005</span>;</span><br><span class="line"><span class="type">int</span> n,t[M],v;</span><br><span class="line">ll c[M],dp[N],ans=<span class="number">2e12</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%lld&quot;</span>,&amp;t[i],&amp;c[i]);</span><br><span class="line">t[i]++;</span><br><span class="line">v=<span class="built_in">max</span>(v,t[i]);</span><br><span class="line">&#125;</span><br><span class="line">v+=n;</span><br><span class="line"><span class="built_in">memset</span>(dp,<span class="number">0x7f</span>,<span class="built_in">sizeof</span>(dp));dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=v;j&gt;=t[i];j--)</span><br><span class="line">dp[j]=<span class="built_in">min</span>(dp[j],dp[j-t[i]]+c[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i&lt;=v;i++)</span><br><span class="line">ans=<span class="built_in">min</span>(ans,dp[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 背包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络最大流Dinic</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/maximum-flow-of-dinic/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/maximum-flow-of-dinic/</url>
      
        <content type="html"><![CDATA[<p>“我从起点出发，送给你源源不尽的爱”</p><span id="more"></span><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><h3 id="网络流"><a href="#网络流" class="headerlink" title="网络流"></a>网络流</h3><p>所谓网络，实则为一个带权有向图$(V,E)$。对于每一条边$(x,y)$存在一个数据$c(x,y)$表示该边的容量。对于一个网络，有两个点是特殊的：<strong>源点</strong>$S$与<strong>汇点</strong>$T$。</p><p>可以把网络流看作水库出水，而<strong>源点</strong>则是水库，<strong>汇点</strong>就是你家。源点的“量”是无限的，中途的任何一个点不存储任意一点流量也不会产生任何一点流量，所以源点出发的所有流量必定流入汇点。而经过每一条边的<strong>最大流量</strong>，即是$c(x,y)$</p><p>最大流的算法，就是在满足流过边$c$的流量满足$\leq c(x,y)$的情况下，汇点的流量最大的问题。</p><h3 id="增广路"><a href="#增广路" class="headerlink" title="增广路"></a>增广路</h3><ol><li>增广路是一条链。（链是网络中的一个顶点序列，这个序列中前后两个顶点有弧相连）</li><li>链上的前向弧都是非饱和弧，链上的后向弧都是非零弧。（前向弧即输入的边，后向弧即建立的反边）</li><li>链的起点是源点，终点是汇点。</li></ol><p>增广路是一个<strong>边的集合</strong>，从$S$至$T$的一条路径。增广路的<strong>最大流量</strong>表示该路径经过的边中流量最小的边的流量，即：</p><blockquote><p>一条增广路$i$的边集是$E_i$，最大流量是$c$，则$\forall r \in E , c_r \leq c$</p></blockquote><p>用<a href="https://2745518585.github.io/post/maximum-flow-Dinic/">赵悦岑巨佬</a>的话来讲，增广路指的就是一条从源点到汇点，且经过的边最小容量不为$0$的路径。而我们寻找增广路之后，就会将所有经过的边的容量减去增广路的流量。但是，这种算法并不保险。所以我们对于每一条存在的$c(x,y)$，都建立其后向弧满足$c(y,x)=0$使得我们在后续寻找增广路时可以“反悔”，使其不因之前的错误增广路而影响。</p><p>我们对于每一条边都增加一条容量为$0$反向边，找到增广路后经过的边流量要减去此增广路的流量，其反向边的流量还要加上此增广路的流量。所有反向边组成的图就是<strong>残留网络</strong>。</p><h3 id="残余网络"><a href="#残余网络" class="headerlink" title="残余网络"></a>残余网络</h3><p>我们设$f(x,y)$为边$(x,y)$的实际容量。</p><ul><li>饱和弧：$f(x,y)=c(x,y)$，流量为该边的容量</li><li>非饱和弧：$f(x,y)&lt;c(x,y)$，实际流量小于容量</li><li>零流弧：$f(x,y)=0$，该边未流过流量。</li><li>非零流弧：$f(x,y)&gt;0$，当前流量不为$0$</li></ul><p><strong>残余网络</strong>：设有容量网络$G(V,E)$及其上的网络流$f$，$G$关于$f$的残留网络即为$G(V’,E’)$，其中$G’$的顶点集$V’$和$G$的顶点集$V$相同，即$V’=V$，对于$G$中任何一条弧$(u,v)$，如果$f(u,v)<c(u,v)$，那么在$G'$中有一条弧$(u,v)∈E'$，其容量为$c'(u,v)=c(u,v)-f(u,v)$，如果$f(u,v)>0$，则在$G'$中有一条弧$<v,u>∈E’$，其容量为$c’(v,u)=f(u,v)$。</p><p>从残留网络的定义来看，原容量网络中的每条弧在残留网络中都化为一条或者两条弧。在残留网络中，从源点到汇点的任意一条简单路径都对应一条增光路，路径上每条弧容量的最小值即为能够一次增广的最大流量。</p><p><img src="https://images2015.cnblogs.com/blog/364303/201611/364303-20161128223853256-1111255618.png" alt="img"></p><h3 id="Dinic"><a href="#Dinic" class="headerlink" title="Dinic"></a>Dinic</h3><ul><li><p>每次多路增广：$u$点通过一条边，向$v$输出流量以后，$v$会尝试到达汇点（到达汇点才真正增广），然后$v$返回实际增广量。这时，<strong>如果$u$还有没用完的供给，就继续尝试输出到其它边。</strong></p><p>但是要警惕绕远路、甚至绕回的情况，不加管制的话极易发生。怎么管？</p></li><li><p>源点<strong>顺着残量网络</strong>想要到达其它点，需要经过一些边对吧？<strong>按照经过的边数（即源点出发以后的距离）把图分层，即用$bfs$分层。</strong> 每次尝试给予时，<strong>只考虑给予自己下一层的点</strong>，就可以防止混乱。</p></li><li><p>综合上面两条。每回合也是从源点出发，<strong>先按照当前残量网络分一次层</strong>，随后多路增广，尽可能增加流量。增广过程中，会加入一些反向边，这些反向边逆着层次图，本回合并不会走。所以还需要进入下一回合。一直到$bfs$分层时搜不到汇点（即残量网络断了）为止。</p></li></ul><p>$Dinic$首先$bfs$对网络进行分层，构成一张分层图。然后进行$dfs$寻找当前的最大流。直到$bfs$无法达到汇点，则整个算法停止。</p><h3 id="Dinic的当前弧优化"><a href="#Dinic的当前弧优化" class="headerlink" title="Dinic的当前弧优化"></a>Dinic的当前弧优化</h3><p>$dfs$过程中我们会一直流直到把一条边流完再转到下一条边，如果一条边有容量但是却没有增广路，说明这条边的下一个点已经没有更多容量了，我们就可以把连接的这个点的高度标记为$0$，下一次就不会再搜索到这个点了。</p><p>不过$Dinic$还是很慢，甚至比$EK$还慢，这时候我们就需要拯救$Dinic$的当前弧优化。上面说到，$dfs$过程中会一直流直到把一条边流完再转到下一条边，当搜索到一条边的时候说明这条边之前的所有边都已经没有增广路了，我们就可以直接将$t$指向这条边，这样下一次就不会再次搜索已经没有流量的边了。</p><h2 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h2><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e4</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">1e4</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m,s,t,u,v;</span><br><span class="line">ll r;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> next,to;</span><br><span class="line">    ll val;</span><br><span class="line">    <span class="built_in">edge</span>(<span class="type">int</span> n=<span class="number">0</span>,<span class="type">int</span> t=<span class="number">0</span>,ll v=<span class="number">0</span>):<span class="built_in">next</span>(n),<span class="built_in">to</span>(t),<span class="built_in">val</span>(v)&#123;&#125;</span><br><span class="line">&#125;Edge[MAXM];</span><br><span class="line"><span class="type">int</span> First[MAXN],Total=<span class="number">1</span>,t0[MAXN];</span><br><span class="line">ll f[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Que</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> u,r;</span><br><span class="line">    <span class="built_in">Que</span>(<span class="type">int</span> u=<span class="number">0</span>,<span class="type">int</span> r=<span class="number">0</span>):<span class="built_in">u</span>(u),<span class="built_in">r</span>(r)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAdd</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,ll r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Edge[++Total]=(edge)&#123;First[u],v,r&#125;,First[u]=Total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">underBfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;Q;</span><br><span class="line">    Q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">    f[s]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u=Q.<span class="built_in">front</span>();Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> e=First[u];e;e=Edge[e].next)</span><br><span class="line">            <span class="keyword">if</span>(!f[Edge[e].to]&amp;&amp;Edge[e].val)</span><br><span class="line">            &#123;</span><br><span class="line">                f[Edge[e].to]=f[u]+<span class="number">1</span>;</span><br><span class="line">                Q.<span class="built_in">push</span>(Edge[e].to);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[t]!=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">underDfs</span><span class="params">(<span class="type">int</span> x,ll r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==t) <span class="keyword">return</span> r;</span><br><span class="line">    ll S=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e=t0[x];e;e=Edge[e].next)</span><br><span class="line">    &#123;</span><br><span class="line">        t0[x]=e;</span><br><span class="line">        <span class="keyword">if</span>(f[Edge[e].to]==f[x]+<span class="number">1</span>&amp;&amp;Edge[e].val)</span><br><span class="line">        &#123;</span><br><span class="line">            ll k=<span class="built_in">underDfs</span>(Edge[e].to,<span class="built_in">underMin</span>(r,Edge[e].val));</span><br><span class="line">            <span class="keyword">if</span>(k)</span><br><span class="line">            &#123;</span><br><span class="line">                Edge[e].val-=k;</span><br><span class="line">                Edge[e^<span class="number">1</span>].val+=k;</span><br><span class="line">                r-=k,S+=k;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> f[Edge[e].to]=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(!r) <span class="keyword">return</span> S;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> S;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;maxinum-flow.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;maxinum-flow.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;s,&amp;t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>,&amp;u,&amp;v,&amp;r);</span><br><span class="line">        <span class="built_in">underAdd</span>(u,v,r),<span class="built_in">underAdd</span>(v,u,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ll R=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">underBfs</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) t0[i]=First[i];</span><br><span class="line">        R+=<span class="built_in">underDfs</span>(s,INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,R);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 5 4 3</span></span><br><span class="line"><span class="comment">4 2 30</span></span><br><span class="line"><span class="comment">4 3 20</span></span><br><span class="line"><span class="comment">2 3 20</span></span><br><span class="line"><span class="comment">2 1 30</span></span><br><span class="line"><span class="comment">1 3 40</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 最大流 </tag>
            
            <tag> 网络流 </tag>
            
            <tag> Dinic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ST表（Sparse Table，稀疏表）</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/sparse-table/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/sparse-table/</url>
      
        <content type="html"><![CDATA[<p>“聚二为一”</p><span id="more"></span><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>$ST$ 表是一种用来求 $RMQ$ ，即区间最值问题的数据结构。其速度极快，可以做到 $O(n \log n)$ 的预处理以及 $O(1)$ 的查询时，且可以在线查询。</p><p>$ST$ 表运用到了倍增的思想，将整个数列存储在一个二维数组 $f$ 中。其中：</p><blockquote><p>$f_{i,j}$ 表示区间 $[f_{i,j},f_{i,i+2^j-1}]$ 的最值。</p></blockquote><p>而查询的思路便是将区间分成左右两部分并取出两部分的最值。</p><p>对于区间 $[l,r]$ 的最大值，则是 $\max\{f_{l,k},f_{r-k+1,k}\}$，其中 $k$ 表示 $\log(r-l+1)$ 。</p><p>初始状态： $f_{i,0}=a_i$ ，然后外层遍历 $i$ ，内层遍历 $j$ 处理 $f$ 即可。</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P3865">【模板】ST表</a></p><p>区间最大值。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m,a[<span class="number">100001</span>],f[<span class="number">100001</span>][<span class="number">64</span>],k[<span class="number">100001</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underGet</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) k[i]=<span class="built_in">log2</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][<span class="number">0</span>]=a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;i)&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j+(<span class="number">1</span>&lt;&lt;i)<span class="number">-1</span>&lt;=n;++j)</span><br><span class="line">f[j][i]=<span class="built_in">underMax</span>(f[j][i<span class="number">-1</span>],f[j+(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>))][i<span class="number">-1</span>]); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;st.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;st.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line"><span class="built_in">underRead</span>(n),<span class="built_in">underRead</span>(m);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">underRead</span>(a[i]);</span><br><span class="line"><span class="built_in">underGet</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l,r;m;--m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">underRead</span>(l),<span class="built_in">underRead</span>(r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">underMax</span>(f[l][k[r-l+<span class="number">1</span>]],f[r-(<span class="number">1</span>&lt;&lt;(k[r-l+<span class="number">1</span>]))+<span class="number">1</span>][k[r-l+<span class="number">1</span>]]));</span><br><span class="line">&#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8 8</span></span><br><span class="line"><span class="comment">9 3 1 7 5 6 0 8</span></span><br><span class="line"><span class="comment">1 6</span></span><br><span class="line"><span class="comment">1 5</span></span><br><span class="line"><span class="comment">2 7</span></span><br><span class="line"><span class="comment">2 6</span></span><br><span class="line"><span class="comment">1 8</span></span><br><span class="line"><span class="comment">4 8</span></span><br><span class="line"><span class="comment">3 7</span></span><br><span class="line"><span class="comment">1 8</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p><a href="https://www.luogu.com.cn/problem/P2251">P2251 质量检测</a></p><p><a href="https://www.luogu.com.cn/problem/P1816">P1816 忠诚</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RMQ </tag>
            
            <tag> ST表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>扫描线</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/scan-line/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/scan-line/</url>
      
        <content type="html"><![CDATA[<p>“地毯式搜索”</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5490">P5490 扫描线</a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>用线段树维护一个横区间内所有的矩形个数，对于每个不为 $0$ 的区间则计算答案。</p><p>因为坐标过大，所以线段树维护的是离散化之后的坐标。</p><p>在扫描线算法中，我们总共需要两次排序：将端点的横坐标排序和横线的纵坐标排序。在进行排序之后，我们还需要将端点横坐标离散化和去重，用 $STL$ 的 $unique$ 函数就可以了。</p><p>最后，扫描横边，查询每一个横边所在区间的竖边即可。</p><p><a href="https://2745518585.github.io/post/Scan%20line/">参考资料：赵悦岑’s blog’</a></p><h2 id="AC-Code："><a href="#AC-Code：" class="headerlink" title="AC Code："></a>AC Code：</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Segment_Tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l,r,dat;</span><br><span class="line">    ll tag;</span><br><span class="line">&#125;Tree[MAXN&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Sort_Str</span></span><br><span class="line">&#123;</span><br><span class="line">    ll l,r,dat;</span><br><span class="line">    <span class="type">int</span> tag;</span><br><span class="line">&#125;Num[MAXN&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line">ll b[MAXN&lt;&lt;<span class="number">4</span>],l1,l2,r1,r2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">underCmp</span><span class="params">(Sort_Str a,Sort_Str b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.dat&lt;b.dat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Tree[p].dat) Tree[p].tag=b[Tree[p].r+<span class="number">1</span>]-b[Tree[p].l];</span><br><span class="line">    <span class="keyword">else</span> Tree[p].tag=Tree[p&lt;&lt;<span class="number">1</span>].tag+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].tag;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underBuild</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p].l=l,Tree[p].r=r,Tree[p].tag=Tree[p].dat=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">underBuild</span>(p&lt;&lt;<span class="number">1</span>,l,mid),<span class="built_in">underBuild</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAdd</span><span class="params">(<span class="type">int</span> p,ll l,ll r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b[Tree[p].l]&gt;=r||b[Tree[p].r+<span class="number">1</span>]&lt;=l) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span>(b[Tree[p].l]&gt;=l&amp;&amp;b[Tree[p].r+<span class="number">1</span>]&lt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p].dat+=k;</span><br><span class="line">        <span class="built_in">underPushUp</span>(p);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underAdd</span>(p&lt;&lt;<span class="number">1</span>,l,r,k),<span class="built_in">underAdd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,k);</span><br><span class="line">    <span class="built_in">underPushUp</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;segmenttree.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;segmenttree.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">underRead</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>,&amp;l1,&amp;r1,&amp;l2,&amp;r2);</span><br><span class="line">        Num[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>]=(Sort_Str)&#123;l1,l2,r1,<span class="number">1</span>&#125;;</span><br><span class="line">        Num[i&lt;&lt;<span class="number">1</span>]=(Sort_Str)&#123;l1,l2,r2,<span class="number">-1</span>&#125;;</span><br><span class="line">        b[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>]=l1,b[i&lt;&lt;<span class="number">1</span>]=l2;</span><br><span class="line">    &#125;</span><br><span class="line">    n&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">sort</span>(Num+<span class="number">1</span>,Num+<span class="number">1</span>+n,underCmp);</span><br><span class="line">    <span class="built_in">sort</span>(b+<span class="number">1</span>,b+<span class="number">1</span>+n);</span><br><span class="line">    m=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-(b+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">underBuild</span>(<span class="number">1</span>,<span class="number">1</span>,m<span class="number">-1</span>);</span><br><span class="line">    ll s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underAdd</span>(<span class="number">1</span>,Num[i].l,Num[i].r,Num[i].tag);</span><br><span class="line">        s+=Tree[<span class="number">1</span>].tag*(Num[i+<span class="number">1</span>].dat-Num[i].dat);</span><br><span class="line">        <span class="comment">// printf(&quot;%d %d\n&quot;,Tree[1].tag,(Num[i+1].dat-Num[i].dat));</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,s);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">100 100 200 200</span></span><br><span class="line"><span class="comment">150 150 250 255</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 离散化 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 面积并 </tag>
            
            <tag> 几何 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单调队列优化Dp</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-of-monotonous-queue/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-of-monotonous-queue/</url>
      
        <content type="html"><![CDATA[<p>“我永远对你保有最诚挚的爱”</p><span id="more"></span><h2 id="单调队列"><a href="#单调队列" class="headerlink" title="单调队列"></a>单调队列</h2><p>单调队列是一种<strong>队列内的元素有单调性</strong>（递增或递减）的队列。答案（最优解）存在队首。一般用于维护区间最值或者降低 $Dp$ 数组的维度来减少空间及时间的目的。</p><details>    <summary>单调队列的作用</summary>    1. 维护区间最值 <Br />    2. 优化 DP</details><p>单调队列在队首和队尾都可以进行<strong>出队操作</strong>，但只有队尾可以进行<strong>入队</strong>操作。这样的操作类似于双端队列（$deque$）允许双端弹出。但一般来说，还是不建议使用 $STL$ 库，手写方便且比较节省时间。</p><p>总的来说，单调队列的实现有三步：</p><ol><li>将 $head$ 之前所有已在区间之外的答案删掉（ $++head$ ）</li><li>更新答案为 $Queue[head]$</li><li>将尾部的非最优答案排除（ $—tail$ ），并入队最新答案。</li></ol><h2 id="栗子"><a href="#栗子" class="headerlink" title="栗子"></a>栗子</h2><p><a href="https://www.luogu.com.cn/problem/P1886">【模板】单调队列/滑动窗口</a></p><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>求出区间最大值和最小值，因为复杂度限制 $O(n \log n)$ 所以无法暴力。就使用单调队列的优化。</p><h3 id="AC-Code："><a href="#AC-Code：" class="headerlink" title="AC Code："></a>AC Code：</h3><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="type">int</span> N,K,A[<span class="number">1000001</span>];</span><br><span class="line"><span class="type">int</span> Q[<span class="number">10000001</span>];</span><br><span class="line"><span class="type">int</span> P[<span class="number">10000001</span>],head,tail;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underMax</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">head=<span class="number">1</span>;</span><br><span class="line">tail=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(head&lt;=tail&amp;&amp;Q[tail]&lt;=A[i])</span><br><span class="line">&#123;</span><br><span class="line">tail--;</span><br><span class="line">&#125;</span><br><span class="line">Q[++tail]=A[i];</span><br><span class="line">P[tail]=i;</span><br><span class="line"><span class="keyword">while</span>(P[head]&lt;=i-K)</span><br><span class="line">&#123;</span><br><span class="line">head++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(i&gt;=K)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,Q[head]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underMin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">head=<span class="number">1</span>;</span><br><span class="line">tail=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(head&lt;=tail&amp;&amp;Q[tail]&gt;=A[i])</span><br><span class="line">&#123;</span><br><span class="line">tail--;</span><br><span class="line">&#125;</span><br><span class="line">Q[++tail]=A[i];</span><br><span class="line">P[tail]=i;</span><br><span class="line"><span class="keyword">while</span>(P[head]&lt;=i-K)</span><br><span class="line">&#123;</span><br><span class="line">head++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(i&gt;=K)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,Q[head]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//freopen(&quot;.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="comment">//freopen(&quot;.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;N,&amp;K);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;A[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">underMin</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">underMax</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8 3</span></span><br><span class="line"><span class="comment">1 3 -1 -3 5 3 6 7</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="单调队列优化多重背包"><a href="#单调队列优化多重背包" class="headerlink" title="单调队列优化多重背包"></a>单调队列优化多重背包</h2><p><a href="https://2745518585.github.io/post/Monotone%20queue%20Knapsack/">巨佬的讲解</a></p><p><a href="https://www.acwing.com/problem/content/6/">Acwing 6 多重背包III</a></p><details>    <summary>查看代码</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="type">int</span> n,V;</span><br><span class="line"><span class="type">int</span> v,w,s;</span><br><span class="line"><span class="type">int</span> dp[<span class="number">20001</span>],pre[<span class="number">20001</span>],q[<span class="number">20001</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;V);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(pre, dp, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">        <span class="type">int</span> v, w, s;</span><br><span class="line">        cin &gt;&gt;v&gt;&gt;w&gt;&gt;s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;v;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> head=<span class="number">0</span>, tail=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k=j;k&lt;=V;k+=v)</span><br><span class="line">            &#123;</span><br><span class="line">                        <span class="keyword">if</span> (head&lt;=tail&amp;&amp;k-s*v&gt;q[head]) ++head;</span><br><span class="line">            <span class="keyword">while</span>(head&lt;=tail&amp;&amp;pre[q[tail]]-(q[tail]-j)/v*w&lt;=pre[k]-(k-j)/v*w) --tail;</span><br><span class="line">            <span class="keyword">if</span> (head&lt;=tail) dp[k]=<span class="built_in">max</span>(dp[k],pre[q[head]]+(k-q[head])/v*w);</span><br><span class="line">            q[++tail]=k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,dp[V]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure></details><h2 id="提升"><a href="#提升" class="headerlink" title="提升"></a>提升</h2><p><a href="https://www.luogu.com.cn/problem/P2216">P2216 [HAOI2007]理想的正方形</a></p><h3 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h3><p>二维的滑动窗口，也就那样做就对了。</p><h3 id="AC-Code"><a href="#AC-Code" class="headerlink" title="AC Code"></a>AC Code</h3><details>    <summary>查看代码</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1001</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) tail|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(tail) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T,<span class="keyword">class</span> ...T1&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x,T1 &amp;...x1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(x),<span class="built_in">read</span>(x1...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMax</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">checkMin</span><span class="params">(T &amp;x,T &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;y?x=y,<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N,M,K;</span><br><span class="line"><span class="type">int</span> val[MAXN][MAXN],Row_max[MAXN][MAXN],Row_min[MAXN][MAXN];</span><br><span class="line"><span class="type">int</span> Que[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">get_min</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> b[],<span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(Que,<span class="number">0</span>,<span class="built_in">sizeof</span>(Que));</span><br><span class="line">    <span class="type">int</span> head=<span class="number">0</span>,tail=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(head&lt;=tail&amp;&amp;Que[head]&lt;=i-K) ++head;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;=tail&amp;&amp;a[Que[tail]]&gt;=a[i]) --tail;</span><br><span class="line">        Que[++tail]=i;</span><br><span class="line">        b[i]=a[Que[head]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">get_max</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> b[],<span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(Que,<span class="number">0</span>,<span class="built_in">sizeof</span>(Que));</span><br><span class="line">    <span class="type">int</span> head=<span class="number">0</span>,tail=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(head&lt;=tail&amp;&amp;Que[head]&lt;=i-K) ++head;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;=tail&amp;&amp;a[Que[tail]]&lt;=a[i]) --tail;</span><br><span class="line">        Que[++tail]=i;</span><br><span class="line">        b[i]=a[Que[head]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;dp-deque.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;dp-deque.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">read</span>(N,M,K);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j)</span><br><span class="line">            <span class="built_in">read</span>(val[i][j]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">get_min</span>(val[i],Row_min[i],M);</span><br><span class="line">        <span class="built_in">get_max</span>(val[i],Row_max[i],M);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=INF;</span><br><span class="line">    <span class="type">int</span> a[MAXN],b[MAXN],c[MAXN];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=K;i&lt;=M;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=N;++j) a[j]=Row_min[j][i];</span><br><span class="line">        <span class="built_in">get_min</span>(a,b,N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=N;++j) a[j]=Row_max[j][i];</span><br><span class="line">        <span class="built_in">get_max</span>(a,c,N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=K;j&lt;=N;++j) res=<span class="built_in">min</span>(res,c[j]-b[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 4 2</span></span><br><span class="line"><span class="comment">1 2 5 6</span></span><br><span class="line"><span class="comment">0 17 16 0</span></span><br><span class="line"><span class="comment">16 17 2 1</span></span><br><span class="line"><span class="comment">2 10 2 1</span></span><br><span class="line"><span class="comment">1 2 2 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></details><h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p><a href="https://www.luogu.com.cn/problem/P1440">P1440 求m区间内的最小值</a></p><p><a href="https://www.luogu.com.cn/problem/P2032">P2032 扫描</a></p><p><a href="https://www.luogu.com.cn/problem/P1725">P1725 琪露诺</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 优化 </tag>
            
            <tag> 分析法 </tag>
            
            <tag> 单调队列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2022.02.12模拟赛</title>
      <link href="/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220212/"/>
      <url>/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220212/</url>
      
        <content type="html"><![CDATA[<p>还彳亍</p><span id="more"></span><h2 id="题目I——城墙（wall）"><a href="#题目I——城墙（wall）" class="headerlink" title="题目I——城墙（wall）"></a>题目I——城墙（wall）</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>给出一个长度为 $n$ 的序列和一个数 $S$ ，求出最短的区间使得区间和大于等于 $S$ 。</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>因为 $n \leq 1500000$ ，所以复杂度最大为 $O(n \log n)$ ，统计前缀和，二分统计长度是否能达到，每次暴力区间和。复杂度合适。</p><h3 id="Task-One-AC-Code"><a href="#Task-One-AC-Code" class="headerlink" title="Task One AC Code"></a>Task One AC Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1500001</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,S,num[MAXN];</span><br><span class="line">ll sum[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">underCheck</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=k;i&lt;=n;++i) <span class="keyword">if</span>(sum[i]-sum[i-k]&gt;=S) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;wall.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;wall.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">underRead</span>(n),<span class="built_in">underRead</span>(S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(num[i]);</span><br><span class="line">        sum[i]=sum[i<span class="number">-1</span>]+num[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> l=<span class="number">1</span>,r=n;</span><br><span class="line">    <span class="keyword">if</span>(sum[n]&lt;S)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">underCheck</span>(mid)) r=mid;</span><br><span class="line">        <span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,l);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10 15</span></span><br><span class="line"><span class="comment">5 1 3 5 10 7 4 9 2 8</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="题目II——岗哨（sentry）"><a href="#题目II——岗哨（sentry）" class="headerlink" title="题目II——岗哨（sentry）"></a>题目II——岗哨（sentry）</h2><h3 id="题目含义："><a href="#题目含义：" class="headerlink" title="题目含义："></a>题目含义：</h3><p>给出一个长度为 $n(n \leq 10^6)$ 的序列：</p><p>第一个答案求的是一段最长的，严格递增的，右端点最小的子区间，输出该子区间的右端点。</p><p>第二行答案求的是去掉一个区间后，一段最长的，严格递增的，右端点最小的子区间，输出该子区间的右端点和长度。</p><h3 id="其他事项"><a href="#其他事项" class="headerlink" title="其他事项"></a>其他事项</h3><p>洛谷有一道类似题目——<a href="https://www.luogu.com.cn/problem/UVA1471">UVA1471防线</a></p><p>根据<del>机房老大哥</del>的教导，这道题的方法多样：树状数组，线段树，$Dp$，离散化等。</p><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p><strong>注：本人的线段树写挂了，所以以下方法来自同机房巨佬<a href="https://www.luogu.com.cn/user/109659">_Live_</a>的题解</strong></p><p>对于第一个答案，用 $num_i$ 结构体统计每一个连续上升子区间的信息，得出最大的子区间长度，输出右端点即可。</p><p>对于第二个答案，用 $f_i$ 统计以 $i$ 为起点的最长上升子序列的大小， $g_i$ 来统计以 $i$ 结尾的最长上升子序列的大小。枚举 $a_i , i \in ( 1 , n )$ ，找到每一个 $k$ 使 $a_k &lt; a_i$ 时的 $g_k + f_i$ 最大。</p><p>这样子看来，这个模拟的过程类似于求 $LIS$ （最长上升子序列）的过程。以 $b_i$ 数组存储能够使 $g_i$ 的值为 $i$ 的最小的 $a_i$ 的值。最后我们求到的 $dp$ 位置是第二个区间的左端点，所以最后输出的应该是 $dp+f_{dp}-1$ 的位置。</p><h3 id="Task-Two-AC-Code"><a href="#Task-Two-AC-Code" class="headerlink" title="Task Two AC Code"></a>Task Two AC Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T,n,v[MAXN&lt;&lt;<span class="number">2</span>],a[MAXN],g[MAXN],f[MAXN],b[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underBuild</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    v[p]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">underBuild</span>(p&lt;&lt;<span class="number">1</span>,l,mid),<span class="built_in">underBuild</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    v[p]=<span class="built_in">underMax</span>(v[p],d);</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">underModify</span>(p&lt;&lt;<span class="number">1</span>,l,mid,x,d);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;x) <span class="built_in">underModify</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x,d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQuery</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=l&amp;&amp;r&lt;=y) <span class="keyword">return</span> v[p];</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid&amp;&amp;y&gt;=l) ans=<span class="built_in">underQuery</span>(p&lt;&lt;<span class="number">1</span>,l,mid,x,y);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid&amp;&amp;x&lt;=r) ans=<span class="built_in">underMax</span>(ans,<span class="built_in">underQuery</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x,y));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> h[MAXN],tot,Max,Dp,t[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l,r;</span><br><span class="line">&#125;num[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underWork</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// underRead(n);</span></span><br><span class="line">    <span class="built_in">memset</span>(b,<span class="number">0x7f7f7f7f</span>,<span class="built_in">sizeof</span>(b));</span><br><span class="line">    a[<span class="number">0</span>]=a[n+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// underRead(a[i]);</span></span><br><span class="line">        a[i]=h[i];</span><br><span class="line">        g[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(a[i]&gt;a[i<span class="number">-1</span>]) g[i]=g[i<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>,dp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        f[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(a[i]&lt;a[i+<span class="number">1</span>]) f[i]=f[i+<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">if</span>(ans&lt;<span class="built_in">underMax</span>(f[i],g[i]))</span><br><span class="line">        &#123;</span><br><span class="line">            ans=<span class="built_in">underMax</span>(f[i],g[i]);</span><br><span class="line">            dp=i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">/*sort(b+1,b+1+n);</span></span><br><span class="line"><span class="comment">    int cnt=unique(b+1,b+1+n)-b-1;</span></span><br><span class="line"><span class="comment">    underBuild(1,1,cnt+1);*/</span></span><br><span class="line">    b[<span class="number">1</span>]=a[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> k=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+<span class="number">1</span>+n,a[i])-b<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(f[i]+k&gt;ans)</span><br><span class="line">        &#123;</span><br><span class="line">            ans=f[i]+k;</span><br><span class="line">            dp=i;</span><br><span class="line">        &#125;</span><br><span class="line">        b[g[i]]=<span class="built_in">underMin</span>(b[g[i]],a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*for(int i=1;i&lt;=n;++i)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        int x=lower_bound(b+1,b+1+n,a[i])-b;</span></span><br><span class="line"><span class="comment">        ans=underMax(ans,f[i]+underQuery(1,1,cnt+1,1,x));</span></span><br><span class="line"><span class="comment">        underModify(1,1,cnt+1,x+1,g[i]);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>,dp+f[dp]<span class="number">-1</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*inline int underDisc(int x)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int l=1,r=tot;</span></span><br><span class="line"><span class="comment">    while(l&lt;r)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        int mid=(l+r)&gt;&gt;1;</span></span><br><span class="line"><span class="comment">        if(num[mid].l&lt;=x&amp;&amp;x&lt;=num[mid].r) return mid;</span></span><br><span class="line"><span class="comment">        else if(num[mid].l&gt;x) r=mid;</span></span><br><span class="line"><span class="comment">        else if(num[mid].r&lt;x) l=mid+1;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    return l;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">inline void underCheck()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    for(int l=1;l&lt;n;++l)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        if(Max&gt;=n-l) return ;</span></span><br><span class="line"><span class="comment">        for(int i=2;i&lt;=n-l;++i)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            //i ~ i+l-1</span></span><br><span class="line"><span class="comment">            int u1=i-1,u2=i+l;</span></span><br><span class="line"><span class="comment">            if(t[u1]==t[u2])</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">                i=num[t[u2]].r-l;</span></span><br><span class="line"><span class="comment">                continue;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            //i+l=num[t[u2]].r</span></span><br><span class="line"><span class="comment">            if(h[u1]&lt;h[u2])</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">                int len=(u1-num[t[u1]].l+1)+(num[t[u2]].r-u2+1);</span></span><br><span class="line"><span class="comment">                if(len&gt;Max) Max=len,Dp=num[t[u2]].r;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;sentry.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;sentry.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">underRead</span>(n);</span><br><span class="line">    num[++tot].l=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underRead</span>(h[i]);</span><br><span class="line">        <span class="keyword">if</span>(h[i<span class="number">-1</span>]&gt;=h[i])</span><br><span class="line">        &#123;</span><br><span class="line">            num[tot].r=i<span class="number">-1</span>;</span><br><span class="line">            num[++tot].l=i;</span><br><span class="line">        &#125;</span><br><span class="line">        t[i]=tot;</span><br><span class="line">    &#125;</span><br><span class="line">    num[tot].r=n;</span><br><span class="line">    <span class="keyword">if</span>(tot==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n%d %d&quot;</span>,n,n,n);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tot==n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;1\n1 1&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> maxn=<span class="number">0</span>,dp=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> k=num[i].r-num[i].l+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(k&gt;maxn)</span><br><span class="line">        &#123;</span><br><span class="line">            maxn=k;</span><br><span class="line">            dp=num[i].r;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Max=maxn,Dp=dp;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,dp);</span><br><span class="line">    <span class="built_in">underWork</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">1 2 3 7 6 4 5 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="题目III——黑客（Hack）"><a href="#题目III——黑客（Hack）" class="headerlink" title="题目III——黑客（Hack）"></a>题目III——黑客（Hack）</h2><h3 id="题目含义"><a href="#题目含义" class="headerlink" title="题目含义"></a>题目含义</h3><p>给定一个有向图，从任意一点出发遍历所有点，删除所有经过的边；再从任意一点出发遍历所有点，如果能达到，求出两次所需的最小权值和。</p><h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p><del>说实话，当看到 $n \leq 10 , m \leq 25$ 时我真的以为正解是爆搜</del>。然而测试数据有 $1000$ 套。</p><p>跑一遍最小生成树（建议 $Kruskal$ ），求出这棵树上的必要边（删掉会使原图最小生成树的总权值变大的边）。这些边必在第二棵最小生成树里。枚举必要边在 $A$ 和 $B$ 生成树里的情况，则 $ans = \min ( a + b )$ 。</p><p><del>可惜蒟蒻到最后也没打出来qwq</del></p><h3 id="Task-Three-AC-Code"><a href="#Task-Three-AC-Code" class="headerlink" title="Task Three AC Code"></a>Task Three AC Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">101</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM=<span class="number">206</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> u,v,w;</span><br><span class="line">&#125;Edge[MAXM&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> id[MAXN],b[MAXN],c[MAXN];</span><br><span class="line"><span class="type">int</span> f[MAXN],coun,cnt,num,n,m;</span><br><span class="line"><span class="type">bool</span> vis[MAXM];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">underCmp</span><span class="params">(Node a,Node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.w&lt;b.w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underFind</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(id[x]==x) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> id[x]=<span class="built_in">underFind</span>(id[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt=num=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underInPut</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">underRead</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;Edge[i].u,&amp;Edge[i].v,&amp;Edge[i].w);</span><br><span class="line">    <span class="built_in">sort</span>(Edge+<span class="number">1</span>,Edge+<span class="number">1</span>+m,underCmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underKruskal</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=n+<span class="number">1</span>;++i) id[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> p1=<span class="built_in">underFind</span>(Edge[i].u),p2=<span class="built_in">underFind</span>(Edge[i].v);</span><br><span class="line">        <span class="keyword">if</span>(p1!=p2&amp;!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x==<span class="number">1</span>) b[cnt++]=i;</span><br><span class="line">            <span class="keyword">if</span>(x==<span class="number">3</span>) f[coun++]=i;</span><br><span class="line">            ret+=Edge[i].w;</span><br><span class="line">            id[p2]=p1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> tp=<span class="built_in">underFind</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(<span class="built_in">underFind</span>(i)!=tp) <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underDeal</span><span class="params">(<span class="type">int</span> cd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tp=<span class="number">0</span>,d[MAXN];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;num;++j) <span class="keyword">if</span>(cd&amp;(<span class="number">1</span>&lt;&lt;j)) d[tp++]=c[j];</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;tp;++i) vis[d[i]]=<span class="number">1</span>;</span><br><span class="line">    coun=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x1=<span class="built_in">underKruskal</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;coun;++i) vis[f[i]]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;tp;++i) vis[d[i]]=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x2=<span class="built_in">underKruskal</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> x1+x2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underAns</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;=INF) <span class="built_in">printf</span>(<span class="string">&quot;Too young too simple,sometimes naive!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underWork</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="built_in">underKruskal</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;cnt;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">        vis[b[i]]=<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> tp=<span class="built_in">underKruskal</span>(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span>(ret&lt;tp) c[num++]=b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">1</span>&lt;&lt;num,ans=INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;++i) ans=<span class="built_in">underMin</span>(ans,<span class="built_in">underDeal</span>(i));</span><br><span class="line">    <span class="built_in">underAns</span>(ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;hack.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;hack.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n)!=EOF)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!n) <span class="keyword">break</span>;</span><br><span class="line">        <span class="built_in">underInit</span>();</span><br><span class="line">        <span class="built_in">underInPut</span>();</span><br><span class="line">        <span class="built_in">underWork</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 10</span></span><br><span class="line"><span class="comment">2 1 20</span></span><br><span class="line"><span class="comment">1 2 30</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1 2 10</span></span><br><span class="line"><span class="comment">1 2 20</span></span><br><span class="line"><span class="comment">2 3 50</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="题目IV——膜拜大会（fake）"><a href="#题目IV——膜拜大会（fake）" class="headerlink" title="题目IV——膜拜大会（fake）"></a>题目IV——膜拜大会（fake）</h2><p>过于毒瘤，不会qwq</p><p><a href="https://blog.csdn.net/qq_43649416/article/details/101123235">给一个链接</a></p>]]></content>
      
      
      <categories>
          
          <category> 模拟赛/比赛 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 数论 </tag>
            
            <tag> 图论 </tag>
            
            <tag> 二分 </tag>
            
            <tag> 生成树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF451E Devus and Flowers</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/cf451e/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/cf451e/</url>
      
        <content type="html"><![CDATA[<p>数论</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/CF451E">题目传送门</a></p><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>用费马小定理推答案，记得卡常和开 $long long$ 。</p><h2 id="AC-Code："><a href="#AC-Code：" class="headerlink" title="AC Code："></a>AC Code：</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> Mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll A[MAXN];</span><br><span class="line"><span class="type">int</span> down=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underQmi</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> k,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>) res=(ll)res*a%p;</span><br><span class="line">        a=(ll)a*a%p;</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">underC</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a&lt;b) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> up=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i=a;i&gt;a-b;--i) up=i%Mod*up%Mod;</span><br><span class="line">    <span class="keyword">return</span> (ll)up*down%Mod; <span class="comment">//费马小定理</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;DaF.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;DaF.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    ll n,m;</span><br><span class="line">    <span class="built_in">underRead</span>(n),<span class="built_in">underRead</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i) <span class="built_in">underRead</span>(A[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;n;++j) down=(ll)j*down%Mod;</span><br><span class="line">    down=<span class="built_in">underQmi</span>(down,Mod<span class="number">-2</span>,Mod);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ll a=n+m<span class="number">-1</span>,b=n<span class="number">-1</span>;</span><br><span class="line">        <span class="type">int</span> sign=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;++j)</span><br><span class="line">            <span class="keyword">if</span>(i&gt;&gt;j&amp;<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sign*=<span class="number">-1</span>;</span><br><span class="line">                a-=A[j]+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        res=(res+<span class="built_in">underC</span>(a,b)*sign)%Mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,(res+Mod)%Mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 5</span></span><br><span class="line"><span class="comment">1 3 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 费马小定理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>闫氏DP分析法</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-yan-analysis/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-yan-analysis/</url>
      
        <content type="html"><![CDATA[<blockquote><p>“所有的 $DP$ 问题，本质上都是有限集中的最值问题”——闫学灿</p></blockquote><span id="more"></span><p><a href="https://www.bilibili.com/video/BV1X741127ZM?from=search&amp;seid=1472099735408379551">原作指路</a></p><h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>从<strong>集合</strong>的方式来考虑 $DP$ 的状态。</p><h2 id="阶段"><a href="#阶段" class="headerlink" title="阶段"></a>阶段</h2><p> $DP$ 的阶段：状态和状态转移。</p><p> 所以有：<strong>状态表示</strong>和<strong>状态计算</strong>。</p><h2 id="状态表示"><a href="#状态表示" class="headerlink" title="状态表示"></a>状态表示</h2><p>把几个具有相同点的元素合在一起考虑，成为一个状态</p><p>对于一个状态 $F_i$ ，考虑两个角度：</p><p>1.集合： $f(i)$ 表示什么集合</p><p>由于 $F_i$ 表示的是一堆东西(这也是 $DP$ 优于枚举的核心)，我们要考虑这一堆东西的共同特征，如：所有满足某个条件的元素集合。这一点请仔细考虑，到底是大于等于，大于，小于，小于等于，等于……这些的不同会导致状态计算方式的不同</p><p>2.属性： $f(i)$ 的属性</p><p>存的数与集合的关系：如 $max,min,count,sum$ 等。</p><p>很明显， $F_i$ 大多数时候是一个数，代表这个集合的某一个属性，多是最大值、最小值、数量、总和等。题目问什么，属性一般就是什么。</p><h2 id="状态计算"><a href="#状态计算" class="headerlink" title="状态计算"></a>状态计算</h2><p>对于 $F_i$ 所表示的集合，我们将其划分为多个子集。</p><ul><li><p>划分的依据——找最后一个不同点（依题而定，即关键决策）</p></li><li><p>划分之后，根据其子集求 $F_i$ 的值。 </p></li><li><p>举例：当属性为 $max$ 时， $F_i=max($ 子集的 $max)$ ，当属性为 $count$ 时， $F_i=\sum($ 子集的 $count)$ 等。</p></li></ul><h2 id="其他链接"><a href="#其他链接" class="headerlink" title="其他链接"></a>其他链接</h2><p><a href="https://www.cnblogs.com/IzayoiMiku/p/13635809.html">IzayoiMiku</a></p><p><a href="https://blog.csdn.net/weixin_44289697/article/details/105125613">XinyueRao</a></p><p><a href="https://www.acwing.com/file_system/file/content/whole/index/content/406072/">AcWing</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> 数论 </tag>
            
            <tag> 分析法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>矩阵</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/matrix/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/matrix/</url>
      
        <content type="html"><![CDATA[<p>“我们的结合，拥有着我们的一部分”</p><span id="more"></span><h2 id="矩阵："><a href="#矩阵：" class="headerlink" title="矩阵："></a>矩阵：</h2><p>矩阵(Matrix)是指一个按照长方阵列排列的集合。一个由 $n$ 行 $m$ 列个数字排列的列表称为“ $m$ 行 $n$ 列”的矩阵，简称 $n*m$ 矩阵，记作：<br>$\begin{Bmatrix}<br>a_1&amp;a_2&amp;a_3&amp;…&amp;a_m\\<br>a_{m+1}&amp;…&amp;…&amp;…&amp;a_{2m}\\<br>…&amp;…&amp;…&amp;…&amp;…\\<br>a_{m(n-1)+1}&amp;…&amp;…&amp;…&amp;a_{nm}<br>\end{Bmatrix}$</p><h2 id="矩阵加法-减法："><a href="#矩阵加法-减法：" class="headerlink" title="矩阵加法/减法："></a>矩阵加法/减法：</h2><p>令 $A,B$ 都是 $n*m$ 矩阵，则 $A+B=C$ ，满足：</p><p>$C=\begin{Bmatrix}<br>a_1+b_1&amp;a_2+b_2&amp;a_3+b_3&amp;…&amp;a_m+b_m\\<br>a_{m+1}+b_{m+1}&amp;…&amp;…&amp;…&amp;a_{2m}+b_{2m}\\<br>…&amp;…&amp;…&amp;…&amp;…\\<br>a_{m(n-1)+1}+b_{m(n-1)+1}&amp;…&amp;…&amp;…&amp;a_{nm}+b_{nm}<br>\end{Bmatrix}$</p><p>简单来说，即 $C_{i,j}=A_{i,j}+B_{i,j}$ ，减法同理。</p><h2 id="矩阵乘法："><a href="#矩阵乘法：" class="headerlink" title="矩阵乘法："></a>矩阵乘法：</h2><p>$A<em>B=C$ 满足 $C_{i,j}=\sum_{k=1}^{n}{A_{i,k}</em>B_{k,j}}$</p><p>矩阵乘法能够实现，仅当 $A$ 的行数与 $B$ 的列数相等时。</p><p><strong>举个栗子：</strong></p><p>$A=\begin{Bmatrix}1&amp;2&amp;3\\1&amp;2&amp;3\\\end{Bmatrix}$ ， $B=\begin{Bmatrix}3&amp;2\\1&amp;3\\2&amp;1\\\end{Bmatrix}$</p><p>那么对于 $C=A*B$ ，则</p><script type="math/tex; mode=display">C_{1,1} = A_{1,1} * B_{1,1} + A_{1,2} * B_{2,1} + A_{1,3} * B_{3,1}</script><p>简单来讲就是</p><p> $C_{1,1}=\sum_{k=1}^{n=3}{A_{1,k}}*\sum_{k=1}^{m=3}{B_{k,1}}$</p><p>那么矩阵乘法的代码实现即是：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)</span><br><span class="line">            c[i][j]+=a[i][k]*b[k][j];</span><br></pre></td></tr></table></figure><h2 id="矩阵快速幂："><a href="#矩阵快速幂：" class="headerlink" title="矩阵快速幂："></a>矩阵快速幂：</h2><p>对于一个矩阵 $G$ 来说， $G^k$ 中 $G_{i,j}$ 的含义为从 $i$ 走到 $j$ 步数为 $k$ 的方案数。</p><p>不用理解太多，就是用矩阵实现快速幂即可，将数乘换成矩阵乘法（<del>蒟蒻改了一下午，才发现把 $i$ 打成了 $j$</del>）</p><p><a href="https://www.luogu.com.cn/problem/P3390">LuoguP3390</a></p><h3 id="AC-Code："><a href="#AC-Code：" class="headerlink" title="AC Code："></a>AC Code：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> ll p=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">101</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll n,k;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    ll m[N][N];             <span class="comment">// 记得开long long</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Matrix <span class="title">underCalc</span><span class="params">(Matrix a,Matrix b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Matrix res;</span><br><span class="line">    <span class="built_in">memset</span>(res.m,<span class="number">0</span>,<span class="built_in">sizeof</span>(res.m));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>;l&lt;=n;++l)</span><br><span class="line">                res.m[i][j]=(res.m[i][j]+(a.m[i][l]*b.m[l][j])%p)%p;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">Matrix a;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underExpr</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Matrix temp;</span><br><span class="line">    <span class="built_in">memset</span>(temp.m,<span class="number">0</span>,<span class="built_in">sizeof</span>(temp.m));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) temp.m[i][i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>) temp=<span class="built_in">underCalc</span>(a,temp);</span><br><span class="line">        a=<span class="built_in">underCalc</span>(a,a);</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,temp.m[i][j]%p);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen(&quot;matrix.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line">    <span class="comment">// freopen(&quot;matrix.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;a.m[i][j]);</span><br><span class="line">    <span class="built_in">underExpr</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2 1</span></span><br><span class="line"><span class="comment">1 1</span></span><br><span class="line"><span class="comment">1 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 矩阵快速幂，矩阵乘法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2022.01.26模拟赛</title>
      <link href="/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220126/"/>
      <url>/Eternity/%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%AF%94%E8%B5%9B/20220126/</url>
      
        <content type="html"><![CDATA[<p>无论哪个学科，最难的部分永远是数学</p><span id="more"></span><h2 id="题目I——集合均值-mos"><a href="#题目I——集合均值-mos" class="headerlink" title="题目I——集合均值(mos)"></a>题目I——集合均值(mos)</h2><blockquote><p>MOS=Mean Of Set</p></blockquote><p>一道完美的数学题，指不推公式你完全不知道它居然求的是**<del>（暂且保密）</del>。</p><p>因为每一次都需要从B中随机一个数，那么第一次取到了 $a_i$ 的话，求到的 $ans$ 应该加上 $\frac{a_i}{2}$ ，以此类推，当第二次取到了 $a_j$ 的时候，求到了 $ans$ 就取到 $\frac{a_i+a_j}{3}$ ，然后继续计算，我们会发现 $B$ 中的所有数对最终答案的贡献系数都是一样的，并且其贡献系数与其在 $B$ 中的位置没有关系，只会和 $B$ 的大小有关系，然后继续推算，答案就<del>显而易见</del>了：<br>$ans=f(|B|)\sum_{x\in B}{a_x}$</p><p>那么现在的问题就在于求出 $f(i)$ 了，我们可以模拟从 $B$ 移动到 $A$ 的过程，花费 $O{m}$ 的时间，这也是 $40pt$ 的做法。然而这道题的关键在于：我们最后求出的期望值是一个有理数 $frac{a}{b}$ ，所以我们需要进行<a href="https://www.luogu.com.cn/problem/P2613">有理数取余</a>，而进行<strong>逆元</strong>操作。（逆元便是这道题的正解）</p><h3 id="怎么想到使用逆元的："><a href="#怎么想到使用逆元的：" class="headerlink" title="怎么想到使用逆元的："></a>怎么想到使用逆元的：</h3><p>首先，我们已经推出了 $ans=f(|B|)\sum_{x\in B}{a}$ ，设 $i$ 为当前 $A$ ，即已经已过去了的数的个数，那么 $|B|=\frac{i-1}{i}$ 了。我们需要在计算的过程中取模，也就自然想到使用逆元了。<del>（虽然考的时候完全没有想到）</del></p><p>具体来说：</p><ul><li>暴力模拟求逆元可得 $70pt$</li><li>线性求逆元可得 $100pt$</li><li>事实上，我们需要的也是这些逆元的和即可，根据原作者的话来说，会有一种<del>强力的</del>的多项式<del>高科技</del>能使求逆元的复杂度达到 $O(\sqrt{nm}\log{nm})$ 。但在这道题来说($n<em>m ≦ 2</em>10^7$)，线性求逆元已经完全足够了。</li></ul><h2 id="Task-One-Ac-Code"><a href="#Task-One-Ac-Code" class="headerlink" title="Task One Ac Code:"></a>Task One Ac Code:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">2e7</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> ll Mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line">ll n,m,x,Num[MAXN],Sum,Inv[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;mos.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;mos.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">underRead</span>(n),<span class="built_in">underRead</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">underRead</span>(Num[i]),Sum+=Num[i];</span><br><span class="line">    Sum%=Mod;</span><br><span class="line">    Sum=(Sum*m)%Mod;</span><br><span class="line">    Inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n*m+<span class="number">1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        Inv[i]=(Mod-Mod/i)*Inv[Mod%i]%Mod;</span><br><span class="line">        x=(x+(i<span class="number">-1</span>)*Inv[i])%Mod;</span><br><span class="line">    &#125;</span><br><span class="line">    x=(x*Inv[n*m])%Mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,Sum*x%Mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3 3</span></span><br><span class="line"><span class="comment">1 2 3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="题目II——聚烷撑乙二醇-pag"><a href="#题目II——聚烷撑乙二醇-pag" class="headerlink" title="题目II——聚烷撑乙二醇(pag)"></a>题目II——聚烷撑乙二醇(pag)</h2><blockquote><p>PAG=Play A Game</p></blockquote><p><del>做题最大的收获是知道了 $PAG$ 是聚烷撑乙二醇的意思</del></p><h3 id="题目含义："><a href="#题目含义：" class="headerlink" title="题目含义："></a>题目含义：</h3><p>鲁迅曾经说过，要多去尝试，才能最终发现最优的答案。</p><p>鲁迅也还说过，要珍惜当下，把握住眼前的机会。</p><p>有 $n$ 个随机数生成器，第 $i$ 个生成器可以均匀随机地生成 $[L_i,R_i]$ 内的一个实数。</p><p>现在你要玩个游戏，从第 $1$ 个生成器到第 $n$ 个生成器，每次当前生成器会生成一个数，你需要选择：</p><ul><li><p>相信鲁迅，拿走这个数，游戏结束。</p></li><li><p>相信鲁迅，放弃这个数和这个生成器，使用下一个生成器（前提是下一个生成器必须存在）。</p></li></ul><p>求使用使得期望答案最大的策略时，期望答案是多少。</p><p><del><strong>很玄学的题意和标题</strong></del></p><h3 id="思路详解："><a href="#思路详解：" class="headerlink" title="思路详解："></a>思路详解：</h3><p>其实想明白后十分简单，主要是想到这道题到底是怎样操作的。假设现在我们到了第 $i$ 的随机数生成器，第二个生成器产生的数的期望是 $Y=\frac{L_{i+1}+R_{i+1}}{2}$ 。如果第 $i$ 个生成器产生了 $X$ ，当 $X&lt;Y$ 时，我们当然放弃 $X$ 更优，反之则取出 $X$ 。</p><p>那我们将 $i$ 与 $i+1$ 扩展到 $1$ 到 $n$ 的思路。对于每一组来说，我们都这样来扩展答案，就可以得到下面的算式：</p><blockquote><p>当 $ans&lt;L_i$ 时 $ans=\frac{L_i+R_i}{2}$</p><p>当 $L_i&lt;ans&lt;R_i$ 时 $ans=\frac{ans<em>(ans-L_i)+\frac{ans+R_i}{2}</em>(R_i-ans)}{R_i-L_i}$</p><p>否则， $ans=ans$ ，当然，这步不用在代码里体现。</p></blockquote><p>明白这件事之后，还有一个需要注意的，那就是：</p><p><strong>我们在扩展答案是应该从 $N$ 到 $1$ 扩展：</strong></p><p>因为我们只有在知道了 $i+1$ 的区间之后才能知道第 $i$ 个到底取不取。</p><h2 id="Task-Two-Ac-Code："><a href="#Task-Two-Ac-Code：" class="headerlink" title="Task Two Ac Code："></a>Task Two Ac Code：</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMax(x,y) ((x)&gt;(y)?(x):(y))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> underMin(x,y) ((x)&lt;(y)?(x):(y))</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">double</span> ld;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underRead</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> ch=<span class="built_in">gh</span>(),t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>) t|=ch==<span class="string">&#x27;-&#x27;</span>,ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>),ch=<span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span>(t) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,l[MAXN],r[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;pag.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;pag.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="built_in">underRead</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;l[i],&amp;r[i]);</span><br><span class="line">ld ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;<span class="number">0</span>;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> L=l[i],R=r[i];</span><br><span class="line"><span class="keyword">if</span>(ans&lt;L) ans=<span class="built_in">ld</span>(L+R)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ans&lt;R) ans=(ans*(ans-L)+(R+ans)/<span class="number">2</span>*(R-ans))/(R-L);</span><br><span class="line"><span class="comment">// else ans=ans;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.5Lf&quot;</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 模拟赛/比赛 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
            <tag> 质数 </tag>
            
            <tag> 费马小定理 </tag>
            
            <tag> 概率论 </tag>
            
            <tag> 期望 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P1144 最短路计数</title>
      <link href="/Eternity/%E9%A2%98%E8%A7%A3/p1144/"/>
      <url>/Eternity/%E9%A2%98%E8%A7%A3/p1144/</url>
      
        <content type="html"><![CDATA[<p>最短路计数</p><span id="more"></span><h3 id="题目链接："><a href="#题目链接：" class="headerlink" title="题目链接："></a>题目链接：</h3><p><a href="https://www.luogu.com.cn/problem/P1144">最短路计数</a></p><h3 id="题目概述-amp-解题思路："><a href="#题目概述-amp-解题思路：" class="headerlink" title="题目概述&amp;解题思路："></a>题目概述&amp;解题思路：</h3><p>字面意思，不多做解释。求出所有的最短路个数，对 $10^6+3$  取模。当然，如果起点到编号为 $i$ 的点不连通当然数目就为0啦。</p><p>对于简单的思路，那就是跑出最短路，再跑一遍遍历，看有多少种情况能够走到 $i$ 点，然后统计。但是这样是绝对会超时的</p><p>对于 $100%$ 的数据, $N ≦ 1000000,M ≦ 2000000$ .所以我们应该选择 <del>SPFA</del> ，啊对，就是选择SPFA，<del>有些算法死了，它还活着</del>。</p><p>我们可以用一个数组 $AnsL$ 来存储从 $1$ 号点到第 $i$ 号点的最短路个数，然后一边跑 $SPFA$ 一边修改 $AnsL$ 的值，即当我们当前从 $u$ 点跑到了 $v$ 点的话费与 $Dist_v$ 的值相同时，那么现在是一条目前找到的最短路（之后可能会存在更短路），那么就有：</p><blockquote><p>$Ans_v=Ans_u+1$</p></blockquote><p>的推导公式。</p><p>而如果我们找到了更短路，那就把当前点的计数清零。从 $u$ 点出发到的 $v$ 点的路即是最短路（目前），则传递答案为：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dist[v]=Dist[u]+<span class="number">1</span>;</span><br><span class="line">Ans[v]=AnsL[v]=Ans[u];</span><br></pre></td></tr></table></figure><p>这就是两种传递的方式，也就是本题最关键的代码核心。</p><p>其他的注意事项则在代码里体现：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="type">int</span> N,M,x,y,Cnt;</span><br><span class="line"><span class="type">int</span> Dis[<span class="number">1000001</span>];</span><br><span class="line"><span class="type">bool</span> Vis[<span class="number">1000001</span>];</span><br><span class="line"><span class="type">int</span> Ans[<span class="number">1000001</span>];</span><br><span class="line"><span class="type">int</span> AnsL[<span class="number">1000001</span>];</span><br><span class="line"><span class="type">int</span> First[<span class="number">1000001</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> To,Next;</span><br><span class="line">&#125;Edge[<span class="number">2000001</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">SPFA</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Dis[x]=<span class="number">0</span>;</span><br><span class="line">Vis[x]=<span class="number">1</span>;</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;Q;</span><br><span class="line">Q.<span class="built_in">push</span>(x);</span><br><span class="line"><span class="keyword">while</span>(!Q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> u=Q.<span class="built_in">front</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> e=First[u];e;e=Edge[e].Next)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> Now=Edge[e].To;</span><br><span class="line"><span class="keyword">if</span>(Dis[Now]&gt;Dis[u]+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">Dis[Now]=Dis[u]+<span class="number">1</span>;</span><br><span class="line">Ans[Now]=AnsL[Now]=Ans[u]%<span class="number">100003</span>;</span><br><span class="line"><span class="keyword">if</span>(!Vis[Now])</span><br><span class="line">&#123;</span><br><span class="line">Vis[Now]=<span class="number">1</span>;</span><br><span class="line">Q.<span class="built_in">push</span>(Now);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(Dis[Now]==Dis[u]+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">AnsL[Now]=(AnsL[Now]+Ans[u])%<span class="number">100003</span>;</span><br><span class="line">Ans[Now]=(Ans[Now]+Ans[u])%<span class="number">100003</span>;</span><br><span class="line"><span class="keyword">if</span>(!Vis[Now])</span><br><span class="line">&#123;</span><br><span class="line">Vis[Now]=<span class="number">1</span>;</span><br><span class="line">Q.<span class="built_in">push</span>(Now);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Ans[u]=<span class="number">0</span>;</span><br><span class="line">Q.<span class="built_in">pop</span>();</span><br><span class="line">Vis[u]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//freopen(&quot;.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="comment">//freopen(&quot;.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;N,&amp;M);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line">Edge[++Cnt].To=y;</span><br><span class="line">Edge[Cnt].Next=First[x];</span><br><span class="line">First[x]=Cnt;</span><br><span class="line">Edge[++Cnt].To=x;</span><br><span class="line">Edge[Cnt].Next=First[y];</span><br><span class="line">First[y]=Cnt;</span><br><span class="line">&#125;</span><br><span class="line">AnsL[<span class="number">1</span>]=Ans[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">&#123;</span><br><span class="line">Dis[i]=<span class="number">0x7f7f7f7f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">SPFA</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,AnsL[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 7</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 3</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">3 4</span></span><br><span class="line"><span class="comment">2 3</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">4 5</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 最短路 </tag>
            
            <tag> 图论 </tag>
            
            <tag> SPFA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线段树</title>
      <link href="/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/segment-tree/"/>
      <url>/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/segment-tree/</url>
      
        <content type="html"><![CDATA[<p>“我一步一步走向深处，寻找你的身影，又将你拉回——我们的起点”</p><span id="more"></span><p>线段树是用来维护区间权值的一种数据结构，根据同机房巨佬而言，一般需要使用线段树的题考点都不在线段树上，<del>不过线段树真滴好用</del></p><hr><h2 id="线段树的操作："><a href="#线段树的操作：" class="headerlink" title="线段树的操作："></a>线段树的操作：</h2><h2 id="Ⅰ-建树"><a href="#Ⅰ-建树" class="headerlink" title="Ⅰ.建树"></a>Ⅰ.建树</h2><p>我的习惯为使用结构体存储（就和链式前向星一样），也可以分开打：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,dat;</span><br><span class="line"><span class="comment">//int tag;</span></span><br><span class="line">&#125;Tree[N&lt;&lt;<span class="number">2</span>];</span><br></pre></td></tr></table></figure><br>一般来说，线段树的数组需要开四倍 $N$ 空间，因为他比线性结构要多一层，而开四倍一般不会爆。</p><h3 id="代码讲解："><a href="#代码讲解：" class="headerlink" title="代码讲解："></a>代码讲解：</h3><p>对于其中之一 $Tree[p]$ 中：</p><p>$l$ 表示第p个编号所表示的区域起点为原线性结构的 $A_l$ ；</p><p>$r$ 表示第p个编号所表示的区域终点为原线性结构的 $A_r$ ；</p><p>子节点保证： $l=r$ ；</p><p>$dat$ 表示该区域的一个数据，一般视题目而定，且 $dat$ 的个数也不定。</p><p>$tag$ 可有也可不有（如果是区间修改的题一般都有），表示“懒惰标记”，之后详解。</p><p>$p$ 结点的子结点为 $p<em>2$ 和 $p</em>2+1$ ，一般在代码中写为 $p&lt;&lt;1$ 和 $p&lt;&lt;1|1$ 来节约时间（因为位运算时间复杂度＜乘法复杂度）</p><h3 id="建树一般使用递归建树："><a href="#建树一般使用递归建树：" class="headerlink" title="建树一般使用递归建树："></a>建树一般使用递归建树：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underBuild</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tree[p].l=l;</span><br><span class="line">    Tree[p].r=r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)<span class="comment">//到达子结点</span></span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p].dat=Val[l];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">underBuild</span>(p&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">    <span class="built_in">underBuild</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="built_in">underPushUp</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Ⅱ-查询"><a href="#Ⅱ-查询" class="headerlink" title="Ⅱ.查询"></a>Ⅱ.查询</h2><p><strong>以查询该区间权值和为例：</strong></p><p>如果该结点在需要查询的区间内，返回该点权值；</p><p>如果不在搜索子结点，如果需要的 $l$ 比该结点的 $mid$ 小，则搜索 $(l,mid)$；如果需要的 $r$ 比该结点的 $mid$ 大，则搜索$(mid+1,r)$。 </p><p>具体操作看函数：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">long</span> <span class="type">long</span> <span class="title">underQuery</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Tree[p].l&gt;=l&amp;&amp;r&gt;=Tree[p].r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Tree[p].dat;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underSpread</span>(p);<span class="comment">//区间修改的操作，之后详解</span></span><br><span class="line">    <span class="type">int</span> mid=(Tree[p].l+Tree[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> val=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">        val+=<span class="built_in">underQuery</span>(p&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;r)</span><br><span class="line">    &#123;</span><br><span class="line">        val+=<span class="built_in">underQuery</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Ⅲ-单点修改"><a href="#Ⅲ-单点修改" class="headerlink" title="Ⅲ.单点修改"></a>Ⅲ.单点修改</h2><p>找到该点的编号，从下至上修改它的所有父结点直到，依然使用递归操作。</p><p><strong>$dat$ 存储该区间的区间和</strong>：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underChange</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> v,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Tree[p].l==v&amp;&amp;Tree[p].r==v)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p].dat=k;<span class="comment">//到达子结点后修改dat值</span></span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=(Tree[p].l+Tree[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underChange</span>(p&lt;&lt;<span class="number">1</span>,l,r,k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(v&gt;mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underChange</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,k);</span><br><span class="line">    &#125;</span><br><span class="line">    Tree[p].dat=Tree[p&lt;&lt;<span class="number">1</span>].dat+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].dat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Ⅳ-向上传递（pushup）"><a href="#Ⅳ-向上传递（pushup）" class="headerlink" title="Ⅳ.向上传递（pushup）"></a>Ⅳ.向上传递（pushup）</h2><p>即函数underPushUp，一般都是视题目而定。</p><p><strong>以区间和为例：</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underPushUp</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Tree[p].dat=Tree[p&lt;&lt;<span class="number">1</span>].dat+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].dat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><del>似乎这个例子没什么说服力</del>，不过的确是这样的。</p><h2 id="Ⅴ-向下传递（pushdown-spread）"><a href="#Ⅴ-向下传递（pushdown-spread）" class="headerlink" title="Ⅴ.向下传递（pushdown/spread）"></a>Ⅴ.向下传递（pushdown/spread）</h2><p>只限于懒惰标记。当我们需要改变该区间中的子区间才会向下传递，这样可以优化时间，否则每一次区间修改都会花费 $O(N)$ 的时间复杂度。</p><p><strong>依然以区间和为例：</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underSpread</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Tree[p].tag)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>].dat+=Tree[p].tag*(Tree[p&lt;&lt;<span class="number">1</span>].r-Tree[p&lt;&lt;<span class="number">1</span>].l+<span class="number">1</span>);</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].dat+=Tree[p].tag*(Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].r-Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].l+<span class="number">1</span>);</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>].tag+=Tree[p].tag;</span><br><span class="line">        Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].tag+=Tree[p].tag;</span><br><span class="line">        Tree[p].tag=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Ⅵ-区间修改"><a href="#Ⅵ-区间修改" class="headerlink" title="Ⅵ.区间修改"></a>Ⅵ.区间修改</h2><p>使用懒惰标记，可以让时间复杂度降到 $O(logN)$ 。</p><p><strong>依然以区间和为例：</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">underModify</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=Tree[p].l&amp;&amp;Tree[p].r&lt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">        Tree[p].dat+=k*(Tree[p].r-Tree[p].l+<span class="number">1</span>);</span><br><span class="line">        Tree[p].tag+=k;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">underSpread</span>(p);</span><br><span class="line">    <span class="type">int</span> mid=(Tree[p].l+Tree[p].r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underModify</span>(p&lt;&lt;<span class="number">1</span>,l,r,k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r&gt;mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">underModify</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,k);</span><br><span class="line">    &#125;</span><br><span class="line">    Tree[p].dat=Tree[p&lt;&lt;<span class="number">1</span>].dat+Tree[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].dat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="一些练习"><a href="#一些练习" class="headerlink" title="一些练习"></a>一些练习</h2><p><a href="https://www.luogu.com.cn/problem/P3372">区间修改区间查找模板题</a></p><p><a href="https://www.luogu.com.cn/problem/P4513">区间最大子段和模板题</a></p><p><a href="https://www.luogu.com.cn/problem/P2574">P2574 XOR的艺术</a></p><p><a href="https://www.luogu.com.cn/problem/P6327">区间求sin和，需要使用数学知识</a></p><p><a href="https://www.luogu.com.cn/problem/P5648">卡常卡码风的毒瘤题</a></p><p>头图来源：<br><a href="https://space.bilibili.com/53456/?spm_id_from=333.999.0.0">Warma</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RMQ </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 线段树 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
